[
  {
    "RunbookDisplayName": "Restart Host",
    "RunbookDisplayPath": "Device \\ Avd \\ Restart Host",
    "RelativeRunbookPath": "device/avd/restart-host.ps1",
    "RelativeRunbookPath_PathOnly": "device/avd",
    "PrimaryFolder": "Device",
    "SubFolder": "Avd",
    "Synopsis": "Reboots a specific AVD Session Host.",
    "Description": "This Runbook reboots a specific AVD Session Host. If Users are signed in, they will be disconnected. In any case, Drain Mode will be enabled and the Session Host will be restarted.\nIf the SessionHost is not running, it will be started. Once the Session Host is running, Drain Mode is disabled again.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The name of the user executing the runbook. Used for auditing purposes. Hidden in UI"
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The name of the AVD Session Host device to restart. Hidden in UI"
          }
        ],
        "globbing": "false",
        "name": "DeviceName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Array of Azure subscription IDs where the AVD Session Host resources are located. Retrieved from AVD.SubscriptionIds setting (Customization). Hidden in UI"
          }
        ],
        "globbing": "false",
        "name": "SubscriptionIds",
        "parameterValue": "String[]",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String[]"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [],\n    \"Roles\": [],\n    \"ManualPermissions\": [ \"Azure: Desktop Virtualization Host Pool Contributor and Virtual Machine Contributor on Subscription which contains the Hostpool\" ]\n}",
    "PermissionsJson": {
      "Permissions": [],
      "Roles": [],
      "ManualPermissions": [
        "Azure: Desktop Virtualization Host Pool Contributor and Virtual Machine Contributor on Subscription which contains the Hostpool"
      ]
    }
  },
  {
    "RunbookDisplayName": "Toggle Drain Mode",
    "RunbookDisplayPath": "Device \\ Avd \\ Toggle Drain Mode",
    "RelativeRunbookPath": "device/avd/toggle-drain-mode.ps1",
    "RelativeRunbookPath_PathOnly": "device/avd",
    "PrimaryFolder": "Device",
    "SubFolder": "Avd",
    "Synopsis": "Sets Drainmode on true or false for a specific AVD Session Host.",
    "Description": "This Runbooks looks through all AVD Hostpools of a tenant and sets the DrainMode for a specific Session Host.\nThe SubscriptionId value must be defined in the runbooks customization.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The name of the user executing the runbook. Used for auditing purposes. Hidden in UI."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The name of the AVD Session Host device for which to toggle drain mode. Hidden in UI."
          }
        ],
        "globbing": "false",
        "name": "DeviceName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Boolean value to enable or disable Drain Mode. Set to true to enable Drain Mode (prevent new sessions), false to disable it (allow new sessions). Default is false."
          }
        ],
        "globbing": "false",
        "name": "DrainMode",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Array of Azure subscription IDs where the AVD Session Host resources are located. Retrieved from AVD.SubscriptionIds setting (Customization). Hidden in UI."
          }
        ],
        "globbing": "false",
        "name": "SubscriptionIds",
        "parameterValue": "String[]",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String[]"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [],\n    \"Roles\": [],\n    \"ManualPermissions\": [ \"Azure: Desktop Virtualization Host Pool Contributor on Subscription which contains the Hostpool\" ]\n}",
    "PermissionsJson": {
      "Permissions": [],
      "Roles": [],
      "ManualPermissions": [
        "Azure: Desktop Virtualization Host Pool Contributor on Subscription which contains the Hostpool"
      ]
    }
  },
  {
    "RunbookDisplayName": "Change Grouptag",
    "RunbookDisplayPath": "Device \\ General \\ Change Grouptag",
    "RelativeRunbookPath": "device/general/change-groupTag.ps1",
    "RelativeRunbookPath_PathOnly": "device/general",
    "PrimaryFolder": "Device",
    "SubFolder": "General",
    "Synopsis": "Assign a new AutoPilot GroupTag to this device.",
    "Description": "This Runbook assigns a new AutoPilot GroupTag to the device. This can be used to trigger a new deployment with different policies and applications for the device.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The device ID of the target device."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The new AutoPilot GroupTag to assign to the device."
          }
        ],
        "globbing": "false",
        "name": "newGroupTag",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Device.Read.All\",\n                \"DeviceManagementServiceConfig.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Device.Read.All",
            "DeviceManagementServiceConfig.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Check Updatable Assets",
    "RunbookDisplayPath": "Device \\ General \\ Check Updatable Assets",
    "RelativeRunbookPath": "device/general/check-updatable-assets.ps1",
    "RelativeRunbookPath_PathOnly": "device/general",
    "PrimaryFolder": "Device",
    "SubFolder": "General",
    "Synopsis": "Check if a device is onboarded to Windows Update for Business",
    "Description": "This script checks if single device is onboarded to Windows Update for Business",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "DeviceId of the device to check."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"WindowsUpdates.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "WindowsUpdates.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Enroll Updatable Assets",
    "RunbookDisplayPath": "Device \\ General \\ Enroll Updatable Assets",
    "RelativeRunbookPath": "device/general/enroll-updatable-assets.ps1",
    "RelativeRunbookPath_PathOnly": "device/general",
    "PrimaryFolder": "Device",
    "SubFolder": "General",
    "Synopsis": "Enroll device into Windows Update for Business.",
    "Description": "This script enrolls devices into Windows Update for Business.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "DeviceId of the device to unenroll."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "feature",
        "description": [
          {
            "Text": "Category of updates to enroll into. Possible values are: driver, feature or quality."
          }
        ],
        "globbing": "false",
        "name": "UpdateCategory",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"WindowsUpdates.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "WindowsUpdates.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Outphase Device",
    "RunbookDisplayPath": "Device \\ General \\ Outphase Device",
    "RelativeRunbookPath": "device/general/outphase-device.ps1",
    "RelativeRunbookPath_PathOnly": "device/general",
    "PrimaryFolder": "Device",
    "SubFolder": "General",
    "Synopsis": "Remove/Outphase a windows device",
    "Description": "Remove/Outphase a windows device. You can choose if you want to wipe the device and/or delete it from Intune an AutoPilot.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "2",
        "description": [
          {
            "Text": "Determines the Entra ID (Azure AD) action to perform (delete, disable, or none)."
          }
        ],
        "globbing": "false",
        "name": "aadAction",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The device ID of the target device."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Disable device in EntraID?\" (final value: true) or \"Keep device / do not care\" (final value: false) can be selected as action to perform. If set to true, the runbook will disable the device object in Entra ID (Azure AD). If set to false, the device object will remain enabled in Entra ID (Azure AD)."
          }
        ],
        "globbing": "false",
        "name": "disableAADDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "2",
        "description": [
          {
            "Text": "Determines the Intune action to perform (wipe, delete, or none)."
          }
        ],
        "globbing": "false",
        "name": "intuneAction",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "\"Delete device from EntraID?\" (final value: true) or \"Keep device / do not care\" (final value: false) can be selected as action to perform. If set to true, the runbook will delete the device object from Entra ID (Azure AD). If set to false, the device object will remain in Entra ID (Azure AD)."
          }
        ],
        "globbing": "false",
        "name": "removeAADDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "\"Delete device from AutoPilot database?\" (final value: true) or \"Keep device / do not care\" (final value: false) can be selected as action to perform. If set to true, the runbook will delete the device from the AutoPilot database, which also allows the device to leave the tenant. If set to false, the device will remain in the AutoPilot database and can be re-assigned to another user/device in the tenant."
          }
        ],
        "globbing": "false",
        "name": "removeAutopilotDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, deletes the Intune device object."
          }
        ],
        "globbing": "false",
        "name": "removeIntuneDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, triggers a wipe action in Intune."
          }
        ],
        "globbing": "false",
        "name": "wipeDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.PrivilegedOperations.All\",\n                \"DeviceManagementManagedDevices.ReadWrite.All\",\n                \"DeviceManagementServiceConfig.ReadWrite.All\",\n                \"Device.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Cloud device administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.PrivilegedOperations.All",
            "DeviceManagementManagedDevices.ReadWrite.All",
            "DeviceManagementServiceConfig.ReadWrite.All",
            "Device.Read.All"
          ]
        }
      ],
      "Roles": [
        "Cloud device administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Remove Primary User",
    "RunbookDisplayPath": "Device \\ General \\ Remove Primary User",
    "RelativeRunbookPath": "device/general/remove-primary-user.ps1",
    "RelativeRunbookPath_PathOnly": "device/general",
    "PrimaryFolder": "Device",
    "SubFolder": "General",
    "Synopsis": "Removes the primary user from a device.",
    "Description": "This script removes the assigned primary user from a specified Azure AD device.\nIt requires the DeviceId of the target device and the name of the caller for auditing purposes.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The unique identifier of the device from which the primary user will be removed.\nIt will be prefilled from the RealmJoin Portal and is hidden in the UI."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Rename Device",
    "RunbookDisplayPath": "Device \\ General \\ Rename Device",
    "RelativeRunbookPath": "device/general/rename-device.ps1",
    "RelativeRunbookPath_PathOnly": "device/general",
    "PrimaryFolder": "Device",
    "SubFolder": "General",
    "Synopsis": "Rename a device.",
    "Description": "Rename a device (in Intune and Autopilot).",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The device ID of the target device."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The new device name to set. This runbook validates the name against common Windows hostname constraints."
          }
        ],
        "globbing": "false",
        "name": "NewDeviceName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Device.Read.All\",\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"DeviceManagementServiceConfig.ReadWrite.All\",\n                \"DeviceManagementManagedDevices.PrivilegedOperations.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Device.Read.All",
            "DeviceManagementManagedDevices.Read.All",
            "DeviceManagementServiceConfig.ReadWrite.All",
            "DeviceManagementManagedDevices.PrivilegedOperations.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Unenroll Updatable Assets",
    "RunbookDisplayPath": "Device \\ General \\ Unenroll Updatable Assets",
    "RelativeRunbookPath": "device/general/unenroll-updatable-assets.ps1",
    "RelativeRunbookPath_PathOnly": "device/general",
    "PrimaryFolder": "Device",
    "SubFolder": "General",
    "Synopsis": "Unenroll device from Windows Update for Business.",
    "Description": "This script unenrolls devices from Windows Update for Business.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "DeviceId of the device to unenroll."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "all",
        "description": [
          {
            "Text": "Category of updates to unenroll from. Possible values are: driver, feature, quality or all (delete)."
          }
        ],
        "globbing": "false",
        "name": "UpdateCategory",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"WindowsUpdates.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "WindowsUpdates.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Wipe Device",
    "RunbookDisplayPath": "Device \\ General \\ Wipe Device",
    "RelativeRunbookPath": "device/general/wipe-device.ps1",
    "RelativeRunbookPath_PathOnly": "device/general",
    "PrimaryFolder": "Device",
    "SubFolder": "General",
    "Synopsis": "Wipe a Windows or MacOS device",
    "Description": "Wipe a Windows or MacOS device. For Windows devices, you can choose between a regular wipe and a protected wipe. For MacOS devices, you can provide a recovery code if needed and specify the obliteration behavior.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The device ID of the target device."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Disable device in EntraID?\" (final value: true) or \"Keep device / do not care\" (final value: false) can be selected as action to perform. If set to true, the runbook will disable the device object in Entra ID (Azure AD). If set to false, the device object will remain enabled in Entra ID (Azure AD)."
          }
        ],
        "globbing": "false",
        "name": "disableAADDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "default",
        "description": [
          {
            "Text": "MacOS-only. Controls the OS obliteration behavior during wipe."
          }
        ],
        "globbing": "false",
        "name": "macOsObliterationBehavior",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "123456",
        "description": [
          {
            "Text": "MacOS-only. Recovery code for older devices; newer devices may not require this."
          }
        ],
        "globbing": "false",
        "name": "macOsRecoveryCode",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Delete device from EntraID?\" (final value: true) or \"Keep device / do not care\" (final value: false) can be selected as action to perform. If set to true, the runbook will delete the device object from Entra ID (Azure AD). If set to false, the device object will remain in Entra ID (Azure AD)."
          }
        ],
        "globbing": "false",
        "name": "removeAADDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Windows-only. \"Delete device from AutoPilot database?\" (final value: true) or \"Keep device / do not care\" (final value: false) can be selected as action to perform. If set to true, the runbook will delete the device from the AutoPilot database, which also allows the device to leave the tenant. If set to false, the device will remain in the AutoPilot database and can be re-assigned to another user/device in the tenant."
          }
        ],
        "globbing": "false",
        "name": "removeAutopilotDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, deletes the Intune device object."
          }
        ],
        "globbing": "false",
        "name": "removeIntuneDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Windows-only. If set to true, uses protected wipe."
          }
        ],
        "globbing": "false",
        "name": "useProtectedWipe",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "\"Wipe this device?\" (final value: true) or \"Do not wipe device\" (final value: false) can be selected as action to perform. If set to true, the runbook will trigger a wipe action for the device in Intune. If set to false, no wipe action will be triggered for the device in Intune."
          }
        ],
        "globbing": "false",
        "name": "wipeDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.PrivilegedOperations.All\",\n                \"DeviceManagementManagedDevices.ReadWrite.All\",\n                \"DeviceManagementServiceConfig.ReadWrite.All\",\n                \"Device.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Cloud device administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.PrivilegedOperations.All",
            "DeviceManagementManagedDevices.ReadWrite.All",
            "DeviceManagementServiceConfig.ReadWrite.All",
            "Device.Read.All"
          ]
        }
      ],
      "Roles": [
        "Cloud device administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Enable Or Disable Device",
    "RunbookDisplayPath": "Device \\ Security \\ Enable Or Disable Device",
    "RelativeRunbookPath": "device/security/enable-or-disable-device.ps1",
    "RelativeRunbookPath_PathOnly": "device/security",
    "PrimaryFolder": "Device",
    "SubFolder": "Security",
    "Synopsis": "Enable or disable a device in Entra ID",
    "Description": "This runbook enables or disables a Windows device object in Entra ID (Azure AD) based on the provided device ID.\nUse it to temporarily block sign-ins from a compromised or lost device, or to re-enable the device after remediation.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The device ID of the target device."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Disable Device?\" (final value: false) or \"Enable Device again?\" (final value: true) can be selected as action to perform. If set to false, the runbook will disable the device in Entra ID (Azure AD). If set to true, the runbook will enable the device in Entra ID (Azure AD) again."
          }
        ],
        "globbing": "false",
        "name": "Enable",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Device.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Cloud device administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Device.Read.All"
          ]
        }
      ],
      "Roles": [
        "Cloud device administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Isolate Or Release Device",
    "RunbookDisplayPath": "Device \\ Security \\ Isolate Or Release Device",
    "RelativeRunbookPath": "device/security/isolate-or-release-device.ps1",
    "RelativeRunbookPath_PathOnly": "device/security",
    "PrimaryFolder": "Device",
    "SubFolder": "Security",
    "Synopsis": "Isolate this device.",
    "Description": "This runbook isolates a device in Microsoft Defender for Endpoint to reduce the risk of lateral movement and data exfiltration.\nOptionally, it can release a previously isolated device.\nProvide a short reason so the action is documented in the service.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Possible security risk.",
        "description": [
          {
            "Text": "A short reason for the (un)isolation action."
          }
        ],
        "globbing": "false",
        "name": "Comment",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The device ID of the target device."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Full",
        "description": [
          {
            "Text": "The isolation type to use when isolating the device."
          }
        ],
        "globbing": "false",
        "name": "IsolationType",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Isolate Device\" (final value: false) or \"Release Device from Isolation\" (final value: true) can be selected as action to perform. If set to false, the runbook will isolate the device in Defender for Endpoint. If set to true, it will release a previously isolated device from isolation in Defender for Endpoint."
          }
        ],
        "globbing": "false",
        "name": "Release",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"WindowsDefenderATP\",\n            \"Id\": \"fc780465-2017-40d4-a0c5-307022471b92\",\n            \"AppRoleAssignments\": [\n                \"Machine.Read.All\",\n                \"Machine.Isolate\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "WindowsDefenderATP",
          "Id": "fc780465-2017-40d4-a0c5-307022471b92",
          "AppRoleAssignments": [
            "Machine.Read.All",
            "Machine.Isolate"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Reset Mobile Device Pin",
    "RunbookDisplayPath": "Device \\ Security \\ Reset Mobile Device Pin",
    "RelativeRunbookPath": "device/security/reset-mobile-device-pin.ps1",
    "RelativeRunbookPath_PathOnly": "device/security",
    "PrimaryFolder": "Device",
    "SubFolder": "Security",
    "Synopsis": "Reset a mobile device's password/PIN code.",
    "Description": "This runbook triggers an Intune reset passcode action for a managed mobile device.\nThe action is only supported for certain, corporate-owned device types and will be rejected for personal or unsupported devices.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The device ID of the target device."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"DeviceManagementManagedDevices.PrivilegedOperations.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All",
            "DeviceManagementManagedDevices.PrivilegedOperations.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Restrict Or Release Code Execution",
    "RunbookDisplayPath": "Device \\ Security \\ Restrict Or Release Code Execution",
    "RelativeRunbookPath": "device/security/restrict-or-release-code-execution.ps1",
    "RelativeRunbookPath_PathOnly": "device/security",
    "PrimaryFolder": "Device",
    "SubFolder": "Security",
    "Synopsis": "Only allow Microsoft-signed code to run on a device, or remove an existing restriction.",
    "Description": "This runbook restricts code execution on a device via Microsoft Defender for Endpoint so that only Microsoft-signed code can run.\nOptionally, it can remove an existing restriction.\nProvide a short reason so the action is documented in the service.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Possible security risk.",
        "description": [
          {
            "Text": "A short reason for the (un)restriction action."
          }
        ],
        "globbing": "false",
        "name": "Comment",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The device ID of the target device."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Restrict Code Execution\" (final value: false) or \"Remove Code Restriction\" (final value: true) can be selected as action to perform. If set to false, the runbook will restrict code execution on the device in Defender for Endpoint. If set to true, it will remove an existing code execution restriction on the device in Defender for Endpoint."
          }
        ],
        "globbing": "false",
        "name": "Release",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"WindowsDefenderATP\",\n            \"Id\": \"fc780465-2017-40d4-a0c5-307022471b92\",\n            \"AppRoleAssignments\": [\n                \"Machine.Read.All\",\n                \"Machine.RestrictExecution\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "WindowsDefenderATP",
          "Id": "fc780465-2017-40d4-a0c5-307022471b92",
          "AppRoleAssignments": [
            "Machine.Read.All",
            "Machine.RestrictExecution"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Show Laps Password",
    "RunbookDisplayPath": "Device \\ Security \\ Show Laps Password",
    "RelativeRunbookPath": "device/security/show-laps-password.ps1",
    "RelativeRunbookPath_PathOnly": "device/security",
    "PrimaryFolder": "Device",
    "SubFolder": "Security",
    "Synopsis": "Show a local admin password for a device.",
    "Description": "This runbook retrieves and displays the most recent Windows LAPS local administrator password that is backed up for the specified device.\nUse it for break-glass troubleshooting and rotate the password after use.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The device ID of the target device."
          }
        ],
        "globbing": "false",
        "name": "DeviceId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceLocalCredential.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceLocalCredential.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Check Updatable Assets",
    "RunbookDisplayPath": "Group \\ Devices \\ Check Updatable Assets",
    "RelativeRunbookPath": "group/devices/check-updatable-assets.ps1",
    "RelativeRunbookPath_PathOnly": "group/devices",
    "PrimaryFolder": "Group",
    "SubFolder": "Devices",
    "Synopsis": "Check if devices in a group are onboarded to Windows Update for Business.",
    "Description": "This runbook checks the Windows Update for Business onboarding status for all device members of a Microsoft Entra ID group.\nIt queries each device and reports the enrollment state per update category and any returned error details.\nUse this to validate whether group members are correctly registered as updatable assets.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the group whose device members will be checked."
          }
        ],
        "globbing": "false",
        "name": "GroupId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Device.Read.All\",\n                \"Group.Read.All\",\n                \"WindowsUpdates.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": [\n        \"Azure: Contributor on Storage Account\"\n    ]\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Device.Read.All",
            "Group.Read.All",
            "WindowsUpdates.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": [
        "Azure: Contributor on Storage Account"
      ]
    }
  },
  {
    "RunbookDisplayName": "Unenroll Updatable Assets",
    "RunbookDisplayPath": "Group \\ Devices \\ Unenroll Updatable Assets",
    "RelativeRunbookPath": "group/devices/unenroll-updatable-assets.ps1",
    "RelativeRunbookPath_PathOnly": "group/devices",
    "PrimaryFolder": "Group",
    "SubFolder": "Devices",
    "Synopsis": "Unenroll devices from Windows Update for Business.",
    "Description": "This runbook unenrolls all device members of a Microsoft Entra ID group from Windows Update for Business updatable assets.\nYou can remove a specific update category enrollment or delete the updatable asset registration entirely.\nUse this to offboard devices from WUfB reporting or to reset their enrollment state.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the group whose device members will be unenrolled."
          }
        ],
        "globbing": "false",
        "name": "GroupId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "all",
        "description": [
          {
            "Text": "The update category to unenroll from. Supported values are driver, feature, quality, or all."
          }
        ],
        "globbing": "false",
        "name": "UpdateCategory",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.Read.All\",\n                \"WindowsUpdates.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.Read.All",
            "WindowsUpdates.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Or Remove Nested Group",
    "RunbookDisplayPath": "Group \\ General \\ Add Or Remove Nested Group",
    "RelativeRunbookPath": "group/general/add-or-remove-nested-group.ps1",
    "RelativeRunbookPath_PathOnly": "group/general",
    "PrimaryFolder": "Group",
    "SubFolder": "General",
    "Synopsis": "Add/remove a nested group to/from a group",
    "Description": "This runbook adds a nested group to a target group or removes an existing nesting.\nIt supports Microsoft Entra ID groups and Exchange Online distribution or mail-enabled security groups.\nUse the Remove switch to remove the nested group instead of adding it.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the target group."
          }
        ],
        "globbing": "false",
        "name": "GroupID",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the group to add as a nested member."
          }
        ],
        "globbing": "false",
        "name": "NestedGroupID",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Set to true to remove the nested group membership, or false to add it."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"Group.ReadWrite.All\",\n                \"GroupMember.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "Group.ReadWrite.All",
            "GroupMember.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Or Remove Owner",
    "RunbookDisplayPath": "Group \\ General \\ Add Or Remove Owner",
    "RelativeRunbookPath": "group/general/add-or-remove-owner.ps1",
    "RelativeRunbookPath_PathOnly": "group/general",
    "PrimaryFolder": "Group",
    "SubFolder": "General",
    "Synopsis": "Add or remove a Office 365 group owner",
    "Description": "This runbook adds a user as an owner of a group or removes an existing owner.\nFor Microsoft 365 groups, it also ensures that newly added owners are members of the group.\nUse the Remove switch to remove ownership instead of adding it.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the target group."
          }
        ],
        "globbing": "false",
        "name": "GroupID",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Add User as Owner\" (final value: $false) or \"Remove User as Owner\" (final value: $true) can be selected as action to perform. If set to true, the runbook will remove the user from the group owners. If set to false, it will add the user as an owner of the group."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the user to add or remove."
          }
        ],
        "globbing": "false",
        "name": "UserId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"Group.ReadWrite.All\",\n                \"GroupMember.ReadWrite.All\"\n            ]\n        },\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "Group.ReadWrite.All",
            "GroupMember.ReadWrite.All"
          ]
        },
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Or Remove User",
    "RunbookDisplayPath": "Group \\ General \\ Add Or Remove User",
    "RelativeRunbookPath": "group/general/add-or-remove-user.ps1",
    "RelativeRunbookPath_PathOnly": "group/general",
    "PrimaryFolder": "Group",
    "SubFolder": "General",
    "Synopsis": "Add or remove a group member",
    "Description": "This runbook adds a user to a group or removes a user from a group.\nIt supports Microsoft Entra ID groups and Exchange Online distribution or mail-enabled security groups.\nUse the Remove switch to remove the user instead of adding the user.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the target group."
          }
        ],
        "globbing": "false",
        "name": "GroupID",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Add User to Group\" (final value: $false) or \"Remove User from Group\" (final value: $true) can be selected as action to perform. If set to true, the runbook will remove the user from the group. If set to false, it will add the user to the group."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the user to add or remove."
          }
        ],
        "globbing": "false",
        "name": "UserId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"Group.ReadWrite.All\",\n                \"GroupMember.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "Group.ReadWrite.All",
            "GroupMember.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Change Visibility",
    "RunbookDisplayPath": "Group \\ General \\ Change Visibility",
    "RelativeRunbookPath": "group/general/change-visibility.ps1",
    "RelativeRunbookPath_PathOnly": "group/general",
    "PrimaryFolder": "Group",
    "SubFolder": "General",
    "Synopsis": "Change a group's visibility",
    "Description": "This runbook changes the visibility of a Microsoft 365 group between Private and Public.\nSet the Public switch to make the group public; otherwise it will be set to private.\nThis does not change group membership, owners, or email addresses.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the target group."
          }
        ],
        "globbing": "false",
        "name": "GroupID",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Make group private\" (final value: $false) or \"Make group public\" (final value: $true) can be selected as action to perform."
          }
        ],
        "globbing": "false",
        "name": "Public",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List All Members",
    "RunbookDisplayPath": "Group \\ General \\ List All Members",
    "RelativeRunbookPath": "group/general/list-all-members.ps1",
    "RelativeRunbookPath_PathOnly": "group/general",
    "PrimaryFolder": "Group",
    "SubFolder": "General",
    "Synopsis": "List all members of a group, including members that are part of nested groups",
    "Description": "This script retrieves the members of a specified EntraID group, including both direct members and those from nested groups.\nThe output is a CSV file with columns for User Principal Name (UPN), direct membership status, and group path.\nThe group path reflects the membership hierarchyfor example, Primary, Secondary if a user belongs to Primary via the nested group Secondary.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The Object ID of the Microsoft Entra ID group whose membership will be retrieved."
          }
        ],
        "globbing": "false",
        "name": "GroupId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.Read.All\",\n                \"User.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.Read.All",
            "User.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Owners",
    "RunbookDisplayPath": "Group \\ General \\ List Owners",
    "RelativeRunbookPath": "group/general/list-owners.ps1",
    "RelativeRunbookPath_PathOnly": "group/general",
    "PrimaryFolder": "Group",
    "SubFolder": "General",
    "Synopsis": "List all owners of an Office 365 group.",
    "Description": "This runbook retrieves and lists the owners of the specified group.\nIt uses Microsoft Graph to query the group and its owners and outputs the results as a table.\nUse this to quickly review ownership assignments.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the target group."
          }
        ],
        "globbing": "false",
        "name": "GroupID",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List User Devices",
    "RunbookDisplayPath": "Group \\ General \\ List User Devices",
    "RelativeRunbookPath": "group/general/list-user-devices.ps1",
    "RelativeRunbookPath_PathOnly": "group/general",
    "PrimaryFolder": "Group",
    "SubFolder": "General",
    "Synopsis": "List devices owned by group members.",
    "Description": "This runbook enumerates the users in a group and lists their registered devices.\nOptionally, it can add the discovered devices to a specified device group.\nUse this to create or maintain a device group based on group member ownership.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the group whose members will be evaluated."
          }
        ],
        "globbing": "false",
        "name": "GroupID",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the discovered devices are added to the target device group."
          }
        ],
        "globbing": "false",
        "name": "moveGroup",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the target device group that receives the devices when moveGroup is enabled."
          }
        ],
        "globbing": "false",
        "name": "targetgroup",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Remove Group",
    "RunbookDisplayPath": "Group \\ General \\ Remove Group",
    "RelativeRunbookPath": "group/general/remove-group.ps1",
    "RelativeRunbookPath_PathOnly": "group/general",
    "PrimaryFolder": "Group",
    "SubFolder": "General",
    "Synopsis": "Remove a group. For Microsoft 365 groups, also the associated resources (Teams, SharePoint site) will be removed.",
    "Description": "This runbook deletes the specified group, which for Microsoft 365 groups means, that it also deletes the associated resources such as the Teams Team and the SharePoint Site.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the group to delete."
          }
        ],
        "globbing": "false",
        "name": "GroupId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Rename Group",
    "RunbookDisplayPath": "Group \\ General \\ Rename Group",
    "RelativeRunbookPath": "group/general/rename-group.ps1",
    "RelativeRunbookPath_PathOnly": "group/general",
    "PrimaryFolder": "Group",
    "SubFolder": "General",
    "Synopsis": "Rename a group.",
    "Description": "This runbook updates a group's DisplayName, MailNickname, and Description.\nIt does not change the group's email addresses.\nProvide only the fields you want to update; empty values are ignored.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "New description for the group."
          }
        ],
        "globbing": "false",
        "name": "Description",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "New display name for the group."
          }
        ],
        "globbing": "false",
        "name": "DisplayName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the group to update."
          }
        ],
        "globbing": "false",
        "name": "GroupId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "New mail nickname (alias) for the group."
          }
        ],
        "globbing": "false",
        "name": "MailNickname",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Enable Or Disable External Mail",
    "RunbookDisplayPath": "Group \\ Mail \\ Enable Or Disable External Mail",
    "RelativeRunbookPath": "group/mail/enable-or-disable-external-mail.ps1",
    "RelativeRunbookPath_PathOnly": "group/mail",
    "PrimaryFolder": "Group",
    "SubFolder": "Mail",
    "Synopsis": "Enable or disable external parties to send emails to a Microsoft 365 group",
    "Description": "This runbook configures whether external senders are allowed to email a Microsoft 365 group.\nIt uses Exchange Online to enable or disable the RequireSenderAuthenticationEnabled setting.\nYou can also query the current state without making changes.",
    "Notes": "Setting this via Microsoft Graph is broken as of 2021-06-28.\nAttribute: allowExternalSenders.\nSee https://docs.microsoft.com/en-us/graph/known-issues#setting-the-allowexternalsenders-property.",
    "Parameters": [
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "\"Enable External Mail\" (final value: 0), \"Disable External Mail\" (final value: 1) or \"Query current state only\" (final value: 2) can be selected as action to perform. If set to 0, the runbook will allow external senders to email the group. If set to 1, it will block external senders from emailing the group. If set to 2, it will return whether external mailing is currently enabled or disabled for the group without making any changes."
          }
        ],
        "globbing": "false",
        "name": "Action",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the Microsoft 365 group."
          }
        ],
        "globbing": "false",
        "name": "GroupId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Show Or Hide In Address Book",
    "RunbookDisplayPath": "Group \\ Mail \\ Show Or Hide In Address Book",
    "RelativeRunbookPath": "group/mail/show-or-hide-in-address-book.ps1",
    "RelativeRunbookPath_PathOnly": "group/mail",
    "PrimaryFolder": "Group",
    "SubFolder": "Mail",
    "Synopsis": "Show or hide a group in the address book",
    "Description": "This runbook shows or hides a Microsoft 365 group or a distribution group from address lists.\nYou can also query the current visibility state without making changes.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "1",
        "description": [
          {
            "Text": "\"Show Group in Address Book\" (final value: 0), \"Hide Group from Address Book\" (final value: 1) or \"Query current state only\" (final value: 2) can be selected as action to perform. If set to 0, the runbook will make the group visible in address lists. If set to 1, it will hide the group from address lists. If set to 2, it will return whether the group is currently hidden from address lists without making any changes."
          }
        ],
        "globbing": "false",
        "name": "Action",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes"
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The identity of the target group (name, alias, or other Exchange identity value)."
          }
        ],
        "globbing": "false",
        "name": "GroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Archive Team",
    "RunbookDisplayPath": "Group \\ Teams \\ Archive Team",
    "RelativeRunbookPath": "group/teams/archive-team.ps1",
    "RelativeRunbookPath_PathOnly": "group/teams",
    "PrimaryFolder": "Group",
    "SubFolder": "Teams",
    "Synopsis": "Archive a team",
    "Description": "This runbook archives a Microsoft Teams team backed by the specified Microsoft 365 group.\nIt verifies that the group is provisioned as a team and then triggers the archive action via Microsoft Graph.\nUse this to decommission inactive teams while preserving their contents for review.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the Microsoft 365 group that backs the team."
          }
        ],
        "globbing": "false",
        "name": "GroupID",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"TeamSettings.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "TeamSettings.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Application Registration",
    "RunbookDisplayPath": "Org \\ Applications \\ Add Application Registration",
    "RelativeRunbookPath": "org/applications/add-application-registration.ps1",
    "RelativeRunbookPath_PathOnly": "org/applications",
    "PrimaryFolder": "Org",
    "SubFolder": "Applications",
    "Synopsis": "Add an application registration to Azure AD",
    "Description": "This runbook creates a new application registration in Microsoft Entra ID and optionally configures redirect URIs and SAML settings.\nIt validates the submitted parameters, prevents duplicate app creation, and writes verbose logs for troubleshooting.\nUse it to standardize application registration setup, including visibility and assignment-related options.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The display name of the application registration to create."
          }
        ],
        "globbing": "false",
        "name": "ApplicationName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "20",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, SAML-based authentication is configured for the application. If enabled, additional SAML-related parameters become required."
          }
        ],
        "globbing": "false",
        "name": "EnableSAML",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "col - Entra - users -",
        "description": [
          {
            "Text": "Prefix for the automatically created EntraID group when UserAssignmentRequired is enabled. Default is \"col - Entra - users - \"."
          }
        ],
        "globbing": "false",
        "name": "groupAssignmentPrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "17",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Enable implicit grant flow for access tokens. Default is false."
          }
        ],
        "globbing": "false",
        "name": "implicitGrantAccessTokens",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "18",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Enable implicit grant flow for ID tokens. Default is false."
          }
        ],
        "globbing": "false",
        "name": "implicitGrantIDTokens",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "19",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Determines whether the application is visible in the My Apps portal. Default is true."
          }
        ],
        "globbing": "false",
        "name": "isApplicationVisible",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "15",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Redirect URI or URIs for public client/native applications. Multiple values can be separated by semicolons."
          }
        ],
        "globbing": "false",
        "name": "publicClientRedirectURI",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Used for UI selection only. Determines which redirect URI type to configure - None, Web, SPA, or Public Client"
          }
        ],
        "globbing": "false",
        "name": "RedirectURI",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "3",
        "description": [
          {
            "Text": "Lifetime of the SAML token signing certificate in years. Default is 3 years."
          }
        ],
        "globbing": "false",
        "name": "SAMLCertificateLifeYears",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "14",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Email address to receive notifications when the SAML token signing certificate is about to expire."
          }
        ],
        "globbing": "false",
        "name": "SAMLExpiryNotificationEmail",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "13",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The SAML identifier (Entity ID). If not specified, defaults to \"urn:app:{AppId}\"."
          }
        ],
        "globbing": "false",
        "name": "SAMLIdentifier",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The logout URL for SAML authentication."
          }
        ],
        "globbing": "false",
        "name": "SAMLLogoutURL",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The SAML relay state parameter for maintaining application state during authentication."
          }
        ],
        "globbing": "false",
        "name": "SAMLRelayState",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The reply URL for SAML-based authentication"
          }
        ],
        "globbing": "false",
        "name": "SAMLReplyURL",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The sign-on URL for SAML authentication."
          }
        ],
        "globbing": "false",
        "name": "SAMLSignOnURL",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "AzureADMyOrg",
        "description": [
          {
            "Text": "Specifies who can use the application. Defaults to \"AzureADMyOrg\" (single tenant)."
          }
        ],
        "globbing": "false",
        "name": "signInAudience",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Redirect URI or URIs for single-page applications. Multiple values can be separated by semicolons."
          }
        ],
        "globbing": "false",
        "name": "spaRedirectURI",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Determines whether users must be assigned to the application before accessing it. When enabled, an EntraID group is created for user assignment. Default is false."
          }
        ],
        "globbing": "false",
        "name": "UserAssignmentRequired",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "16",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Redirect URI or URIs for web applications. Multiple values can be separated by semicolons."
          }
        ],
        "globbing": "false",
        "name": "webRedirectURI",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Application.ReadWrite.OwnedBy\",\n                \"Organization.Read.All\",\n                \"Group.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Application Developer\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Application.ReadWrite.OwnedBy",
            "Organization.Read.All",
            "Group.ReadWrite.All"
          ]
        }
      ],
      "Roles": [
        "Application Developer"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Delete Application Registration",
    "RunbookDisplayPath": "Org \\ Applications \\ Delete Application Registration",
    "RelativeRunbookPath": "org/applications/delete-application-registration.ps1",
    "RelativeRunbookPath_PathOnly": "org/applications",
    "PrimaryFolder": "Org",
    "SubFolder": "Applications",
    "Synopsis": "Delete an application registration from Azure AD",
    "Description": "This runbook deletes an application registration and its associated service principal from Microsoft Entra ID.\nIt verifies that the application exists before deletion and performs a best-effort cleanup of groups assigned during provisioning.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The application client ID (appId) of the application registration to delete."
          }
        ],
        "globbing": "false",
        "name": "ClientId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Application.ReadWrite.OwnedBy\",\n                \"Group.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Application Developer\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Application.ReadWrite.OwnedBy",
            "Group.ReadWrite.All"
          ]
        }
      ],
      "Roles": [
        "Application Developer"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Export Enterprise Application Users",
    "RunbookDisplayPath": "Org \\ Applications \\ Export Enterprise Application Users",
    "RelativeRunbookPath": "org/applications/export-enterprise-application-users.ps1",
    "RelativeRunbookPath_PathOnly": "org/applications",
    "PrimaryFolder": "Org",
    "SubFolder": "Applications",
    "Synopsis": "Export a CSV of all (enterprise) application owners and users",
    "Description": "This runbook exports a CSV report of enterprise applications (or all service principals) including owners and assigned users or groups.\nIt uploads the generated CSV file to an Azure Storage Account and returns a time-limited download link.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage container name used for the upload."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Determines whether to export only enterprise applications (final value: true) or all service principals/applications (final value: false)."
          }
        ],
        "globbing": "false",
        "name": "entAppsOnly",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Resource group that contains the storage account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the storage account, used when the account needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage account name used for the upload."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage account SKU, used when the account needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Directory.Read.All\",\n                \"Application.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": [\n        \"Azure IaaS: - Contributor - access on subscription or resource group used for the export\"\n    ]\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Directory.Read.All",
            "Application.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": [
        "Azure IaaS: - Contributor - access on subscription or resource group used for the export"
      ]
    }
  },
  {
    "RunbookDisplayName": "List Inactive Enterprise Applications",
    "RunbookDisplayPath": "Org \\ Applications \\ List Inactive Enterprise Applications",
    "RelativeRunbookPath": "org/applications/list-inactive-enterprise-applications.ps1",
    "RelativeRunbookPath_PathOnly": "org/applications",
    "PrimaryFolder": "Org",
    "SubFolder": "Applications",
    "Synopsis": "List enterprise applications with no recent sign-ins",
    "Description": "This runbook identifies enterprise applications with no recent sign-in activity based on Microsoft Entra ID sign-in logs.\nIt lists apps that have not been used for the specified number of days and apps that have no sign-in records.\nUse it to find candidates for review, cleanup, or decommissioning.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "90",
        "description": [
          {
            "Text": "Number of days without user logon to consider an application as inactive. Default is 90 days."
          }
        ],
        "globbing": "false",
        "name": "Days",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Directory.Read.All\",\n                \"Device.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Directory.Read.All",
            "Device.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Report Application Registration",
    "RunbookDisplayPath": "Org \\ Applications \\ Report Application Registration",
    "RelativeRunbookPath": "org/applications/report-application-registration.ps1",
    "RelativeRunbookPath_PathOnly": "org/applications",
    "PrimaryFolder": "Org",
    "SubFolder": "Applications",
    "Synopsis": "Generate and email a comprehensive Application Registration report",
    "Description": "This runbook generates a report of all application registrations in Microsoft Entra ID and can optionally include deleted registrations.\nIt exports the results to CSV files and sends them via email.\nUse it for periodic inventory, review, and audit purposes.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The sender email address. This needs to be configured in the runbook customization."
          }
        ],
        "globbing": "false",
        "name": "EmailFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Can be a single address or multiple comma-separated addresses (string).\nThe function sends individual emails to each recipient for privacy reasons."
          }
        ],
        "globbing": "false",
        "name": "EmailTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Whether to include deleted application registrations in the report (default: true)"
          }
        ],
        "globbing": "false",
        "name": "IncludeDeletedApps",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": "## Setup regarding email sending\n\nThis runbook sends emails using the Microsoft Graph API. To send emails via Graph API, you need to configure an existing email address in the runbook customization.\n\nThis process is described in detail in the [Setup Email Reporting](https://github.com/realmjoin/realmjoin-runbooks/tree/master/docs/general/setup-email-reporting.md) documentation.\n",
    "DocsContentEncoded": "IyMgU2V0dXAgcmVnYXJkaW5nIGVtYWlsIHNlbmRpbmcKClRoaXMgcnVuYm9vayBzZW5kcyBlbWFpbHMgdXNpbmcgdGhlIE1pY3Jvc29mdCBHcmFwaCBBUEkuIFRvIHNlbmQgZW1haWxzIHZpYSBHcmFwaCBBUEksIHlvdSBuZWVkIHRvIGNvbmZpZ3VyZSBhbiBleGlzdGluZyBlbWFpbCBhZGRyZXNzIGluIHRoZSBydW5ib29rIGN1c3RvbWl6YXRpb24uCgpUaGlzIHByb2Nlc3MgaXMgZGVzY3JpYmVkIGluIGRldGFpbCBpbiB0aGUgW1NldHVwIEVtYWlsIFJlcG9ydGluZ10oaHR0cHM6Ly9naXRodWIuY29tL3JlYWxtam9pbi9yZWFsbWpvaW4tcnVuYm9va3MvdHJlZS9tYXN0ZXIvZG9jcy9nZW5lcmFsL3NldHVwLWVtYWlsLXJlcG9ydGluZy5tZCkgZG9jdW1lbnRhdGlvbi4K",
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Application.Read.All\",\n                \"Directory.Read.All\",\n                \"Mail.Send\",\n                \"Organization.Read.All\"\n            ]\n        }  \n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Application.Read.All",
            "Directory.Read.All",
            "Mail.Send",
            "Organization.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Report Expiring Application Credentials_Scheduled",
    "RunbookDisplayPath": "Org \\ Applications \\ Report Expiring Application Credentials_Scheduled",
    "RelativeRunbookPath": "org/applications/report-expiring-application-credentials_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/applications",
    "PrimaryFolder": "Org",
    "SubFolder": "Applications",
    "Synopsis": "List expiry date of all Application Registration credentials",
    "Description": "This runbook lists the expiry dates of application registration credentials, including client secrets and certificates.\nIt can optionally filter by application IDs and can limit output to credentials that are about to expire.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional - comma-separated list of Application IDs to filter the credentials."
          }
        ],
        "globbing": "false",
        "name": "ApplicationIds",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Both",
        "description": [
          {
            "Text": "Filter by credential type: \"Both\" (default), \"ClientSecrets\", or \"Certificates\"."
          }
        ],
        "globbing": "false",
        "name": "CredentialType",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "30",
        "description": [
          {
            "Text": "The number of days before a credential expires to consider it \"about to expire\"."
          }
        ],
        "globbing": "false",
        "name": "Days",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The sender email address. This needs to be configured in the runbook customization."
          }
        ],
        "globbing": "false",
        "name": "EmailFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "If specified, an email with the report will be sent to the provided address(es).\nCan be a single address or multiple comma-separated addresses (string).\nThe function sends individual emails to each recipient for privacy reasons."
          }
        ],
        "globbing": "false",
        "name": "EmailTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If only credentials that are about to expire within the specified number of days should be listed, select \"List only credentials about to expire\" (final value: true).\nIf you want to list all credentials regardless of their expiry date, select \"List all credentials\" (final value: false)."
          }
        ],
        "globbing": "false",
        "name": "listOnlyExpiring",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": "## Setup regarding email sending\n\nThis runbook sends emails using the Microsoft Graph API. To send emails via Graph API, you need to configure an existing email address in the runbook customization.\n\nThis process is described in detail in the [Setup Email Reporting](https://github.com/realmjoin/realmjoin-runbooks/tree/master/docs/general/setup-email-reporting.md) documentation.\n",
    "DocsContentEncoded": "IyMgU2V0dXAgcmVnYXJkaW5nIGVtYWlsIHNlbmRpbmcKClRoaXMgcnVuYm9vayBzZW5kcyBlbWFpbHMgdXNpbmcgdGhlIE1pY3Jvc29mdCBHcmFwaCBBUEkuIFRvIHNlbmQgZW1haWxzIHZpYSBHcmFwaCBBUEksIHlvdSBuZWVkIHRvIGNvbmZpZ3VyZSBhbiBleGlzdGluZyBlbWFpbCBhZGRyZXNzIGluIHRoZSBydW5ib29rIGN1c3RvbWl6YXRpb24uCgpUaGlzIHByb2Nlc3MgaXMgZGVzY3JpYmVkIGluIGRldGFpbCBpbiB0aGUgW1NldHVwIEVtYWlsIFJlcG9ydGluZ10oaHR0cHM6Ly9naXRodWIuY29tL3JlYWxtam9pbi9yZWFsbWpvaW4tcnVuYm9va3MvdHJlZS9tYXN0ZXIvZG9jcy9nZW5lcmFsL3NldHVwLWVtYWlsLXJlcG9ydGluZy5tZCkgZG9jdW1lbnRhdGlvbi4K",
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Application.Read.All\",\n                \"Mail.Send\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Application.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Update Application Registration",
    "RunbookDisplayPath": "Org \\ Applications \\ Update Application Registration",
    "RelativeRunbookPath": "org/applications/update-application-registration.ps1",
    "RelativeRunbookPath_PathOnly": "org/applications",
    "PrimaryFolder": "Org",
    "SubFolder": "Applications",
    "Synopsis": "Update an application registration in Azure AD",
    "Description": "This runbook updates an existing application registration and its related configuration in Microsoft Entra ID.\nIt compares the current settings with the requested parameters and applies only the necessary updates.\nUse it to manage redirect URIs, SAML settings, visibility, assignment requirements, and token issuance behavior.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "19",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The application client ID (appId) of the application registration to update."
          }
        ],
        "globbing": "false",
        "name": "ClientId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, disables implicit grant issuance regardless of other settings."
          }
        ],
        "globbing": "false",
        "name": "disableImplicitGrant",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "18",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, SAML-based authentication is configured on the service principal."
          }
        ],
        "globbing": "false",
        "name": "EnableSAML",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "col - Entra - users -",
        "description": [
          {
            "Text": "Prefix for the automatically created assignment group."
          }
        ],
        "globbing": "false",
        "name": "groupAssignmentPrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "15",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Enable implicit grant flow for access tokens."
          }
        ],
        "globbing": "false",
        "name": "implicitGrantAccessTokens",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "16",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Enable implicit grant flow for ID tokens."
          }
        ],
        "globbing": "false",
        "name": "implicitGrantIDTokens",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "17",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Determines whether the application is visible in the My Apps portal."
          }
        ],
        "globbing": "false",
        "name": "isApplicationVisible",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "13",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Redirect URI or URIs for public client/native applications. Multiple values can be separated by semicolons."
          }
        ],
        "globbing": "false",
        "name": "publicClientRedirectURI",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Used for UI selection only. Determines which redirect URI type to configure."
          }
        ],
        "globbing": "false",
        "name": "RedirectURI",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Email address for SAML certificate expiry notifications."
          }
        ],
        "globbing": "false",
        "name": "SAMLExpiryNotificationEmail",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The SAML identifier (Entity ID)."
          }
        ],
        "globbing": "false",
        "name": "SAMLIdentifier",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The SAML logout URL."
          }
        ],
        "globbing": "false",
        "name": "SAMLLogoutURL",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The SAML relay state parameter."
          }
        ],
        "globbing": "false",
        "name": "SAMLRelayState",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The SAML reply URL."
          }
        ],
        "globbing": "false",
        "name": "SAMLReplyURL",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The SAML sign-on URL."
          }
        ],
        "globbing": "false",
        "name": "SAMLSignOnURL",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Redirect URI or URIs for single-page applications. Multiple values can be separated by semicolons."
          }
        ],
        "globbing": "false",
        "name": "spaRedirectURI",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Determines whether user assignment is required for the application."
          }
        ],
        "globbing": "false",
        "name": "UserAssignmentRequired",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "14",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Redirect URI or URIs for web applications. Multiple values can be separated by semicolons."
          }
        ],
        "globbing": "false",
        "name": "webRedirectURI",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Application.ReadWrite.OwnedBy\",\n                \"Organization.Read.All\",\n                \"Group.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Application Developer\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Application.ReadWrite.OwnedBy",
            "Organization.Read.All",
            "Group.ReadWrite.All"
          ]
        }
      ],
      "Roles": [
        "Application Developer"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Autopilot Device",
    "RunbookDisplayPath": "Org \\ Devices \\ Add Autopilot Device",
    "RelativeRunbookPath": "org/devices/add-autopilot-device.ps1",
    "RelativeRunbookPath_PathOnly": "org/devices",
    "PrimaryFolder": "Org",
    "SubFolder": "Devices",
    "Synopsis": "Import a Windows device into Windows Autopilot",
    "Description": "This runbook imports a Windows device into Windows Autopilot using the device serial number and hardware hash.\nIt can optionally wait for the import job to finish and supports tagging during import.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional user to assign to the Autopilot device."
          }
        ],
        "globbing": "false",
        "name": "AssignedUser",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional group tag to apply to the imported device."
          }
        ],
        "globbing": "false",
        "name": "GroupTag",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Device hardware hash as returned by Get-WindowsAutopilotInfo."
          }
        ],
        "globbing": "false",
        "name": "HardwareIdentifier",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Device serial number as returned by Get-WindowsAutopilotInfo."
          }
        ],
        "globbing": "false",
        "name": "SerialNumber",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, the runbook waits until the import job completes."
          }
        ],
        "globbing": "false",
        "name": "Wait",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementServiceConfig.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementServiceConfig.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Device Via Corporate Identifier",
    "RunbookDisplayPath": "Org \\ Devices \\ Add Device Via Corporate Identifier",
    "RelativeRunbookPath": "org/devices/add-device-via-corporate-identifier.ps1",
    "RelativeRunbookPath_PathOnly": "org/devices",
    "PrimaryFolder": "Org",
    "SubFolder": "Devices",
    "Synopsis": "Import a device into Intune via corporate identifier",
    "Description": "This runbook imports a device into Intune using a corporate identifier such as serial number or IMEI.\nIt can overwrite existing entries and optionally stores a description for the imported identity.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Identifier value to import."
          }
        ],
        "globbing": "false",
        "name": "CorpIdentifier",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "serialNumber",
        "description": [
          {
            "Text": "Identifier type to use for import."
          }
        ],
        "globbing": "false",
        "name": "CorpIdentifierType",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional description stored for the imported identity."
          }
        ],
        "globbing": "false",
        "name": "DeviceDescripton",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, an existing entry for the same identifier will be overwritten."
          }
        ],
        "globbing": "false",
        "name": "OverwriteExistingEntry",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementServiceConfig.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementServiceConfig.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Delete Stale Devices_Scheduled",
    "RunbookDisplayPath": "Org \\ Devices \\ Delete Stale Devices_Scheduled",
    "RelativeRunbookPath": "org/devices/delete-stale-devices_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/devices",
    "PrimaryFolder": "Org",
    "SubFolder": "Devices",
    "Synopsis": "Scheduled deletion of stale devices based on last activity",
    "Description": "This runbook identifies Intune managed devices that have not been active for a defined number of days.\nIt can optionally delete the matching devices and can send an email report.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include Android devices in the results"
          }
        ],
        "globbing": "false",
        "name": "Android",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, the script will prompt for confirmation before deleting devices.\nShould be set to false for scheduled runs."
          }
        ],
        "globbing": "false",
        "name": "ConfirmDeletion",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "30",
        "description": [
          {
            "Text": "Number of days without activity to be considered stale"
          }
        ],
        "globbing": "false",
        "name": "Days",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the script will delete the stale devices. If false, it will only report them."
          }
        ],
        "globbing": "false",
        "name": "DeleteDevices",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include iOS devices in the results"
          }
        ],
        "globbing": "false",
        "name": "iOS",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include macOS devices in the results"
          }
        ],
        "globbing": "false",
        "name": "MacOS",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "runbook@glueckkanja.com",
        "description": [
          {
            "Text": "Email address to send the report from."
          }
        ],
        "globbing": "false",
        "name": "sendAlertFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "support@glueckkanja.com",
        "description": [
          {
            "Text": "Email address to send the report to."
          }
        ],
        "globbing": "false",
        "name": "sendAlertTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include Windows devices in the results"
          }
        ],
        "globbing": "false",
        "name": "Windows",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n  \"Permissions\": [\n    {\n      \"Name\": \"Microsoft Graph\",\n      \"Id\": \"00000003-0000-0000-c000-000000000000\",\n      \"AppRoleAssignments\": [\n        \"DeviceManagementManagedDevices.Read.All\",\n        \"DeviceManagementManagedDevices.DeleteAll\",\n        \"Directory.Read.All\",\n        \"Device.Read.All\",\n        \"Mail.Send\"\n      ]\n    }\n  ],\n  \"Roles\": [],\n  \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All",
            "DeviceManagementManagedDevices.DeleteAll",
            "Directory.Read.All",
            "Device.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Get Bitlocker Recovery Key",
    "RunbookDisplayPath": "Org \\ Devices \\ Get Bitlocker Recovery Key",
    "RelativeRunbookPath": "org/devices/get-bitlocker-recovery-key.ps1",
    "RelativeRunbookPath_PathOnly": "org/devices",
    "PrimaryFolder": "Org",
    "SubFolder": "Devices",
    "Synopsis": "Get the BitLocker recovery key",
    "Description": "This runbook retrieves a BitLocker recovery key using the recovery key ID from the BitLocker recovery screen.\nIt returns key details and related device information.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Recovery key ID of the desired key."
          }
        ],
        "globbing": "false",
        "name": "bitlockeryRecoveryKeyId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Device.Read.All\",\n                \"BitlockerKey.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Device.Read.All",
            "BitlockerKey.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Notify Users About Stale Devices_Scheduled",
    "RunbookDisplayPath": "Org \\ Devices \\ Notify Users About Stale Devices_Scheduled",
    "RelativeRunbookPath": "org/devices/notify-users-about-stale-devices_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/devices",
    "PrimaryFolder": "Org",
    "SubFolder": "Devices",
    "Synopsis": "Notify primary users about their stale devices via email",
    "Description": "Identifies devices that haven't been active for a specified number of days and sends personalized email notifications to the primary users of those devices. The email contains device information and action steps for the user. Optionally filter users by including or excluding specific groups.",
    "Notes": "This runbook automatically sends personalized email notifications to users who have devices that haven't synced for a specified number of days.\nThe email is sent directly to the primary user's email address and includes detailed information about each inactive device.\n\nPrerequisites:\n- EmailFrom parameter must be configured in runbook customization (RJReport.EmailSender setting)\n- Optional: Service Desk contact information can be configured (ServiceDesk_DisplayName, ServiceDesk_EMail, ServiceDesk_Phone)\n\nCommon Use Cases:\n- Automated user reminders about inactive devices to encourage regular device check-ins\n- Proactive device lifecycle management by alerting users before devices are retired\n- Security and compliance by ensuring users are aware of all devices registered to them\n- Using MaxDays parameter for staged notifications (e.g., first reminder at 30 days, final notice at 60 days)\n- User scope filtering to target specific departments or exclude service accounts\n\nPilot and Testing Options:\n- Use OverrideEmailRecipient parameter to send all notifications to a test mailbox instead of end users\n- Perfect for validating email content and testing filters before rolling out to production\n- Send notifications to ticket systems or shared mailboxes for centralized handling",
    "Parameters": [
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include Android devices in the results."
          }
        ],
        "globbing": "false",
        "name": "Android",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "15",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "30",
        "description": [
          {
            "Text": "Number of days without activity to be considered stale (minimum threshold)."
          }
        ],
        "globbing": "false",
        "name": "Days",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The sender email address. This needs to be configured in the runbook customization."
          }
        ],
        "globbing": "false",
        "name": "EmailFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Do not send emails to users who are members of this group. Requires UseUserScope to be enabled."
          }
        ],
        "globbing": "false",
        "name": "ExcludeUserGroup",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "13",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Only send emails to users who are members of this group. Requires UseUserScope to be enabled."
          }
        ],
        "globbing": "false",
        "name": "IncludeUserGroup",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include iOS devices in the results."
          }
        ],
        "globbing": "false",
        "name": "iOS",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include macOS devices in the results."
          }
        ],
        "globbing": "false",
        "name": "MacOS",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional maximum number of days without activity. If set, only devices inactive between Days and MaxDays will be included."
          }
        ],
        "globbing": "false",
        "name": "MaxDays",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional: Email address(es) to send all notifications to instead of end users. Can be comma-separated for multiple recipients. Perfect for testing, piloting, or sending to ticket systems. If left empty, emails will be sent to the actual end users."
          }
        ],
        "globbing": "false",
        "name": "OverrideEmailRecipient",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "14",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Service Desk display name for user contact information (optional)."
          }
        ],
        "globbing": "false",
        "name": "ServiceDeskDisplayName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Service Desk email address for user contact information (optional)."
          }
        ],
        "globbing": "false",
        "name": "ServiceDeskEmail",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Service Desk phone number for user contact information (optional)."
          }
        ],
        "globbing": "false",
        "name": "ServiceDeskPhone",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Enable user scope filtering to include or exclude users based on group membership."
          }
        ],
        "globbing": "false",
        "name": "UseUserScope",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include Windows devices in the results."
          }
        ],
        "globbing": "false",
        "name": "Windows",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": "## Setup regarding email sending\n\nThis runbook sends emails using the Microsoft Graph API. To send emails via Graph API, you need to configure an existing email address in the runbook customization.\n\nThis process is described in detail in the [Setup Email Reporting](https://github.com/realmjoin/realmjoin-runbooks/tree/master/docs/general/setup-email-reporting.md) documentation.\n\n",
    "DocsContentEncoded": "IyMgU2V0dXAgcmVnYXJkaW5nIGVtYWlsIHNlbmRpbmcKClRoaXMgcnVuYm9vayBzZW5kcyBlbWFpbHMgdXNpbmcgdGhlIE1pY3Jvc29mdCBHcmFwaCBBUEkuIFRvIHNlbmQgZW1haWxzIHZpYSBHcmFwaCBBUEksIHlvdSBuZWVkIHRvIGNvbmZpZ3VyZSBhbiBleGlzdGluZyBlbWFpbCBhZGRyZXNzIGluIHRoZSBydW5ib29rIGN1c3RvbWl6YXRpb24uCgpUaGlzIHByb2Nlc3MgaXMgZGVzY3JpYmVkIGluIGRldGFpbCBpbiB0aGUgW1NldHVwIEVtYWlsIFJlcG9ydGluZ10oaHR0cHM6Ly9naXRodWIuY29tL3JlYWxtam9pbi9yZWFsbWpvaW4tcnVuYm9va3MvdHJlZS9tYXN0ZXIvZG9jcy9nZW5lcmFsL3NldHVwLWVtYWlsLXJlcG9ydGluZy5tZCkgZG9jdW1lbnRhdGlvbi4KCg==",
    "PermissionsContent": "{\n  \"Permissions\": [\n    {\n      \"Name\": \"Microsoft Graph\",\n      \"Id\": \"00000003-0000-0000-c000-000000000000\",\n      \"AppRoleAssignments\": [\n        \"DeviceManagementManagedDevices.Read.All\",\n        \"Directory.Read.All\",\n        \"Device.Read.All\",\n        \"Group.Read.All\",\n        \"Mail.Send\"\n      ]\n    }\n  ],\n  \"Roles\": [],\n  \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All",
            "Directory.Read.All",
            "Device.Read.All",
            "Group.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Outphase Devices",
    "RunbookDisplayPath": "Org \\ Devices \\ Outphase Devices",
    "RelativeRunbookPath": "org/devices/outphase-devices.ps1",
    "RelativeRunbookPath_PathOnly": "org/devices",
    "PrimaryFolder": "Org",
    "SubFolder": "Devices",
    "Synopsis": "Remove or outphase multiple devices",
    "Description": "This runbook outphases multiple devices based on a comma-separated list of device IDs or serial numbers.\nIt can optionally wipe devices in Intune and delete or disable the corresponding Entra ID device objects.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "2",
        "description": [
          {
            "Text": "Determines whether to delete the Entra ID device, disable it, or skip Entra ID actions."
          }
        ],
        "globbing": "false",
        "name": "aadAction",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Comma-separated list of device IDs or serial numbers."
          }
        ],
        "globbing": "false",
        "name": "DeviceList",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "Determines whether the list contains device IDs or serial numbers."
          }
        ],
        "globbing": "false",
        "name": "DeviceListChoice",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Internal flag derived from aadAction."
          }
        ],
        "globbing": "false",
        "name": "disableAADDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "2",
        "description": [
          {
            "Text": "Determines whether to wipe the device, delete it from Intune, or skip Intune actions."
          }
        ],
        "globbing": "false",
        "name": "intuneAction",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Internal flag derived from aadAction."
          }
        ],
        "globbing": "false",
        "name": "removeAADDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "\"Remove the device from Autopilot\" (final value: true) or \"Keep device in Autopilot\" (final value: false) handles whether to delete the device from the Autopilot database."
          }
        ],
        "globbing": "false",
        "name": "removeAutopilotDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Internal flag derived from intuneAction."
          }
        ],
        "globbing": "false",
        "name": "removeIntuneDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Internal flag derived from intuneAction."
          }
        ],
        "globbing": "false",
        "name": "wipeDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.PrivilegedOperations.All\",\n                \"DeviceManagementManagedDevices.ReadWrite.All\",\n                \"DeviceManagementServiceConfig.ReadWrite.All\",\n                \"Device.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Cloud device administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.PrivilegedOperations.All",
            "DeviceManagementManagedDevices.ReadWrite.All",
            "DeviceManagementServiceConfig.ReadWrite.All",
            "Device.Read.All"
          ]
        }
      ],
      "Roles": [
        "Cloud device administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Report Devices Without Primary User",
    "RunbookDisplayPath": "Org \\ Devices \\ Report Devices Without Primary User",
    "RelativeRunbookPath": "org/devices/report-devices-without-primary-user.ps1",
    "RelativeRunbookPath_PathOnly": "org/devices",
    "PrimaryFolder": "Org",
    "SubFolder": "Devices",
    "Synopsis": "Reports all managed devices in Intune that do not have a primary user assigned.",
    "Description": "This script retrieves all managed devices from Intune, and filters out those without a primary user (userId).\nThe output is a formatted table showing Object ID, Device ID, Display Name, and Last Sync Date/Time for each device without a primary user.\n\nOptionally, the report can be sent via email with a CSV attachment containing detailed device information",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The sender email address. This needs to be configured in the runbook customization."
          }
        ],
        "globbing": "false",
        "name": "EmailFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "If specified, an email with the report will be sent to the provided address(es).\nCan be a single address or multiple comma-separated addresses (string).\nThe function sends individual emails to each recipient for privacy reasons."
          }
        ],
        "globbing": "false",
        "name": "EmailTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": "## Setup regarding email sending\n\nThis runbook sends emails using the Microsoft Graph API. To send emails via Graph API, you need to configure an existing email address in the runbook customization.\n\nThis process is described in detail in the [Setup Email Reporting](https://github.com/realmjoin/realmjoin-runbooks/tree/master/docs/general/setup-email-reporting.md) documentation.\n",
    "DocsContentEncoded": "IyMgU2V0dXAgcmVnYXJkaW5nIGVtYWlsIHNlbmRpbmcKClRoaXMgcnVuYm9vayBzZW5kcyBlbWFpbHMgdXNpbmcgdGhlIE1pY3Jvc29mdCBHcmFwaCBBUEkuIFRvIHNlbmQgZW1haWxzIHZpYSBHcmFwaCBBUEksIHlvdSBuZWVkIHRvIGNvbmZpZ3VyZSBhbiBleGlzdGluZyBlbWFpbCBhZGRyZXNzIGluIHRoZSBydW5ib29rIGN1c3RvbWl6YXRpb24uCgpUaGlzIHByb2Nlc3MgaXMgZGVzY3JpYmVkIGluIGRldGFpbCBpbiB0aGUgW1NldHVwIEVtYWlsIFJlcG9ydGluZ10oaHR0cHM6Ly9naXRodWIuY29tL3JlYWxtam9pbi9yZWFsbWpvaW4tcnVuYm9va3MvdHJlZS9tYXN0ZXIvZG9jcy9nZW5lcmFsL3NldHVwLWVtYWlsLXJlcG9ydGluZy5tZCkgZG9jdW1lbnRhdGlvbi4K",
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"Mail.Send\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Report Stale Devices_Scheduled",
    "RunbookDisplayPath": "Org \\ Devices \\ Report Stale Devices_Scheduled",
    "RelativeRunbookPath": "org/devices/report-stale-devices_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/devices",
    "PrimaryFolder": "Org",
    "SubFolder": "Devices",
    "Synopsis": "Scheduled report of stale devices based on last activity date and platform.",
    "Description": "Identifies and lists devices that haven't been active for a specified number of days.\nAutomatically sends a report via email.",
    "Notes": "This runbook generates a comprehensive report of stale devices and delivers it via email.\nThe report includes device details, platform breakdowns, and exports a CSV file for further analysis.\n\nPrerequisites:\n- EmailFrom parameter must be configured in runbook customization (RJReport.EmailSender setting)\n\nCommon Use Cases:\n- Regular device inventory audits and compliance reporting\n- Identifying devices for retirement or decommissioning\n- Security reviews to find potentially lost devices\n- Monitoring device health across the organization\n- Using MaxDays parameter for staged reporting (e.g., 30-60 days, 60-90 days)\n- User scope filtering to focus on specific departments or exclude service accounts\n\nThe runbook supports optional user scope filtering to include or exclude devices based on primary user group membership.",
    "Parameters": [
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include Android devices in the results."
          }
        ],
        "globbing": "false",
        "name": "Android",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "12",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "30",
        "description": [
          {
            "Text": "Number of days without activity to be considered stale."
          }
        ],
        "globbing": "false",
        "name": "Days",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The sender email address. This needs to be configured in the runbook customization"
          }
        ],
        "globbing": "false",
        "name": "EmailFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Can be a single address or multiple comma-separated addresses (string).\nThe function sends individual emails to each recipient for privacy reasons."
          }
        ],
        "globbing": "false",
        "name": "EmailTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "11",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Exclude devices whose primary users are members of this group. Requires UseUserScope to be enabled."
          }
        ],
        "globbing": "false",
        "name": "ExcludeUserGroup",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Only include devices whose primary users are members of this group. Requires UseUserScope to be enabled."
          }
        ],
        "globbing": "false",
        "name": "IncludeUserGroup",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include iOS devices in the results."
          }
        ],
        "globbing": "false",
        "name": "iOS",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include macOS devices in the results."
          }
        ],
        "globbing": "false",
        "name": "MacOS",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional maximum number of days without activity. If set, only devices inactive between Days and MaxDays will be included."
          }
        ],
        "globbing": "false",
        "name": "MaxDays",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Enable user scope filtering to include or exclude devices based on primary user group membership."
          }
        ],
        "globbing": "false",
        "name": "UseUserScope",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include Windows devices in the results."
          }
        ],
        "globbing": "false",
        "name": "Windows",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": "## Setup regarding email sending\n\nThis runbook sends emails using the Microsoft Graph API. To send emails via Graph API, you need to configure an existing email address in the runbook customization.\n\nThis process is described in detail in the [Setup Email Reporting](https://github.com/realmjoin/realmjoin-runbooks/tree/master/docs/general/setup-email-reporting.md) documentation.\n",
    "DocsContentEncoded": "IyMgU2V0dXAgcmVnYXJkaW5nIGVtYWlsIHNlbmRpbmcKClRoaXMgcnVuYm9vayBzZW5kcyBlbWFpbHMgdXNpbmcgdGhlIE1pY3Jvc29mdCBHcmFwaCBBUEkuIFRvIHNlbmQgZW1haWxzIHZpYSBHcmFwaCBBUEksIHlvdSBuZWVkIHRvIGNvbmZpZ3VyZSBhbiBleGlzdGluZyBlbWFpbCBhZGRyZXNzIGluIHRoZSBydW5ib29rIGN1c3RvbWl6YXRpb24uCgpUaGlzIHByb2Nlc3MgaXMgZGVzY3JpYmVkIGluIGRldGFpbCBpbiB0aGUgW1NldHVwIEVtYWlsIFJlcG9ydGluZ10oaHR0cHM6Ly9naXRodWIuY29tL3JlYWxtam9pbi9yZWFsbWpvaW4tcnVuYm9va3MvdHJlZS9tYXN0ZXIvZG9jcy9nZW5lcmFsL3NldHVwLWVtYWlsLXJlcG9ydGluZy5tZCkgZG9jdW1lbnRhdGlvbi4K",
    "PermissionsContent": "{\n  \"Permissions\": [\n    {\n      \"Name\": \"Microsoft Graph\",\n      \"Id\": \"00000003-0000-0000-c000-000000000000\",\n      \"AppRoleAssignments\": [\n        \"DeviceManagementManagedDevices.Read.All\",\n        \"Directory.Read.All\",\n        \"Device.Read.All\",\n        \"Mail.Send\"\n      ]\n    }\n  ],\n  \"Roles\": [],\n  \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All",
            "Directory.Read.All",
            "Device.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Report Users With More Than 5-Devices",
    "RunbookDisplayPath": "Org \\ Devices \\ Report Users With More Than 5-Devices",
    "RelativeRunbookPath": "org/devices/report-users-with-more-than-5-devices.ps1",
    "RelativeRunbookPath_PathOnly": "org/devices",
    "PrimaryFolder": "Org",
    "SubFolder": "Devices",
    "Synopsis": "Report users with more than five registered devices",
    "Description": "This runbook queries Entra ID devices and their registered users to identify users with more than five devices.\nIt outputs a summary table and can optionally send an email with CSV attachments.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The sender email address. This needs to be configured in the runbook customization."
          }
        ],
        "globbing": "false",
        "name": "EmailFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "If specified, an email with the report will be sent to the provided address(es).\nCan be a single address or multiple comma-separated addresses (string).\nThe function sends individual emails to each recipient for privacy reasons."
          }
        ],
        "globbing": "false",
        "name": "EmailTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": "## Setup regarding email sending\n\nThis runbook sends emails using the Microsoft Graph API. To send emails via Graph API, you need to configure an existing email address in the runbook customization.\n\nThis process is described in detail in the [Setup Email Reporting](https://github.com/realmjoin/realmjoin-runbooks/tree/master/docs/general/setup-email-reporting.md) documentation.\n",
    "DocsContentEncoded": "IyMgU2V0dXAgcmVnYXJkaW5nIGVtYWlsIHNlbmRpbmcKClRoaXMgcnVuYm9vayBzZW5kcyBlbWFpbHMgdXNpbmcgdGhlIE1pY3Jvc29mdCBHcmFwaCBBUEkuIFRvIHNlbmQgZW1haWxzIHZpYSBHcmFwaCBBUEksIHlvdSBuZWVkIHRvIGNvbmZpZ3VyZSBhbiBleGlzdGluZyBlbWFpbCBhZGRyZXNzIGluIHRoZSBydW5ib29rIGN1c3RvbWl6YXRpb24uCgpUaGlzIHByb2Nlc3MgaXMgZGVzY3JpYmVkIGluIGRldGFpbCBpbiB0aGUgW1NldHVwIEVtYWlsIFJlcG9ydGluZ10oaHR0cHM6Ly9naXRodWIuY29tL3JlYWxtam9pbi9yZWFsbWpvaW4tcnVuYm9va3MvdHJlZS9tYXN0ZXIvZG9jcy9nZW5lcmFsL3NldHVwLWVtYWlsLXJlcG9ydGluZy5tZCkgZG9jdW1lbnRhdGlvbi4K",
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Device.Read.All\",\n                \"Mail.Send\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Device.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Sync Device Serialnumbers To Entraid_Scheduled",
    "RunbookDisplayPath": "Org \\ Devices \\ Sync Device Serialnumbers To Entraid_Scheduled",
    "RelativeRunbookPath": "org/devices/sync-device-serialnumbers-to-entraid_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/devices",
    "PrimaryFolder": "Org",
    "SubFolder": "Devices",
    "Synopsis": "Sync Intune serial numbers to Entra ID extension attributes",
    "Description": "This runbook retrieves Intune managed devices and syncs their serial numbers into an Entra ID device extension attribute.\nIt can process all devices or only devices with missing or mismatched values and can optionally send an email report.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "1",
        "description": [
          {
            "Text": "Extension attribute number to update"
          }
        ],
        "globbing": "false",
        "name": "ExtensionAttributeNumber",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "Maximum number of devices to process in a single run. Use 0 for unlimited."
          }
        ],
        "globbing": "false",
        "name": "MaxDevicesToProcess",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, processes all devices; otherwise only devices with missing or mismatched values are processed."
          }
        ],
        "globbing": "false",
        "name": "ProcessAllDevices",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "runbook@glueckkanja.com",
        "description": [
          {
            "Text": "Email address to send the report from."
          }
        ],
        "globbing": "false",
        "name": "sendReportFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Email address to send the report to. If empty, no email will be sent."
          }
        ],
        "globbing": "false",
        "name": "sendReportTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n  \"Permissions\": [\n    {\n      \"Name\": \"Microsoft Graph\",\n      \"Id\": \"00000003-0000-0000-c000-000000000000\",\n      \"AppRoleAssignments\": [\n        \"Organization.Read.All\",\n        \"Device.ReadWrite.All\",\n        \"DeviceManagementManagedDevices.Read.All\",\n        \"Mail.Send\"\n      ]\n    }\n  ],\n  \"Roles\": [],\n  \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Organization.Read.All",
            "Device.ReadWrite.All",
            "DeviceManagementManagedDevices.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Devices Of Users To Group_Scheduled",
    "RunbookDisplayPath": "Org \\ General \\ Add Devices Of Users To Group_Scheduled",
    "RelativeRunbookPath": "org/general/add-devices-of-users-to-group_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Sync devices of users in a specific group to another device group",
    "Description": "This runbook reads accounts from a specified users group and adds their devices to a specified device group.\nIt can filter devices by operating system and keeps the target group in sync.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name or object ID of the device group, to which the devices should be added."
          }
        ],
        "globbing": "false",
        "name": "DeviceGroup",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, includes Android devices in the target device group."
          }
        ],
        "globbing": "false",
        "name": "IncludeAndroidDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, includes iOS devices in the target device group."
          }
        ],
        "globbing": "false",
        "name": "IncludeIOSDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, includes iPadOS devices."
          }
        ],
        "globbing": "false",
        "name": "IncludeIPadOSDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, includes Linux devices in the target device group."
          }
        ],
        "globbing": "false",
        "name": "IncludeLinuxDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, includes macOS devices in the target device group."
          }
        ],
        "globbing": "false",
        "name": "IncludeMacOSDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, includes Windows devices in the target device group."
          }
        ],
        "globbing": "false",
        "name": "IncludeWindowsDevice",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name or object ID of the users group, to which the target users belong."
          }
        ],
        "globbing": "false",
        "name": "UserGroup",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.ReadWrite.All\",\n                \"User.Read.All\",\n                \"GroupMember.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.ReadWrite.All",
            "User.Read.All",
            "GroupMember.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Management Partner",
    "RunbookDisplayPath": "Org \\ General \\ Add Management Partner",
    "RelativeRunbookPath": "org/general/add-management-partner.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "List or add Management Partner Links (PAL)",
    "Description": "This runbook lists existing Partner Admin Links (PAL) for the tenant or adds a new PAL.\nIt uses the Azure Management Partner API and supports an interactive action selection.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "Choice of action to perform: list existing PALs or add a new PAL."
          }
        ],
        "globbing": "false",
        "name": "Action",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "6457701",
        "description": [
          {
            "Text": "Partner ID to set when adding a PAL."
          }
        ],
        "globbing": "false",
        "name": "PartnerId",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [],\n    \"Roles\": [],\n    \"ManualPermissions\": [ \"Owner or Contributor role on the Azure Subscription\"]\n}",
    "PermissionsJson": {
      "Permissions": [],
      "Roles": [],
      "ManualPermissions": [
        "Owner or Contributor role on the Azure Subscription"
      ]
    }
  },
  {
    "RunbookDisplayName": "Add Microsoft Store App Logos",
    "RunbookDisplayPath": "Org \\ General \\ Add Microsoft Store App Logos",
    "RelativeRunbookPath": "org/general/add-microsoft-store-app-logos.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Update logos of Microsoft Store Apps (new) in Intune",
    "Description": "This runbook updates missing logos for Microsoft Store Apps (new) in Intune by fetching the icon from the Microsoft Store.\nIt skips apps that already have a logo and reports how many apps were updated.",
    "Notes": null,
    "Parameters": {
      "defaultValue": "",
      "description": [
        {
          "Text": "Caller name for auditing purposes."
        }
      ],
      "globbing": "false",
      "name": "CallerName",
      "parameterValue": "String",
      "pipelineInput": "false",
      "position": "1",
      "required": "true",
      "type": {
        "name": "String"
      }
    },
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementApps.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementApps.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Office365 Group",
    "RunbookDisplayPath": "Org \\ General \\ Add Office365 Group",
    "RelativeRunbookPath": "org/general/add-office365-group.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Create an Office 365 group and SharePoint site, optionally create a (Teams) team.",
    "Description": "This runbook creates a Microsoft 365 group and provisions the related SharePoint site.\nIt can optionally promote the group to a Microsoft Teams team after creation.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Choose to \"Only create a SharePoint Site\" (final value: $false) or \"Create a Team (and SharePoint Site)\" (final value: $true). A team needs an owner, so if CreateTeam is set to true and no owner is specified, the runbook will set the caller as the owner."
          }
        ],
        "globbing": "false",
        "name": "CreateTeam",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional display name. If empty, MailNickname is used."
          }
        ],
        "globbing": "false",
        "name": "DisplayName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the group is mail-enabled."
          }
        ],
        "globbing": "false",
        "name": "MailEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Mail nickname used for group creation."
          }
        ],
        "globbing": "false",
        "name": "MailNickname",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional owner of the group."
          }
        ],
        "globbing": "false",
        "name": "Owner",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional second owner of the group."
          }
        ],
        "globbing": "false",
        "name": "Owner2",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Choose the group visibility: \"Public\" (final value: $false) or \"Private\" (final value: $true)."
          }
        ],
        "globbing": "false",
        "name": "Private",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, the group is security-enabled."
          }
        ],
        "globbing": "false",
        "name": "SecurityEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.Create\",\n                \"Team.Create\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.Create",
            "Team.Create"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Or Remove Safelinks Exclusion",
    "RunbookDisplayPath": "Org \\ General \\ Add Or Remove Safelinks Exclusion",
    "RelativeRunbookPath": "org/general/add-or-remove-safeLinks-exclusion.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Add or remove a SafeLinks URL exclusion from a policy",
    "Description": "Adds or removes a SafeLinks URL pattern exclusion in a specified policy. The runbook can also list existing policies and can create a new policy and group if needed.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "2",
        "description": [
          {
            "Text": "\"Add URL Pattern to Policy\", \"Remove URL Pattern from Policy\" or \"List all existing policies and settings\" could be selected as action to perform."
          }
        ],
        "globbing": "false",
        "name": "Action",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, the runbook creates a new SafeLinks policy and assignment group when the requested policy does not exist."
          }
        ],
        "globbing": "false",
        "name": "CreateNewPolicyIfNeeded",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "Default SafeLinks Policy",
        "description": [
          {
            "Text": "Default SafeLinks policy name used when no explicit policy name is provided."
          }
        ],
        "globbing": "false",
        "name": "DefaultPolicyName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "https://*.microsoft.com/*",
        "description": [
          {
            "Text": "URL pattern to allow; it can contain '*' as a wildcard for host and paths."
          }
        ],
        "globbing": "false",
        "name": "LinkPattern",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional SafeLinks policy name; if provided, it overrides the default selection."
          }
        ],
        "globbing": "false",
        "name": "PolicyName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Or Remove Smartscreen Exclusion",
    "RunbookDisplayPath": "Org \\ General \\ Add Or Remove Smartscreen Exclusion",
    "RelativeRunbookPath": "org/general/add-or-remove-smartscreen-exclusion.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Add or remove a SmartScreen URL indicator in Microsoft Defender",
    "Description": "This runbook lists, adds, or removes URL indicators in Microsoft Defender.\nIt can allow, audit, warn, or block a given domain by creating an indicator entry.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "\"List all URL indicators\", \"Add an URL indicator\" or \"Remove all indicator for this URL\" could be selected as action to perform."
          }
        ],
        "globbing": "false",
        "name": "action",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Required exclusion. Please provide more details.",
        "description": [
          {
            "Text": "Description used when creating an indicator."
          }
        ],
        "globbing": "false",
        "name": "explanationDescription",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Allow this domain in SmartScreen",
        "description": [
          {
            "Text": "Title used when creating an indicator."
          }
        ],
        "globbing": "false",
        "name": "explanationTitle",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "Indicator mode to apply."
          }
        ],
        "globbing": "false",
        "name": "mode",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Domain name to manage, for example \"exclusiondemo.com\"."
          }
        ],
        "globbing": "false",
        "name": "Url",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"WindowsDefenderATP\",\n            \"Id\": \"fc780465-2017-40d4-a0c5-307022471b92\",\n            \"AppRoleAssignments\": [\n                \"Ti.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "WindowsDefenderATP",
          "Id": "fc780465-2017-40d4-a0c5-307022471b92",
          "AppRoleAssignments": [
            "Ti.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Or Remove Trusted Site",
    "RunbookDisplayPath": "Org \\ General \\ Add Or Remove Trusted Site",
    "RelativeRunbookPath": "org/general/add-or-remove-trusted-site.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Add or remove a URL entry in the Intune Trusted Sites policy",
    "Description": "Adds or removes a URL to the Site-to-Zone Assignment List in a Windows custom configuration policy. The runbook can also list all existing Trusted Sites policies and their mappings.",
    "Notes": "This runbook uses calls as described in https://call4cloud.nl/2021/09/the-isencrypted-with-steve-zissou/ to decrypt omaSettings. It currently needs to use the Microsoft Graph beta endpoint for this.",
    "Parameters": [
      {
        "defaultValue": "2",
        "description": [
          {
            "Text": "Action to execute: add, remove, or list policies."
          }
        ],
        "globbing": "false",
        "name": "Action",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Windows 10 - Trusted Sites",
        "description": [
          {
            "Text": "Default policy name used when multiple Trusted Sites policies exist and no specific policy name is provided."
          }
        ],
        "globbing": "false",
        "name": "DefaultPolicyName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional policy name; if provided, the runbook targets this policy instead of auto-selecting one."
          }
        ],
        "globbing": "false",
        "name": "IntunePolicyName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "URL to add or remove; it must be prefixed with \"http://\" or \"https://\"."
          }
        ],
        "globbing": "false",
        "name": "Url",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "1",
        "description": [
          {
            "Text": "Internet Explorer zone id to assign the URL to."
          }
        ],
        "globbing": "false",
        "name": "Zone",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementConfiguration.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementConfiguration.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Security Group",
    "RunbookDisplayPath": "Org \\ General \\ Add Security Group",
    "RelativeRunbookPath": "org/general/add-security-group.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Create a Microsoft Entra ID security group",
    "Description": "This runbook creates a Microsoft Entra ID security group with membership type Assigned.\nIt validates the group name and optionally sets an owner during creation.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional description for the security group."
          }
        ],
        "globbing": "false",
        "name": "GroupDescription",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Display name of the security group to create."
          }
        ],
        "globbing": "false",
        "name": "GroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional owner to assign to the group."
          }
        ],
        "globbing": "false",
        "name": "Owner",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.Create\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.Create"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add User",
    "RunbookDisplayPath": "Org \\ General \\ Add User",
    "RelativeRunbookPath": "org/general/add-user.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Create a new user account",
    "Description": "This runbook creates a new cloud user in Microsoft Entra ID and applies standard user properties.\nIt can optionally assign a license group, add the user to additional groups, and create an Exchange Online archive mailbox.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "22",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "City of the user."
          }
        ],
        "globbing": "false",
        "name": "City",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "14",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Company name of the user."
          }
        ],
        "globbing": "false",
        "name": "CompanyName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Country of the user."
          }
        ],
        "globbing": "false",
        "name": "Country",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "16",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Comma-separated list of groups to assign to the user."
          }
        ],
        "globbing": "false",
        "name": "DefaultGroups",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "19",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional license group to assign to the user."
          }
        ],
        "globbing": "false",
        "name": "DefaultLicense",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "18",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Department of the user."
          }
        ],
        "globbing": "false",
        "name": "Department",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Display name of the user. If empty, the runbook derives it from the provided name."
          }
        ],
        "globbing": "false",
        "name": "DisplayName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, creates an Exchange Online archive mailbox for the user."
          }
        ],
        "globbing": "false",
        "name": "EnableEXOArchive",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "21",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "First name of the user."
          }
        ],
        "globbing": "false",
        "name": "GivenName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Initial password. If empty, the runbook generates a random password."
          }
        ],
        "globbing": "false",
        "name": "InitialPassword",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "20",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Job title of the user."
          }
        ],
        "globbing": "false",
        "name": "JobTitle",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Office location name used for portal customization."
          }
        ],
        "globbing": "false",
        "name": "LocationName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Mail nickname (alias) used for the user. If empty, the runbook derives it from the UPN."
          }
        ],
        "globbing": "false",
        "name": "MailNickname",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional manager user ID to set for the user."
          }
        ],
        "globbing": "false",
        "name": "ManagerId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Mobile phone number of the user."
          }
        ],
        "globbing": "false",
        "name": "MobilePhone",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Postal code of the user."
          }
        ],
        "globbing": "false",
        "name": "PostalCode",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "13",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "State or region of the user."
          }
        ],
        "globbing": "false",
        "name": "State",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "15",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Street address of the user."
          }
        ],
        "globbing": "false",
        "name": "StreetAddress",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Last name of the user."
          }
        ],
        "globbing": "false",
        "name": "Surname",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Usage location used for licensing."
          }
        ],
        "globbing": "false",
        "name": "UsageLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "17",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name (UPN). If empty, the runbook generates a UPN from the provided name."
          }
        ],
        "globbing": "false",
        "name": "UserPrincipalName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"DeviceManagementManagedDevices.PrivilegedOperations.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"User Administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All",
            "DeviceManagementManagedDevices.PrivilegedOperations.All"
          ]
        }
      ],
      "Roles": [
        "User Administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Viva Engange Community",
    "RunbookDisplayPath": "Org \\ General \\ Add Viva Engange Community",
    "RelativeRunbookPath": "org/general/add-viva-engange-community.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Create a Viva Engage (Yammer) community",
    "Description": "This runbook creates a Viva Engage community via the Yammer REST API using a stored developer token.\nIt can optionally assign owners and remove the initial API user from the resulting Microsoft 365 group.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Sample Community",
        "description": [
          {
            "Text": "Name of the community to create. Maximum length is 264 characters."
          }
        ],
        "globbing": "false",
        "name": "CommunityName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Comma-separated list of owner UPNs to add to the community."
          }
        ],
        "globbing": "false",
        "name": "CommunityOwners",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the community is created as private."
          }
        ],
        "globbing": "false",
        "name": "CommunityPrivate",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, the community is visible in the directory."
          }
        ],
        "globbing": "false",
        "name": "CommunityShowInDirectory",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, removes the initial API user from the group when at least one other owner exists."
          }
        ],
        "globbing": "false",
        "name": "removeCreatorFromGroup",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"Group.ReadWrite.All\",\n                \"GroupMember.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "Group.ReadWrite.All",
            "GroupMember.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Assign Groups By Template_Scheduled",
    "RunbookDisplayPath": "Org \\ General \\ Assign Groups By Template_Scheduled",
    "RelativeRunbookPath": "org/general/assign-groups-by-template_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Assign cloud-only groups to many users based on a predefined template",
    "Description": "This runbook adds users from a source group to one or more target groups.\nTarget groups are provided via a template-driven string and can be resolved by group ID or display name.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional object ID of a group whose users are excluded from processing."
          }
        ],
        "globbing": "false",
        "name": "ExclusionGroupId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Comma-separated list of target groups (IDs or display names depending on UseDisplaynames)."
          }
        ],
        "globbing": "false",
        "name": "GroupsString",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Template selector used by the portal to populate the GroupsString parameter."
          }
        ],
        "globbing": "false",
        "name": "GroupsTemplate",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the source group containing users to process."
          }
        ],
        "globbing": "false",
        "name": "SourceGroupId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, GroupsString contains display names; otherwise it contains object IDs."
          }
        ],
        "globbing": "false",
        "name": "UseDisplaynames",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"Group.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "Group.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Bulk Delete Devices From Autopilot",
    "RunbookDisplayPath": "Org \\ General \\ Bulk Delete Devices From Autopilot",
    "RelativeRunbookPath": "org/general/bulk-delete-devices-from-autopilot.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Bulk delete Autopilot objects by serial number",
    "Description": "This runbook deletes Windows Autopilot device identities based on a comma-separated list of serial numbers.\nIt searches for each serial number and deletes the matching Autopilot object if found.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Comma-separated list of serial numbers to delete from Autopilot."
          }
        ],
        "globbing": "false",
        "name": "SerialNumbers",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementServiceConfig.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementServiceConfig.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Bulk Retire Devices From Intune",
    "RunbookDisplayPath": "Org \\ General \\ Bulk Retire Devices From Intune",
    "RelativeRunbookPath": "org/general/bulk-retire-devices-from-intune.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Bulk retire devices from Intune using serial numbers",
    "Description": "Retires multiple Intune devices based on a comma-separated list of serial numbers. Each serial number is looked up in Intune and the device is retired if found.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Comma-separated list of device serial numbers to retire."
          }
        ],
        "globbing": "false",
        "name": "SerialNumbers",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.ReadWrite.All\",\n                \"Device.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.ReadWrite.All",
            "Device.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Check Aad Sync Status_Scheduled",
    "RunbookDisplayPath": "Org \\ General \\ Check Aad Sync Status_Scheduled",
    "RelativeRunbookPath": "org/general/check-aad-sync-status_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Check last Azure AD Connect sync status",
    "Description": "This runbook checks whether on-premises directory synchronization is enabled and when the last sync happened.\nIt can send an email alert if synchronization is not enabled.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "runbooks@glueckkanja.com",
        "description": [
          {
            "Text": "Sender mailbox used for sending the report."
          }
        ],
        "globbing": "false",
        "name": "sendAlertFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "support@glueckkanja.com",
        "description": [
          {
            "Text": "Email address to send the report to."
          }
        ],
        "globbing": "false",
        "name": "sendAlertTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Directory.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Directory.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Check Assignments Of Devices",
    "RunbookDisplayPath": "Org \\ General \\ Check Assignments Of Devices",
    "RelativeRunbookPath": "org/general/check-assignments-of-devices.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Check Intune assignments for one or more device names",
    "Description": "This runbook queries Intune policies and optionally app assignments relevant to the specified device(s).\nIt resolves device group memberships and reports matching assignments.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Comma-separated list of device names to check."
          }
        ],
        "globbing": "false",
        "name": "DeviceNames",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, also evaluates application assignments."
          }
        ],
        "globbing": "false",
        "name": "IncludeApps",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Device.Read.All\",\n                \"Group.Read.All\",\n                \"DeviceManagementConfiguration.Read.All\",\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"DeviceManagementApps.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Device.Read.All",
            "Group.Read.All",
            "DeviceManagementConfiguration.Read.All",
            "DeviceManagementManagedDevices.Read.All",
            "DeviceManagementApps.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Check Assignments Of Groups",
    "RunbookDisplayPath": "Org \\ General \\ Check Assignments Of Groups",
    "RelativeRunbookPath": "org/general/check-assignments-of-groups.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Check Intune assignments for one or more group names",
    "Description": "This runbook queries Intune policies and optionally app assignments that target the specified group(s).\nIt resolves group IDs and reports matching assignments.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Group Names of the groups to check assignments for, separated by commas."
          }
        ],
        "globbing": "false",
        "name": "GroupNames",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, also evaluates application assignments."
          }
        ],
        "globbing": "false",
        "name": "IncludeApps",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"Group.Read.All\",\n                \"DeviceManagementConfiguration.Read.All\",\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"Device.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "Group.Read.All",
            "DeviceManagementConfiguration.Read.All",
            "DeviceManagementManagedDevices.Read.All",
            "Device.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Check Assignments Of Users",
    "RunbookDisplayPath": "Org \\ General \\ Check Assignments Of Users",
    "RelativeRunbookPath": "org/general/check-assignments-of-users.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Check Intune assignments for one or more user principal names",
    "Description": "This runbook queries Intune policies and optionally app assignments relevant to the specified user(s).\nIt resolves transitive group membership and reports matching assignments.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, also evaluates application assignments."
          }
        ],
        "globbing": "false",
        "name": "IncludeApps",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User Principal Names of the users to check assignments for, separated by commas."
          }
        ],
        "globbing": "false",
        "name": "UPN",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"Group.Read.All\",\n                \"DeviceManagementConfiguration.Read.All\",\n                \"DeviceManagementManagedDevices.Read.All\", \n                \"Device.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "Group.Read.All",
            "DeviceManagementConfiguration.Read.All",
            "DeviceManagementManagedDevices.Read.All",
            "Device.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Check Autopilot Serialnumbers",
    "RunbookDisplayPath": "Org \\ General \\ Check Autopilot Serialnumbers",
    "RelativeRunbookPath": "org/general/check-autopilot-serialnumbers.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Check if given serial numbers are present in Autopilot",
    "Description": "This runbook checks whether Windows Autopilot device identities exist for the provided serial numbers.\nIt returns the serial numbers found and lists any missing serial numbers.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Serial numbers of the devices, separated by commas."
          }
        ],
        "globbing": "false",
        "name": "SerialNumbers",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementServiceConfig.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementServiceConfig.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Check Device Onboarding Exclusion_Scheduled",
    "RunbookDisplayPath": "Org \\ General \\ Check Device Onboarding Exclusion_Scheduled",
    "RelativeRunbookPath": "org/general/check-device-onboarding-exclusion_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Add unenrolled Autopilot devices to an exclusion group",
    "Description": "This runbook identifies Windows Autopilot devices that are not yet enrolled in Intune and ensures they are members of a configured exclusion group.\nIt also removes devices from the group once they are no longer in scope.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "cfg - Intune - Windows - Compliance for unenrolled Autopilot devices (devices)",
        "description": [
          {
            "Text": "Display name of the exclusion group to manage."
          }
        ],
        "globbing": "false",
        "name": "exclusionGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "1",
        "description": [
          {
            "Text": "Maximum age in days for recently enrolled devices to be considered in grace scope."
          }
        ],
        "globbing": "false",
        "name": "maxAgeInDays",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.ReadWrite.All\",\n                \"Device.Read.All\",\n                \"DeviceManagementManagedDevices.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.ReadWrite.All",
            "Device.Read.All",
            "DeviceManagementManagedDevices.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Enrolled Devices Report_Scheduled",
    "RunbookDisplayPath": "Org \\ General \\ Enrolled Devices Report_Scheduled",
    "RelativeRunbookPath": "org/general/enrolled-devices-report_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Show recent first-time device enrollments",
    "Description": "This runbook reports recent device enrollments based on a configurable time range.\nIt can group results by a selected attribute and can optionally export the report as a CSV file.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "11",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage container name used for upload."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "Data source used to determine the first enrollment date."
          }
        ],
        "globbing": "false",
        "name": "dataSource",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Please configure an Azure Storage Account to use this feature."
          }
        ],
        "globbing": "false",
        "name": "exportCsv",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "country",
        "description": [
          {
            "Text": "Attribute name used for grouping."
          }
        ],
        "globbing": "false",
        "name": "groupingAttribute",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "1",
        "description": [
          {
            "Text": "Data source used to resolve the grouping attribute."
          }
        ],
        "globbing": "false",
        "name": "groupingSource",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Resource group that contains the storage account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the storage account."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage account name used for upload."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage account SKU."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "4",
        "description": [
          {
            "Text": "Time range in weeks to include in the report."
          }
        ],
        "globbing": "false",
        "name": "Weeks",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementServiceConfig.Read.All\",\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"User.Read.All\",\n                \"Device.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": [\n        \"Azure: Contributor on Storage Account\"\n    ]\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementServiceConfig.Read.All",
            "DeviceManagementManagedDevices.Read.All",
            "User.Read.All",
            "Device.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": [
        "Azure: Contributor on Storage Account"
      ]
    }
  },
  {
    "RunbookDisplayName": "Export All Autopilot Devices",
    "RunbookDisplayPath": "Org \\ General \\ Export All Autopilot Devices",
    "RelativeRunbookPath": "org/general/export-all-autopilot-devices.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "List or export all Windows Autopilot devices",
    "Description": "Lists all Windows Autopilot devices and optionally exports them to a CSV file in Azure Storage. If exporting is enabled, the runbook uploads the report and returns a time-limited SAS (download) link.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage container to upload the CSV report to."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"List in Console\" (final value: $false) or \"Export to a CSV file\" (final value: $true) can be selected as action to perform."
          }
        ],
        "globbing": "false",
        "name": "ExportToFile",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Resource Group containing the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage Account used for upload."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "SKU name for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"Directory.Read.All\",\n                \"Device.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All",
            "Directory.Read.All",
            "Device.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Export All Intune Devices",
    "RunbookDisplayPath": "Org \\ General \\ Export All Intune Devices",
    "RelativeRunbookPath": "org/general/export-all-intune-devices.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Export a list of all Intune devices and where they are registered",
    "Description": "Exports all Intune managed devices and enriches them with selected owner metadata such as usage location. The report is uploaded as a CSV file to an Azure Storage container.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage container to upload the CSV report to."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional group filter (ObjectId). When specified, only devices whose primary owner is a member of this group are exported."
          }
        ],
        "globbing": "false",
        "name": "FilterGroupID",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Resource Group containing the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage Account used for upload."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "SKU name for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional Azure Subscription Id to set the context for Storage Account operations."
          }
        ],
        "globbing": "false",
        "name": "SubscriptionId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"GroupMember.Read.All\",\n                \"Group.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All",
            "GroupMember.Read.All",
            "Group.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Export Cloudpc Usage_Scheduled",
    "RunbookDisplayPath": "Org \\ General \\ Export Cloudpc Usage_Scheduled",
    "RelativeRunbookPath": "org/general/export-cloudpc-usage_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Write daily Windows 365 utilization data to Azure Table Storage",
    "Description": "Collects Windows 365 Cloud PC remote connection usage for the last full day and writes it to an Azure Table. The runbook creates the table if needed and merges records per tenant and timestamp.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "2",
        "description": [
          {
            "Text": "Number of days to look back when collecting usage data."
          }
        ],
        "globbing": "false",
        "name": "Days",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Resource Group containing the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage Account hosting the table."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "CloudPCUsageV2",
        "description": [
          {
            "Text": "Name of the Azure Table Storage table to write to."
          }
        ],
        "globbing": "false",
        "name": "Table",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"CloudPC.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": [\n        \"Azure IaaS: `Contributor` role on the Azure Storage Account used for storing CloudPC usage data\"\n    ]\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "CloudPC.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": [
        "Azure IaaS: `Contributor` role on the Azure Storage Account used for storing CloudPC usage data"
      ]
    }
  },
  {
    "RunbookDisplayName": "Export Non Compliant Devices",
    "RunbookDisplayPath": "Org \\ General \\ Export Non Compliant Devices",
    "RelativeRunbookPath": "org/general/export-non-compliant-devices.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Export non-compliant Intune devices and settings",
    "Description": "This runbook queries Intune for non-compliant and in-grace-period devices and retrieves detailed policy and setting compliance data.\nIt can export the results to CSV with SAS (download) links.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "rjrb-device-compliance-report-v2",
        "description": [
          {
            "Text": "Storage container name used for uploads."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, uploads artifacts and produces SAS (download) links when storage settings are available."
          }
        ],
        "globbing": "false",
        "name": "produceLinks",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Resource group that contains the storage account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the storage account."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage account name used for uploads."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage account SKU."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure subscription ID used for storage operations."
          }
        ],
        "globbing": "false",
        "name": "SubscriptionId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementConfiguration.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": [\n        \"Azure IaaS: Access to create/manage Azure Storage resources if producing links\"\n    ]\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementConfiguration.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": [
        "Azure IaaS: Access to create/manage Azure Storage resources if producing links"
      ]
    }
  },
  {
    "RunbookDisplayName": "Export Policy Report",
    "RunbookDisplayPath": "Org \\ General \\ Export Policy Report",
    "RelativeRunbookPath": "org/general/export-policy-report.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Create a report of tenant policies from Intune and Entra ID.",
    "Description": "This runbook exports configuration policies from Intune and Entra ID and writes the results to a Markdown report.\nIt can optionally export raw JSON and create downloadable links for exported artifacts.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "rjrb-licensing-report-v2",
        "description": [
          {
            "Text": "Storage container name used for uploads."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, also exports raw JSON policy payloads."
          }
        ],
        "globbing": "false",
        "name": "exportJson",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, creates links for exported artifacts based on settings."
          }
        ],
        "globbing": "false",
        "name": "produceLinks",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, adds LaTeX page breaks to the generated Markdown."
          }
        ],
        "globbing": "false",
        "name": "renderLatexPagebreaks",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Resource group that contains the storage account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the storage account."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage account name used for uploads."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage account SKU."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementConfiguration.Read.All\",\n                \"Policy.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": [\n        \"Azure Storage Account: Contributor role on the Storage Account used for exporting reports\"\n    ]\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementConfiguration.Read.All",
            "Policy.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": [
        "Azure Storage Account: Contributor role on the Storage Account used for exporting reports"
      ]
    }
  },
  {
    "RunbookDisplayName": "Invite External Guest Users",
    "RunbookDisplayPath": "Org \\ General \\ Invite External Guest Users",
    "RelativeRunbookPath": "org/general/Invite-external-guest-users.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Invite external guest users to the organization",
    "Description": "This runbook invites an external user as a guest user in Microsoft Entra ID.\nIt can optionally add the invited user to a specified group.",
    "Notes": "You need to setup proper RunbookCustomization in the RealmJoin Portal to use this script.\nAn example would be looking like this:\n\"rjgit-org_general_invite-external-guest-users\": {\n    \"Parameters\": {\n        \"InvitedUserEmail\": {\n            \"DisplayName\": \"Invitee's email address\",\n            \"Mandatory\": true\n        },\n        \"InvitedUserDisplayName\": {\n            \"DisplayName\": \"Invitee's display name\",\n            \"Mandatory\": true\n        },\n        \"CallerName\": {\n            \"Hide\": true\n        },\n        \"GroupId\": {\n            \"Hide\": true,\n            \"DefaultValue\": \"00000000-0000-0000-0000-000000000000\"\n        }\n    }\n}",
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The object ID of the group to add the guest user to.\nIf not specified, the user will not be added to any group."
          }
        ],
        "globbing": "false",
        "name": "GroupId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Display name of the guest user."
          }
        ],
        "globbing": "false",
        "name": "InvitedUserDisplayName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Email address of the guest user to invite."
          }
        ],
        "globbing": "false",
        "name": "InvitedUserEmail",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.ReadWrite.All\",\n                \"Group.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.ReadWrite.All",
            "Group.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List All Administrative Template Policies",
    "RunbookDisplayPath": "Org \\ General \\ List All Administrative Template Policies",
    "RelativeRunbookPath": "org/general/list-all-administrative-template-policies.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "List all Administrative Template policies and their assignments",
    "Description": "This runbook retrieves all Administrative Template policies from Intune.\nIt lists each policy and shows its current assignments.",
    "Notes": null,
    "Parameters": {
      "defaultValue": "",
      "description": [
        {
          "Text": "Caller name for auditing purposes."
        }
      ],
      "globbing": "false",
      "name": "CallerName",
      "parameterValue": "String",
      "pipelineInput": "false",
      "position": "1",
      "required": "true",
      "type": {
        "name": "String"
      }
    },
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementConfiguration.Read.All\",\n                \"Group.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementConfiguration.Read.All",
            "Group.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Group License Assignment Errors",
    "RunbookDisplayPath": "Org \\ General \\ List Group License Assignment Errors",
    "RelativeRunbookPath": "org/general/list-group-license-assignment-errors.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Report groups that have license assignment errors",
    "Description": "This runbook searches for Entra ID groups that have members with license assignment errors.\nIt prints the affected group names and object IDs.",
    "Notes": null,
    "Parameters": {
      "defaultValue": "",
      "description": [
        {
          "Text": "Caller name for auditing purposes."
        }
      ],
      "globbing": "false",
      "name": "CallerName",
      "parameterValue": "String",
      "pipelineInput": "false",
      "position": "1",
      "required": "true",
      "type": {
        "name": "String"
      }
    },
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"GroupMember.Read.All\",\n                \"Group.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "GroupMember.Read.All",
            "Group.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Office365 License Report",
    "RunbookDisplayPath": "Org \\ General \\ Office365 License Report",
    "RelativeRunbookPath": "org/general/office365-license-report.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Generate an Office 365 licensing report",
    "Description": "This runbook creates a licensing report based on Microsoft 365 subscription SKUs and optionally includes Exchange Online related reports.\nIt can export the results to Azure Storage and generate SAS links for downloads.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "12",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "rjrb-licensing-report-v2",
        "description": [
          {
            "Text": "Storage container name used for uploads."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, exports reports as a single ZIP file."
          }
        ],
        "globbing": "false",
        "name": "exportAsZip",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, exports reports to Azure Storage when configured."
          }
        ],
        "globbing": "false",
        "name": "exportToFile",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, includes Exchange Online related reports."
          }
        ],
        "globbing": "false",
        "name": "includeExhange",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, prints a short license usage overview."
          }
        ],
        "globbing": "false",
        "name": "printOverview",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, creates SAS tokens/links for exported artifacts."
          }
        ],
        "globbing": "false",
        "name": "produceLinks",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Resource group that contains the storage account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the storage account."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage account name used for uploads."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Storage account SKU."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure subscription ID used for storage operations."
          }
        ],
        "globbing": "false",
        "name": "SubscriptionId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Reports.Read.All\",\n                \"Directory.Read.All\",\n                \"User.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Reports.Read.All",
            "Directory.Read.All",
            "User.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Report Apple Mdm Cert Expiry_Scheduled",
    "RunbookDisplayPath": "Org \\ General \\ Report Apple Mdm Cert Expiry_Scheduled",
    "RelativeRunbookPath": "org/general/report-apple-mdm-cert-expiry_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Monitor/Report expiry of Apple device management certificates",
    "Description": "Monitors expiration dates of Apple Push certificates, VPP tokens, and DEP tokens in Microsoft Intune.\nSends an email report with alerts for certificates/tokens expiring within the specified threshold.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "30",
        "description": [
          {
            "Text": "The warning threshold in days. Certificates and tokens expiring within this many days will be\nflagged as alerts in the report. Default is 300 days (approximately 10 months)."
          }
        ],
        "globbing": "false",
        "name": "Days",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The sender email address. This needs to be configured in the runbook customization"
          }
        ],
        "globbing": "false",
        "name": "EmailFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Can be a single address or multiple comma-separated addresses (string).\nThe function sends individual emails to each recipient for privacy reasons."
          }
        ],
        "globbing": "false",
        "name": "EmailTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": "## Setup regarding email sending\n\nThis runbook sends emails using the Microsoft Graph API. To send emails via Graph API, you need to configure an existing email address in the runbook customization.\n\nThis process is described in detail in the [Setup Email Reporting](https://github.com/realmjoin/realmjoin-runbooks/tree/master/docs/general/setup-email-reporting.md) documentation.\n",
    "DocsContentEncoded": "IyMgU2V0dXAgcmVnYXJkaW5nIGVtYWlsIHNlbmRpbmcKClRoaXMgcnVuYm9vayBzZW5kcyBlbWFpbHMgdXNpbmcgdGhlIE1pY3Jvc29mdCBHcmFwaCBBUEkuIFRvIHNlbmQgZW1haWxzIHZpYSBHcmFwaCBBUEksIHlvdSBuZWVkIHRvIGNvbmZpZ3VyZSBhbiBleGlzdGluZyBlbWFpbCBhZGRyZXNzIGluIHRoZSBydW5ib29rIGN1c3RvbWl6YXRpb24uCgpUaGlzIHByb2Nlc3MgaXMgZGVzY3JpYmVkIGluIGRldGFpbCBpbiB0aGUgW1NldHVwIEVtYWlsIFJlcG9ydGluZ10oaHR0cHM6Ly9naXRodWIuY29tL3JlYWxtam9pbi9yZWFsbWpvaW4tcnVuYm9va3MvdHJlZS9tYXN0ZXIvZG9jcy9nZW5lcmFsL3NldHVwLWVtYWlsLXJlcG9ydGluZy5tZCkgZG9jdW1lbnRhdGlvbi4K",
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"DeviceManagementServiceConfig.Read.All\",\n                \"DeviceManagementConfiguration.Read.All\",\n                \"Mail.Send\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All",
            "DeviceManagementServiceConfig.Read.All",
            "DeviceManagementConfiguration.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Report License Assignment_Scheduled",
    "RunbookDisplayPath": "Org \\ General \\ Report License Assignment_Scheduled",
    "RelativeRunbookPath": "org/general/report-license-assignment_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Generate and email a license availability report based on thresholds",
    "Description": "This runbook checks the license availability based on the transmitted SKUs and sends an email report if any thresholds are reached.\nTwo types of thresholds can be configured. The first type is a minimum threshold, which triggers an alert when the number of available licenses falls below a specified number.\nThe second type is a maximum threshold, which triggers an alert when the number of available licenses exceeds a specified number.\nThe report includes detailed information about licenses that are outside the configured thresholds, exports them to CSV files, and sends them via email.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Sender email address resolved from settings."
          }
        ],
        "globbing": "false",
        "name": "EmailFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Recipient email address or comma-separated recipient list."
          }
        ],
        "globbing": "false",
        "name": "EmailTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "JSON array containing SKU configurations with thresholds. Each entry should include a SKUPartNumber for the Microsoft SKU identifier, a FriendlyName as the display name for the license, an optional MinThreshold specifying the minimum number of licenses that should be available, and an optional MaxThreshold specifying the maximum number of licenses that should be available.\n\nThis needs to be configured in the runbook customization"
          }
        ],
        "globbing": "false",
        "name": "InputJson",
        "parameterValue": "Object",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "Object"
        }
      }
    ],
    "DocsContent": "## Runbook Customization\n\n### Setup regarding email sending\n\nThis runbook sends emails using the Microsoft Graph API. To send emails via Graph API, you need to configure an existing email address in the runbook customization.\n\nThis process is described in detail in the [Setup Email Reporting](https://github.com/realmjoin/realmjoin-runbooks/tree/master/docs/general/setup-email-reporting.md) documentation.\n\n### InputJson Configuration\n\nEach license configuration requires:\n\n- **SKUPartNumber** (required): Microsoft SKU identifier\n- **FriendlyName** (required): Display name\n- **MinThreshold** (optional): Alert when available licenses < threshold\n- **MaxThreshold** (optional): Alert when available licenses > threshold\n\nAt least one threshold must be set per license.\n\n### Configuration Examples\n\n**Minimum threshold only** (prevent shortages):\n\n```json\n[\n    {\n        \"SKUPartNumber\": \"ENTERPRISEPACK\",\n        \"FriendlyName\": \"Microsoft 365 E3\",\n        \"MinThreshold\": 50\n    }\n]\n```\n\n**Maximum threshold only** (prevent over-provisioning):\n\n```json\n[\n    {\n        \"SKUPartNumber\": \"POWER_BI_PRO\",\n        \"FriendlyName\": \"Power BI Pro\",\n        \"MaxThreshold\": 500\n    }\n]\n```\n\n**Both thresholds** (maintain range):\n\n```json\n[\n    {\n        \"SKUPartNumber\": \"ENTERPRISEPREMIUM\",\n        \"FriendlyName\": \"Microsoft 365 E5\",\n        \"MinThreshold\": 50,\n        \"MaxThreshold\": 150\n    }\n]\n```\n\n### Complete Runbook Customization\n\n```json\n{\n    \"Settings\": {\n        \"RJReport\": {\n            \"EmailSender\": \"sender@contoso.com\"\n        }\n    },\n    \"Runbooks\": {\n        \"rjgit-org_general_report-license-assignment_scheduled\": {\n            \"Parameters\": {\n                \"EmailTo\": {\n                    \"DisplayName\": \"Recipient Email Address(es)\"\n                },\n                \"InputJson\": {\n                    \"Hide\": true,\n                    \"DefaultValue\": [\n                        {\n                            \"SKUPartNumber\": \"SPE_E5\",\n                            \"FriendlyName\": \"Microsoft 365 E5\",\n                            \"MinThreshold\": 20,\n                            \"MaxThreshold\": 30\n                        },\n                        {\n                            \"SKUPartNumber\": \"FLOW_FREE\",\n                            \"FriendlyName\": \"Microsoft Power Automate Free\",\n                            \"MinThreshold\": 10\n                        }\n                    ]\n                },\n                \"EmailFrom\": {\n                    \"Hide\": true\n                },\n                \"CallerName\": {\n                    \"Hide\": true\n                }\n            }\n        }\n    }\n}\n```\n\n## Finding SKU Part Numbers\n\n```powershell\nConnect-MgGraph -Scopes \"Organization.Read.All\"\nGet-MgSubscribedSku | Select-Object SkuPartNumber, SkuId | Sort-Object SkuPartNumber\n```\n\nCommon SKUs:\n\n- `ENTERPRISEPACK` - Microsoft 365 E3\n- `ENTERPRISEPREMIUM` - Microsoft 365 E5\n- `EMS` - Enterprise Mobility + Security E3\n\n## Output\n\n**When violations detected:**\n\n- Console output in job log\n- CSV export (`License_Threshold_Violations.csv`)\n- Email report with summary, violations, recommendations, and CSV attachment\n\n**When all within thresholds:**\n\n- No email sent\n- Job completes successfully\n\n## Troubleshooting\n\n**SKU Not Found**: Verify SKU exists using `Get-MgSubscribedSku`\n\n**Email Not Sent**: Check EmailFrom configuration and Mail.Send permission\n\n**Invalid JSON**: Validate JSON format before configuration\n\n## Migration Note\n\nLegacy `WarningThreshold` automatically maps to `MinThreshold` - old configurations continue to work.\n",
    "DocsContentEncoded": "IyMgUnVuYm9vayBDdXN0b21pemF0aW9uCgojIyMgU2V0dXAgcmVnYXJkaW5nIGVtYWlsIHNlbmRpbmcKClRoaXMgcnVuYm9vayBzZW5kcyBlbWFpbHMgdXNpbmcgdGhlIE1pY3Jvc29mdCBHcmFwaCBBUEkuIFRvIHNlbmQgZW1haWxzIHZpYSBHcmFwaCBBUEksIHlvdSBuZWVkIHRvIGNvbmZpZ3VyZSBhbiBleGlzdGluZyBlbWFpbCBhZGRyZXNzIGluIHRoZSBydW5ib29rIGN1c3RvbWl6YXRpb24uCgpUaGlzIHByb2Nlc3MgaXMgZGVzY3JpYmVkIGluIGRldGFpbCBpbiB0aGUgW1NldHVwIEVtYWlsIFJlcG9ydGluZ10oaHR0cHM6Ly9naXRodWIuY29tL3JlYWxtam9pbi9yZWFsbWpvaW4tcnVuYm9va3MvdHJlZS9tYXN0ZXIvZG9jcy9nZW5lcmFsL3NldHVwLWVtYWlsLXJlcG9ydGluZy5tZCkgZG9jdW1lbnRhdGlvbi4KCiMjIyBJbnB1dEpzb24gQ29uZmlndXJhdGlvbgoKRWFjaCBsaWNlbnNlIGNvbmZpZ3VyYXRpb24gcmVxdWlyZXM6CgotICoqU0tVUGFydE51bWJlcioqIChyZXF1aXJlZCk6IE1pY3Jvc29mdCBTS1UgaWRlbnRpZmllcgotICoqRnJpZW5kbHlOYW1lKiogKHJlcXVpcmVkKTogRGlzcGxheSBuYW1lCi0gKipNaW5UaHJlc2hvbGQqKiAob3B0aW9uYWwpOiBBbGVydCB3aGVuIGF2YWlsYWJsZSBsaWNlbnNlcyA8IHRocmVzaG9sZAotICoqTWF4VGhyZXNob2xkKiogKG9wdGlvbmFsKTogQWxlcnQgd2hlbiBhdmFpbGFibGUgbGljZW5zZXMgPiB0aHJlc2hvbGQKCkF0IGxlYXN0IG9uZSB0aHJlc2hvbGQgbXVzdCBiZSBzZXQgcGVyIGxpY2Vuc2UuCgojIyMgQ29uZmlndXJhdGlvbiBFeGFtcGxlcwoKKipNaW5pbXVtIHRocmVzaG9sZCBvbmx5KiogKHByZXZlbnQgc2hvcnRhZ2VzKToKCmBgYGpzb24KWwogICAgewogICAgICAgICJTS1VQYXJ0TnVtYmVyIjogIkVOVEVSUFJJU0VQQUNLIiwKICAgICAgICAiRnJpZW5kbHlOYW1lIjogIk1pY3Jvc29mdCAzNjUgRTMiLAogICAgICAgICJNaW5UaHJlc2hvbGQiOiA1MAogICAgfQpdCmBgYAoKKipNYXhpbXVtIHRocmVzaG9sZCBvbmx5KiogKHByZXZlbnQgb3Zlci1wcm92aXNpb25pbmcpOgoKYGBganNvbgpbCiAgICB7CiAgICAgICAgIlNLVVBhcnROdW1iZXIiOiAiUE9XRVJfQklfUFJPIiwKICAgICAgICAiRnJpZW5kbHlOYW1lIjogIlBvd2VyIEJJIFBybyIsCiAgICAgICAgIk1heFRocmVzaG9sZCI6IDUwMAogICAgfQpdCmBgYAoKKipCb3RoIHRocmVzaG9sZHMqKiAobWFpbnRhaW4gcmFuZ2UpOgoKYGBganNvbgpbCiAgICB7CiAgICAgICAgIlNLVVBhcnROdW1iZXIiOiAiRU5URVJQUklTRVBSRU1JVU0iLAogICAgICAgICJGcmllbmRseU5hbWUiOiAiTWljcm9zb2Z0IDM2NSBFNSIsCiAgICAgICAgIk1pblRocmVzaG9sZCI6IDUwLAogICAgICAgICJNYXhUaHJlc2hvbGQiOiAxNTAKICAgIH0KXQpgYGAKCiMjIyBDb21wbGV0ZSBSdW5ib29rIEN1c3RvbWl6YXRpb24KCmBgYGpzb24KewogICAgIlNldHRpbmdzIjogewogICAgICAgICJSSlJlcG9ydCI6IHsKICAgICAgICAgICAgIkVtYWlsU2VuZGVyIjogInNlbmRlckBjb250b3NvLmNvbSIKICAgICAgICB9CiAgICB9LAogICAgIlJ1bmJvb2tzIjogewogICAgICAgICJyamdpdC1vcmdfZ2VuZXJhbF9yZXBvcnQtbGljZW5zZS1hc3NpZ25tZW50X3NjaGVkdWxlZCI6IHsKICAgICAgICAgICAgIlBhcmFtZXRlcnMiOiB7CiAgICAgICAgICAgICAgICAiRW1haWxUbyI6IHsKICAgICAgICAgICAgICAgICAgICAiRGlzcGxheU5hbWUiOiAiUmVjaXBpZW50IEVtYWlsIEFkZHJlc3MoZXMpIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJJbnB1dEpzb24iOiB7CiAgICAgICAgICAgICAgICAgICAgIkhpZGUiOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICJEZWZhdWx0VmFsdWUiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJTS1VQYXJ0TnVtYmVyIjogIlNQRV9FNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRnJpZW5kbHlOYW1lIjogIk1pY3Jvc29mdCAzNjUgRTUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk1pblRocmVzaG9sZCI6IDIwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk1heFRocmVzaG9sZCI6IDMwCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJTS1VQYXJ0TnVtYmVyIjogIkZMT1dfRlJFRSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRnJpZW5kbHlOYW1lIjogIk1pY3Jvc29mdCBQb3dlciBBdXRvbWF0ZSBGcmVlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNaW5UaHJlc2hvbGQiOiAxMAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJFbWFpbEZyb20iOiB7CiAgICAgICAgICAgICAgICAgICAgIkhpZGUiOiB0cnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgIkNhbGxlck5hbWUiOiB7CiAgICAgICAgICAgICAgICAgICAgIkhpZGUiOiB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KYGBgCgojIyBGaW5kaW5nIFNLVSBQYXJ0IE51bWJlcnMKCmBgYHBvd2Vyc2hlbGwKQ29ubmVjdC1NZ0dyYXBoIC1TY29wZXMgIk9yZ2FuaXphdGlvbi5SZWFkLkFsbCIKR2V0LU1nU3Vic2NyaWJlZFNrdSB8IFNlbGVjdC1PYmplY3QgU2t1UGFydE51bWJlciwgU2t1SWQgfCBTb3J0LU9iamVjdCBTa3VQYXJ0TnVtYmVyCmBgYAoKQ29tbW9uIFNLVXM6CgotIGBFTlRFUlBSSVNFUEFDS2AgLSBNaWNyb3NvZnQgMzY1IEUzCi0gYEVOVEVSUFJJU0VQUkVNSVVNYCAtIE1pY3Jvc29mdCAzNjUgRTUKLSBgRU1TYCAtIEVudGVycHJpc2UgTW9iaWxpdHkgKyBTZWN1cml0eSBFMwoKIyMgT3V0cHV0CgoqKldoZW4gdmlvbGF0aW9ucyBkZXRlY3RlZDoqKgoKLSBDb25zb2xlIG91dHB1dCBpbiBqb2IgbG9nCi0gQ1NWIGV4cG9ydCAoYExpY2Vuc2VfVGhyZXNob2xkX1Zpb2xhdGlvbnMuY3N2YCkKLSBFbWFpbCByZXBvcnQgd2l0aCBzdW1tYXJ5LCB2aW9sYXRpb25zLCByZWNvbW1lbmRhdGlvbnMsIGFuZCBDU1YgYXR0YWNobWVudAoKKipXaGVuIGFsbCB3aXRoaW4gdGhyZXNob2xkczoqKgoKLSBObyBlbWFpbCBzZW50Ci0gSm9iIGNvbXBsZXRlcyBzdWNjZXNzZnVsbHkKCiMjIFRyb3VibGVzaG9vdGluZwoKKipTS1UgTm90IEZvdW5kKio6IFZlcmlmeSBTS1UgZXhpc3RzIHVzaW5nIGBHZXQtTWdTdWJzY3JpYmVkU2t1YAoKKipFbWFpbCBOb3QgU2VudCoqOiBDaGVjayBFbWFpbEZyb20gY29uZmlndXJhdGlvbiBhbmQgTWFpbC5TZW5kIHBlcm1pc3Npb24KCioqSW52YWxpZCBKU09OKio6IFZhbGlkYXRlIEpTT04gZm9ybWF0IGJlZm9yZSBjb25maWd1cmF0aW9uCgojIyBNaWdyYXRpb24gTm90ZQoKTGVnYWN5IGBXYXJuaW5nVGhyZXNob2xkYCBhdXRvbWF0aWNhbGx5IG1hcHMgdG8gYE1pblRocmVzaG9sZGAgLSBvbGQgY29uZmlndXJhdGlvbnMgY29udGludWUgdG8gd29yay4K",
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Organization.Read.All\",\n                \"User.Read.All\",\n                \"Mail.Send\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Organization.Read.All",
            "User.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Report Pim Activations_Scheduled",
    "RunbookDisplayPath": "Org \\ General \\ Report Pim Activations_Scheduled",
    "RelativeRunbookPath": "org/general/report-pim-activations_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Scheduled report on PIM activations",
    "Description": "This runbook queries Microsoft Entra ID audit logs for recent PIM activations.\nIt builds an report and sends it via email.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "runbook@glueckkanja.com",
        "description": [
          {
            "Text": "Sender mailbox UPN used to send the report email."
          }
        ],
        "globbing": "false",
        "name": "sendAlertFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "support@glueckkanja.com",
        "description": [
          {
            "Text": "Recipient email address for the report."
          }
        ],
        "globbing": "false",
        "name": "sendAlertTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"AuditLog.Read.All\",\n                \"Mail.Send\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "AuditLog.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Sync All Devices",
    "RunbookDisplayPath": "Org \\ General \\ Sync All Devices",
    "RelativeRunbookPath": "org/general/sync-all-devices.ps1",
    "RelativeRunbookPath_PathOnly": "org/general",
    "PrimaryFolder": "Org",
    "SubFolder": "General",
    "Synopsis": "Sync all Intune Windows devices",
    "Description": "This runbook triggers a sync operation for all Windows devices managed by Microsoft Intune.\nIt forces devices to check in and apply pending policies and configurations.",
    "Notes": null,
    "Parameters": {
      "defaultValue": "",
      "description": [
        {
          "Text": "Caller name for auditing purposes."
        }
      ],
      "globbing": "false",
      "name": "CallerName",
      "parameterValue": "String",
      "pipelineInput": "false",
      "position": "1",
      "required": "true",
      "type": {
        "name": "String"
      }
    },
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Distribution List",
    "RunbookDisplayPath": "Org \\ Mail \\ Add Distribution List",
    "RelativeRunbookPath": "org/mail/add-distribution-list.ps1",
    "RelativeRunbookPath_PathOnly": "org/mail",
    "PrimaryFolder": "Org",
    "SubFolder": "Mail",
    "Synopsis": "Create a classic distribution group",
    "Description": "Creates a classic Exchange Online distribution group with optional owner configuration. If no primary SMTP address is provided, the default verified domain is used.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Mail alias (mail nickname) for the distribution group."
          }
        ],
        "globbing": "false",
        "name": "Alias",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the group can receive email from external senders."
          }
        ],
        "globbing": "false",
        "name": "AllowExternalSenders",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional display name for the distribution group; defaults to the alias."
          }
        ],
        "globbing": "false",
        "name": "GroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional owner who can manage the group."
          }
        ],
        "globbing": "false",
        "name": "Owner",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional primary SMTP address for the distribution group."
          }
        ],
        "globbing": "false",
        "name": "PrimarySMTPAddress",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the distribution group is created as a room list."
          }
        ],
        "globbing": "false",
        "name": "Roomlist",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Organization.Read.All\"\n            ]\n        },\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Organization.Read.All"
          ]
        },
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Equipment Mailbox",
    "RunbookDisplayPath": "Org \\ Mail \\ Add Equipment Mailbox",
    "RelativeRunbookPath": "org/mail/add-equipment-mailbox.ps1",
    "RelativeRunbookPath_PathOnly": "org/mail",
    "PrimaryFolder": "Org",
    "SubFolder": "Mail",
    "Synopsis": "Create an equipment mailbox",
    "Description": "Creates an Exchange Online equipment mailbox and optionally configures delegate access and calendar processing. If requested, the associated Entra ID user account is disabled after creation.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, meeting requests are automatically accepted."
          }
        ],
        "globbing": "false",
        "name": "AutoAccept",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the mailbox is automatically mapped in Outlook for the delegate."
          }
        ],
        "globbing": "false",
        "name": "AutoMapping",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional user who receives delegated access to the mailbox."
          }
        ],
        "globbing": "false",
        "name": "DelegateTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, the associated Entra ID user account is disabled."
          }
        ],
        "globbing": "false",
        "name": "DisableUser",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional display name for the equipment mailbox."
          }
        ],
        "globbing": "false",
        "name": "DisplayName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Alias (mail nickname) for the equipment mailbox."
          }
        ],
        "globbing": "false",
        "name": "MailboxName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Or Remove Public Folder",
    "RunbookDisplayPath": "Org \\ Mail \\ Add Or Remove Public Folder",
    "RelativeRunbookPath": "org/mail/add-or-remove-public-folder.ps1",
    "RelativeRunbookPath_PathOnly": "org/mail",
    "PrimaryFolder": "Org",
    "SubFolder": "Mail",
    "Synopsis": "Add or remove a public folder",
    "Description": "Creates or removes an Exchange Online public folder. The runbook assumes that at least one public folder mailbox already exists and does not provision public folder mailboxes.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the public folder is created; if set to false, it is removed."
          }
        ],
        "globbing": "false",
        "name": "AddPublicFolder",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional target public folder mailbox to create the folder in."
          }
        ],
        "globbing": "false",
        "name": "MailboxName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the public folder to create or remove."
          }
        ],
        "globbing": "false",
        "name": "PublicFolderName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Or Remove Teams Mailcontact",
    "RunbookDisplayPath": "Org \\ Mail \\ Add Or Remove Teams Mailcontact",
    "RelativeRunbookPath": "org/mail/add-or-remove-teams-mailContact.ps1",
    "RelativeRunbookPath_PathOnly": "org/mail",
    "PrimaryFolder": "Org",
    "SubFolder": "Mail",
    "Synopsis": "Create/Remove a contact, to allow pretty email addresses for Teams channels.",
    "Description": "Creates or updates a mail contact so a desired email address relays to the real Teams channel email address. The runbook can also remove the desired relay address again.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Desired email address that should relay to the real address."
          }
        ],
        "globbing": "false",
        "name": "DesiredAddress",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional display name for the contact in the address book."
          }
        ],
        "globbing": "false",
        "name": "DisplayName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Enter the address created by MS Teams for a channel"
          }
        ],
        "globbing": "false",
        "name": "RealAddress",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Relay the desired address to the real address\" (final value: $false) or \"Stop the relay and remove desired address\" (final value: $true) can be selected as action to perform."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Or Remove Tenant Allow Block List",
    "RunbookDisplayPath": "Org \\ Mail \\ Add Or Remove Tenant Allow Block List",
    "RelativeRunbookPath": "org/mail/add-or-remove-tenant-allow-block-list.ps1",
    "RelativeRunbookPath_PathOnly": "org/mail",
    "PrimaryFolder": "Org",
    "SubFolder": "Mail",
    "Synopsis": "Add or remove entries from the Tenant Allow/Block List",
    "Description": "Adds or removes entries from the Tenant Allow/Block List in Microsoft Defender for Office 365. The runbook supports senders, URLs, and file hashes and sets new entries to expire after 30 days by default.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "\"Block List (block entry)\" (final value: $true) or \"Allow List (permit entry)\" (final value: $false) can be selected as list type."
          }
        ],
        "globbing": "false",
        "name": "Block",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "30",
        "description": [
          {
            "Text": "Number of days until a newly added entry expires."
          }
        ],
        "globbing": "false",
        "name": "DaysToExpire",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The entry to add or remove (for example: domain, email address, URL, or file hash)."
          }
        ],
        "globbing": "false",
        "name": "Entry",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Sender",
        "description": [
          {
            "Text": "Type of entry to manage."
          }
        ],
        "globbing": "false",
        "name": "ListType",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Add entry to the list\" (final value: $false) or \"Remove entry from the list\" (final value: $true) can be selected as action to perform."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Room Mailbox",
    "RunbookDisplayPath": "Org \\ Mail \\ Add Room Mailbox",
    "RelativeRunbookPath": "org/mail/add-room-mailbox.ps1",
    "RelativeRunbookPath_PathOnly": "org/mail",
    "PrimaryFolder": "Org",
    "SubFolder": "Mail",
    "Synopsis": "Create a room mailbox resource",
    "Description": "Creates an Exchange Online room mailbox and optionally configures delegation and calendar processing. If requested, the associated Entra ID user account is disabled after creation.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, meeting requests are automatically accepted."
          }
        ],
        "globbing": "false",
        "name": "AutoAccept",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the mailbox is automatically mapped in Outlook for the delegate."
          }
        ],
        "globbing": "false",
        "name": "AutoMapping",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "Optional room capacity in number of people."
          }
        ],
        "globbing": "false",
        "name": "Capacity",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional user who receives delegated access to the mailbox."
          }
        ],
        "globbing": "false",
        "name": "DelegateTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, the associated Entra ID user account is disabled."
          }
        ],
        "globbing": "false",
        "name": "DisableUser",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional display name for the room mailbox."
          }
        ],
        "globbing": "false",
        "name": "DisplayName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Alias (mail nickname) for the room mailbox."
          }
        ],
        "globbing": "false",
        "name": "MailboxName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Shared Mailbox",
    "RunbookDisplayPath": "Org \\ Mail \\ Add Shared Mailbox",
    "RelativeRunbookPath": "org/mail/add-shared-mailbox.ps1",
    "RelativeRunbookPath_PathOnly": "org/mail",
    "PrimaryFolder": "Org",
    "SubFolder": "Mail",
    "Synopsis": "Create a shared mailbox",
    "Description": "This script creates a shared mailbox in Exchange Online and configures various settings such as delegation, auto-mapping, and message copy options.\nAlso if specified, it disables the associated EntraID user account.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the mailbox is automatically mapped in Outlook for the delegate."
          }
        ],
        "globbing": "false",
        "name": "AutoMapping",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional user who receives delegated access to the mailbox."
          }
        ],
        "globbing": "false",
        "name": "DelegateTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, the associated Entra ID user account is disabled."
          }
        ],
        "globbing": "false",
        "name": "DisableUser",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Display name for the shared mailbox."
          }
        ],
        "globbing": "false",
        "name": "DisplayName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Optional domain used for the primary SMTP address; if not provided, the default domain is used."
          }
        ],
        "globbing": "false",
        "name": "DomainName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "en-US",
        "description": [
          {
            "Text": "The language/locale for the shared mailbox. This setting affects folder names like \"Inbox\". Default is \"en-US\"."
          }
        ],
        "globbing": "false",
        "name": "Language",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The alias (mailbox name) for the shared mailbox."
          }
        ],
        "globbing": "false",
        "name": "MailboxName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, copies of messages sent on behalf of the mailbox are stored in the mailbox sent items."
          }
        ],
        "globbing": "false",
        "name": "MessageCopyForSendOnBehalfEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, copies of messages sent as the mailbox are stored in the mailbox sent items."
          }
        ],
        "globbing": "false",
        "name": "MessageCopyForSentAsEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Hide Mailboxes_Scheduled",
    "RunbookDisplayPath": "Org \\ Mail \\ Hide Mailboxes_Scheduled",
    "RelativeRunbookPath": "org/mail/hide-mailboxes_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/mail",
    "PrimaryFolder": "Org",
    "SubFolder": "Mail",
    "Synopsis": "Hide or unhide special mailboxes in the Global Address List",
    "Description": "Hides or unhides special mailboxes in the Global Address List, currently intended for Bookings calendars. The runbook updates all scheduling mailboxes accordingly.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, booking calendars are hidden from address lists."
          }
        ],
        "globbing": "false",
        "name": "HideBookingCalendars",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Set Booking Config",
    "RunbookDisplayPath": "Org \\ Mail \\ Set Booking Config",
    "RelativeRunbookPath": "org/mail/set-booking-config.ps1",
    "RelativeRunbookPath_PathOnly": "org/mail",
    "PrimaryFolder": "Org",
    "SubFolder": "Mail",
    "Synopsis": "Configure Microsoft Bookings settings for the organization",
    "Description": "Configures Microsoft Bookings settings at the organization level using Exchange Online organization configuration. The runbook can optionally create an OWA mailbox policy for Bookings creators and disable Bookings in the default OWA policy.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, address entry is restricted."
          }
        ],
        "globbing": "false",
        "name": "BookingsAddressEntryRestricted",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, Bookings uses authentication."
          }
        ],
        "globbing": "false",
        "name": "BookingsAuthEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, blocked words are enabled for naming policies."
          }
        ],
        "globbing": "false",
        "name": "BookingsBlockedWordsEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "13",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, creation of custom questions is restricted."
          }
        ],
        "globbing": "false",
        "name": "BookingsCreationOfCustomQuestionsRestricted",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, Microsoft Bookings is enabled for the organization."
          }
        ],
        "globbing": "false",
        "name": "BookingsEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, exposure of staff details is restricted."
          }
        ],
        "globbing": "false",
        "name": "BookingsExposureOfStaffDetailsRestricted",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, membership approval is required."
          }
        ],
        "globbing": "false",
        "name": "BookingsMembershipApprovalRequired",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, naming policies are enabled."
          }
        ],
        "globbing": "false",
        "name": "BookingsNamingPolicyEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "Booking-",
        "description": [
          {
            "Text": "Prefix applied by the naming policy."
          }
        ],
        "globbing": "false",
        "name": "BookingsNamingPolicyPrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "15",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, the naming policy prefix is enabled."
          }
        ],
        "globbing": "false",
        "name": "BookingsNamingPolicyPrefixEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "14",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Suffix applied by the naming policy."
          }
        ],
        "globbing": "false",
        "name": "BookingsNamingPolicySuffix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "17",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, the naming policy suffix is enabled."
          }
        ],
        "globbing": "false",
        "name": "BookingsNamingPolicySuffixEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "16",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, notes entry is restricted."
          }
        ],
        "globbing": "false",
        "name": "BookingsNotesEntryRestricted",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, phone number entry is restricted."
          }
        ],
        "globbing": "false",
        "name": "BookingsPhoneNumberEntryRestricted",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, search engine indexing is disabled."
          }
        ],
        "globbing": "false",
        "name": "BookingsSearchEngineIndexDisabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, Microsoft SMS notifications are enabled."
          }
        ],
        "globbing": "false",
        "name": "BookingsSmsMicrosoftEnabled",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, social sharing is restricted."
          }
        ],
        "globbing": "false",
        "name": "BookingsSocialSharingRestricted",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "20",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, an OWA mailbox policy for Bookings creators is created if missing."
          }
        ],
        "globbing": "false",
        "name": "CreateOwaPolicy",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "18",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "BookingsCreators",
        "description": [
          {
            "Text": "Name of the OWA mailbox policy to create or use for Bookings creators."
          }
        ],
        "globbing": "false",
        "name": "OwaPolicyName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "19",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Get Teams Phone Number Assignment",
    "RunbookDisplayPath": "Org \\ Phone \\ Get Teams Phone Number Assignment",
    "RelativeRunbookPath": "org/phone/get-teams-phone-number-assignment.ps1",
    "RelativeRunbookPath_PathOnly": "org/phone",
    "PrimaryFolder": "Org",
    "SubFolder": "Phone",
    "Synopsis": "Check whether a phone number is assigned in Microsoft Teams",
    "Description": "Looks up whether a given phone number is assigned to a user in Microsoft Teams. If the phone number is assigned, information about the user and relevant voice policies is returned.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "CallerName is tracked purely for auditing purposes"
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The phone number must be in E.164 format. Example: +49321987654 or +49321987654;ext=123. It must start with a '+' followed by the country code and subscriber number, with an optional ';ext=' followed by the extension number, without spaces or special characters."
          }
        ],
        "globbing": "false",
        "name": "PhoneNumber",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": "## Additional documentation\nIf a Teams user is found for the phone number, the following details are displayed:\n- Display name\n- User principal name\n- Account type\n- Phone number type\n- Online voice routing policy\n- Calling policy\n- Dial plan\n- Tenant dial plan",
    "DocsContentEncoded": "IyMgQWRkaXRpb25hbCBkb2N1bWVudGF0aW9uCklmIGEgVGVhbXMgdXNlciBpcyBmb3VuZCBmb3IgdGhlIHBob25lIG51bWJlciwgdGhlIGZvbGxvd2luZyBkZXRhaWxzIGFyZSBkaXNwbGF5ZWQ6Ci0gRGlzcGxheSBuYW1lCi0gVXNlciBwcmluY2lwYWwgbmFtZQotIEFjY291bnQgdHlwZQotIFBob25lIG51bWJlciB0eXBlCi0gT25saW5lIHZvaWNlIHJvdXRpbmcgcG9saWN5Ci0gQ2FsbGluZyBwb2xpY3kKLSBEaWFsIHBsYW4KLSBUZW5hbnQgZGlhbCBwbGFu",
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Organization.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Teams Administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Organization.Read.All"
          ]
        }
      ],
      "Roles": [
        "Teams Administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Defender Indicator",
    "RunbookDisplayPath": "Org \\ Security \\ Add Defender Indicator",
    "RelativeRunbookPath": "org/security/add-defender-indicator.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "Create a new Microsoft Defender for Endpoint indicator",
    "Description": "Creates a new indicator in Microsoft Defender for Endpoint to allow or block a specific file hash, certificate thumbprint, IP, domain, or URL. The indicator action can generate alerts automatically for audit or alert-and-block actions.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "Allowed",
        "description": [
          {
            "Text": "Action applied to the indicator."
          }
        ],
        "globbing": "false",
        "name": "Action",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Description of the indicator entry."
          }
        ],
        "globbing": "false",
        "name": "Description",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, an alert is generated when the indicator matches."
          }
        ],
        "globbing": "false",
        "name": "GenerateAlert",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "FileSha256",
        "description": [
          {
            "Text": "Type of the indicator value."
          }
        ],
        "globbing": "false",
        "name": "IndicatorType",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Value of the indicator, such as a hash, thumbprint, IP address, domain name, or URL."
          }
        ],
        "globbing": "false",
        "name": "IndicatorValue",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Informational",
        "description": [
          {
            "Text": "Severity used for the indicator."
          }
        ],
        "globbing": "false",
        "name": "Severity",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Title of the indicator entry."
          }
        ],
        "globbing": "false",
        "name": "Title",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"WindowsDefenderATP\",\n            \"Id\": \"fc780465-2017-40d4-a0c5-307022471b92\",\n            \"AppRoleAssignments\": [\n                \"Ti.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "WindowsDefenderATP",
          "Id": "fc780465-2017-40d4-a0c5-307022471b92",
          "AppRoleAssignments": [
            "Ti.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Backup Conditional Access Policies",
    "RunbookDisplayPath": "Org \\ Security \\ Backup Conditional Access Policies",
    "RelativeRunbookPath": "org/security/backup-conditional-access-policies.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "Export Conditional Access policies to an Azure Storage account",
    "Description": "Exports the current set of Conditional Access policies via Microsoft Graph and uploads them as a ZIP archive to Azure Storage. If no container name is provided, a date-based name is generated.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage container; if omitted, a default name is generated."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Resource Group containing the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage Account used for upload."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "SKU name for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Policy.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": [\n        \"Azure IaaS: Access to the given Azure Storage Account / Resource Group\"\n    ]\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Policy.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": [
        "Azure IaaS: Access to the given Azure Storage Account / Resource Group"
      ]
    }
  },
  {
    "RunbookDisplayName": "List Admin Users",
    "RunbookDisplayPath": "Org \\ Security \\ List Admin Users",
    "RelativeRunbookPath": "org/security/list-admin-users.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "List Entra ID role holders and optionally evaluate their MFA methods",
    "Description": "Lists users and service principals holding built-in Entra ID roles and produces an admin-to-role report. Optionally queries each admin for registered authentication methods to assess MFA coverage.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "13",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage container to upload the CSV report to."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, exports the report to an Azure Storage Account."
          }
        ],
        "globbing": "false",
        "name": "ExportToFile",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, includes PIM eligible until information in the CSV report."
          }
        ],
        "globbing": "false",
        "name": "PimEligibleUntilInCSV",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "\"Check and report every admin's MFA state\" (final value: $true) or \"Do not check admin MFA states\" (final value: $false) can be selected as action to perform."
          }
        ],
        "globbing": "false",
        "name": "QueryMfaState",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Resource Group containing the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage Account used for upload."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "SKU name for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, regards email as a valid MFA method."
          }
        ],
        "globbing": "false",
        "name": "TrustEmailMfa",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, regards phone/SMS as a valid MFA method."
          }
        ],
        "globbing": "false",
        "name": "TrustPhoneMfa",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, regards software OATH token as a valid MFA method."
          }
        ],
        "globbing": "false",
        "name": "TrustSoftwareOathMfa",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, regards Windows Hello for Business as a valid MFA method."
          }
        ],
        "globbing": "false",
        "name": "TrustWinHelloMFA",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"Directory.Read.All\",\n                \"RoleManagement.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "Directory.Read.All",
            "RoleManagement.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Expiring Role Assignments",
    "RunbookDisplayPath": "Org \\ Security \\ List Expiring Role Assignments",
    "RelativeRunbookPath": "org/security/list-expiring-role-assignments.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "List Azure AD role assignments expiring within a given number of days",
    "Description": "Lists active and PIM-eligible Azure AD role assignments that expire within a specified number of days. The output includes role name, principal, and expiration date.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "30",
        "description": [
          {
            "Text": "Maximum number of days until expiry."
          }
        ],
        "globbing": "false",
        "name": "Days",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Organization.Read.All\",\n                \"RoleManagement.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Organization.Read.All",
            "RoleManagement.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Inactive Devices",
    "RunbookDisplayPath": "Org \\ Security \\ List Inactive Devices",
    "RelativeRunbookPath": "org/security/list-inactive-devices.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "List or export inactive devices with no recent logon or Intune sync",
    "Description": "Collects devices based on either last interactive sign-in or last Intune sync date and lists them in the console. Optionally exports the results to a CSV file in Azure Storage.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage container to upload the CSV report to."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "30",
        "description": [
          {
            "Text": "Number of days without sync or sign-in used to consider a device inactive."
          }
        ],
        "globbing": "false",
        "name": "Days",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, exports the results to a CSV file in Azure Storage."
          }
        ],
        "globbing": "false",
        "name": "ExportToFile",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Resource Group containing the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage Account used for upload."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "SKU name for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, inactivity is based on last Intune sync; otherwise it is based on last interactive sign-in."
          }
        ],
        "globbing": "false",
        "name": "Sync",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.Read.All\",\n                \"Directory.Read.All\",\n                \"Device.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All",
            "Directory.Read.All",
            "Device.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Inactive Users",
    "RunbookDisplayPath": "Org \\ Security \\ List Inactive Users",
    "RelativeRunbookPath": "org/security/list-inactive-users.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "List users with no recent interactive sign-ins",
    "Description": "Lists users and guests that have not signed in interactively for a specified number of days. Optionally includes accounts that never signed in and accounts that are blocked.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "30",
        "description": [
          {
            "Text": "Number of days without interactive sign-in."
          }
        ],
        "globbing": "false",
        "name": "Days",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, includes users and guests that cannot sign in."
          }
        ],
        "globbing": "false",
        "name": "ShowBlockedUsers",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, includes users and guests that never signed in."
          }
        ],
        "globbing": "false",
        "name": "ShowUsersThatNeverLoggedIn",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"AuditLog.Read.All\",\n                \"Organization.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "AuditLog.Read.All",
            "Organization.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Information Protection Labels",
    "RunbookDisplayPath": "Org \\ Security \\ List Information Protection Labels",
    "RelativeRunbookPath": "org/security/list-information-protection-labels.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "List Microsoft Information Protection labels",
    "Description": "Retrieves all available Microsoft Information Protection labels in the tenant. This can be used to get the label IDs for use in other runbooks, e.g. for auto-labeling based on sensitivity.",
    "Notes": null,
    "Parameters": {
      "defaultValue": "",
      "description": [
        {
          "Text": "Caller name for auditing purposes."
        }
      ],
      "globbing": "false",
      "name": "CallerName",
      "parameterValue": "String",
      "pipelineInput": "false",
      "position": "1",
      "required": "true",
      "type": {
        "name": "String"
      }
    },
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"InformationProtectionPolicy.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "InformationProtectionPolicy.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Pim Rolegroups Without Owners_Scheduled",
    "RunbookDisplayPath": "Org \\ Security \\ List Pim Rolegroups Without Owners_Scheduled",
    "RelativeRunbookPath": "org/security/list-pim-rolegroups-without-owners_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "List role-assignable groups with eligible role assignments but without owners",
    "Description": "Finds role-assignable groups that have PIM eligible role assignments but no owners assigned. Optionally sends an email alert containing the group names.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "reports@contoso.com",
        "description": [
          {
            "Text": "Sender email address used to send the alert."
          }
        ],
        "globbing": "false",
        "name": "From",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, sends an email when matching groups are found."
          }
        ],
        "globbing": "false",
        "name": "SendEmailIfFound",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "support@glueckkanja-gab.com",
        "description": [
          {
            "Text": "Recipient email address for the alert."
          }
        ],
        "globbing": "false",
        "name": "To",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.Read.All\",\n                \"RoleManagement.Read.Directory\",\n                \"Mail.Send\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.Read.All",
            "RoleManagement.Read.Directory",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Users By MFA Methods Count",
    "RunbookDisplayPath": "Org \\ Security \\ List Users By MFA Methods Count",
    "RelativeRunbookPath": "org/security/list-users-by-MFA-methods-count.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "Report users by the count of their registered MFA methods",
    "Description": "This Runbook retrieves a list of users from Azure AD and counts their registered MFA authentication methods.\nAs a dropdown for the MFA methods count range, you can select from \"0 methods (no MFA)\", \"1-3 methods\", \"4-5 methods\", or \"6+ methods\".\nThe output includes the user display name, user principal name, and the count of registered MFA methods.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Range for filtering users based on the count of their registered MFA methods."
          }
        ],
        "globbing": "false",
        "name": "mfaMethodsRange",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"UserAuthenticationMethod.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "UserAuthenticationMethod.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Vulnerable App Regs",
    "RunbookDisplayPath": "Org \\ Security \\ List Vulnerable App Regs",
    "RelativeRunbookPath": "org/security/list-vulnerable-app-regs.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "List app registrations potentially vulnerable to CVE-2021-42306",
    "Description": "Lists Azure AD app registrations that may be affected by CVE-2021-42306 by inspecting stored key credentials. Optionally exports the findings to a CSV file in Azure Storage.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage container to upload the CSV report to."
          }
        ],
        "globbing": "false",
        "name": "ContainerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"List in Console\" (final value: $false) or \"Export to a CSV file\" (final value: $true) can be selected as action to perform. The export saves the findings to a CSV file in Azure Storage."
          }
        ],
        "globbing": "false",
        "name": "ExportToFile",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "1",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Resource Group containing the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "ResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Azure Storage Account used for upload."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "SKU name for the Storage Account if it needs to be created."
          }
        ],
        "globbing": "false",
        "name": "StorageAccountSku",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementManagedDevices.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementManagedDevices.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Monitor Pending EPM Requests_Scheduled",
    "RunbookDisplayPath": "Org \\ Security \\ Monitor Pending EPM Requests_Scheduled",
    "RelativeRunbookPath": "org/security/monitor-pending-EPM-requests_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "Monitor and report pending Endpoint Privilege Management (EPM) elevation requests",
    "Description": "Queries Microsoft Intune for pending EPM elevation requests and sends an email report.\nEmail is only sent when there are pending requests.\nOptionally includes detailed information about each request in a table and CSV attachment.",
    "Notes": "Runbook Type: Scheduled (recommended: hourly or every 1 hours)\n\nEndpoint Privilege Management (EPM) Context:\n- EPM allows users to request temporary admin rights for specific applications\n- Pending requests require manual review and approval by security admins\n- Requests expire automatically if not reviewed within the configured timeframe\n- Timely review is critical for user productivity and security posture\n\nEmail Behavior:\n- Emails are sent individually to each recipient\n- No email is sent when there are zero pending requests\n- CSV attachment is only included when DetailedReport is enabled",
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Internal parameter for tracking purposes"
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "When enabled, includes detailed request information in a table and as CSV attachment.\nWhen disabled, only provides a summary count of pending requests."
          }
        ],
        "globbing": "false",
        "name": "DetailedReport",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The sender email address. This needs to be configured in the runbook customization."
          }
        ],
        "globbing": "false",
        "name": "EmailFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Can be a single address or multiple comma-separated addresses (string).\nThe function sends individual emails to each recipient for privacy reasons."
          }
        ],
        "globbing": "false",
        "name": "EmailTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": "## Setup regarding email sending\n\nThis runbook sends emails using the Microsoft Graph API. To send emails via Graph API, you need to configure an existing email address in the runbook customization.\n\nThis process is described in detail in the [Setup Email Reporting](https://github.com/realmjoin/realmjoin-runbooks/tree/master/docs/general/setup-email-reporting.md) documentation.\n",
    "DocsContentEncoded": "IyMgU2V0dXAgcmVnYXJkaW5nIGVtYWlsIHNlbmRpbmcKClRoaXMgcnVuYm9vayBzZW5kcyBlbWFpbHMgdXNpbmcgdGhlIE1pY3Jvc29mdCBHcmFwaCBBUEkuIFRvIHNlbmQgZW1haWxzIHZpYSBHcmFwaCBBUEksIHlvdSBuZWVkIHRvIGNvbmZpZ3VyZSBhbiBleGlzdGluZyBlbWFpbCBhZGRyZXNzIGluIHRoZSBydW5ib29rIGN1c3RvbWl6YXRpb24uCgpUaGlzIHByb2Nlc3MgaXMgZGVzY3JpYmVkIGluIGRldGFpbCBpbiB0aGUgW1NldHVwIEVtYWlsIFJlcG9ydGluZ10oaHR0cHM6Ly9naXRodWIuY29tL3JlYWxtam9pbi9yZWFsbWpvaW4tcnVuYm9va3MvdHJlZS9tYXN0ZXIvZG9jcy9nZW5lcmFsL3NldHVwLWVtYWlsLXJlcG9ydGluZy5tZCkgZG9jdW1lbnRhdGlvbi4K",
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementConfiguration.Read.All\",\n                \"Mail.Send\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementConfiguration.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Notify Changed CA Policies",
    "RunbookDisplayPath": "Org \\ Security \\ Notify Changed CA Policies",
    "RelativeRunbookPath": "org/security/notify-changed-CA-Policies.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "Send notification email if Conditional Access policies have been created or modified in the last 24 hours.",
    "Description": "Checks Conditional Access policies for changes in the last 24 hours and sends an email with a text attachment listing the changed policies. If no changes are detected, no email is sent.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Sender email address used to send the notification."
          }
        ],
        "globbing": "false",
        "name": "From",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Recipient email address for the notification."
          }
        ],
        "globbing": "false",
        "name": "To",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Policy.Read.All\",\n                \"Mail.Send\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Policy.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Report EPM Elevation Requests_Scheduled",
    "RunbookDisplayPath": "Org \\ Security \\ Report EPM Elevation Requests_Scheduled",
    "RelativeRunbookPath": "org/security/report-EPM-elevation-requests_scheduled.ps1",
    "RelativeRunbookPath_PathOnly": "org/security",
    "PrimaryFolder": "Org",
    "SubFolder": "Security",
    "Synopsis": "Generate report for Endpoint Privilege Management (EPM) elevation requests",
    "Description": "Queries Microsoft Intune for EPM elevation requests with flexible filtering options.\nSupports filtering by multiple status types and time range.\nSends an email report with summary statistics and detailed CSV attachment.",
    "Notes": "Runbook Type: Scheduled (recommended: monthly)\n\nPurpose & Use Cases:\n- Regular reporting of EPM activities\n- Audit trail for approved/denied elevation requests\n- Analysis of expired requests to identify process bottlenecks\n- Identification of frequently requested applications for automatic elevation rules\n\nStatus Types Explained:\n- Pending: Awaits admin decision (use monitor-pending-EPM-requests for time-critical alerting)\n- Approved: Admin approved the request, user can proceed with elevation\n- Denied: Admin rejected the request due to security/policy concerns\n- Expired: Request expired before admin review (may indicate slow response times)\n- Revoked: Previously approved elevation was later revoked by admin\n- Completed: User successfully executed the elevated application after approval\n\nData Retention & Time Ranges:\n- Intune retains EPM request details for 30 days after creation\n- For long-term analysis, archive CSV exports outside of Intune\n- Default filter (Approved/Denied/Expired/Revoked, 30 days)\n\nEmail & Export Details:\n- Always generates CSV attachment with complete request details\n- Emails sent individually to each recipient for privacy\n- No email sent when zero requests match the filter criteria\n- CSV includes: timestamps, users, devices, applications, justifications, file hashes",
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Internal parameter for tracking purposes"
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The sender email address. This needs to be configured in the runbook customization."
          }
        ],
        "globbing": "false",
        "name": "EmailFrom",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Can be a single address or multiple comma-separated addresses (string).\nThe function sends individual emails to each recipient for privacy reasons."
          }
        ],
        "globbing": "false",
        "name": "EmailTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include requests with status \"Approved\" - Request has been approved by an administrator."
          }
        ],
        "globbing": "false",
        "name": "IncludeApproved",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Include requests with status \"Completed\" - Request was approved and executed successfully."
          }
        ],
        "globbing": "false",
        "name": "IncludeCompleted",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include requests with status \"Denied\" - Request was rejected by an administrator."
          }
        ],
        "globbing": "false",
        "name": "IncludeDenied",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include requests with status \"Expired\" - Request expired before approval/denial."
          }
        ],
        "globbing": "false",
        "name": "IncludeExpired",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "Include requests with status \"Pending\" - Awaiting approval decision."
          }
        ],
        "globbing": "false",
        "name": "IncludePending",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "Include requests with status \"Revoked\" - Previously approved request was revoked."
          }
        ],
        "globbing": "false",
        "name": "IncludeRevoked",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "30",
        "description": [
          {
            "Text": "Filter requests created within the last X days (default: 30).\nNote: Request details are retained in Intune for 30 days after creation."
          }
        ],
        "globbing": "false",
        "name": "MaxAgeInDays",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      }
    ],
    "DocsContent": "## Setup regarding email sending\n\nThis runbook sends emails using the Microsoft Graph API. To send emails via Graph API, you need to configure an existing email address in the runbook customization.\n\nThis process is described in detail in the [Setup Email Reporting](https://github.com/realmjoin/realmjoin-runbooks/tree/master/docs/general/setup-email-reporting.md) documentation.\n",
    "DocsContentEncoded": "IyMgU2V0dXAgcmVnYXJkaW5nIGVtYWlsIHNlbmRpbmcKClRoaXMgcnVuYm9vayBzZW5kcyBlbWFpbHMgdXNpbmcgdGhlIE1pY3Jvc29mdCBHcmFwaCBBUEkuIFRvIHNlbmQgZW1haWxzIHZpYSBHcmFwaCBBUEksIHlvdSBuZWVkIHRvIGNvbmZpZ3VyZSBhbiBleGlzdGluZyBlbWFpbCBhZGRyZXNzIGluIHRoZSBydW5ib29rIGN1c3RvbWl6YXRpb24uCgpUaGlzIHByb2Nlc3MgaXMgZGVzY3JpYmVkIGluIGRldGFpbCBpbiB0aGUgW1NldHVwIEVtYWlsIFJlcG9ydGluZ10oaHR0cHM6Ly9naXRodWIuY29tL3JlYWxtam9pbi9yZWFsbWpvaW4tcnVuYm9va3MvdHJlZS9tYXN0ZXIvZG9jcy9nZW5lcmFsL3NldHVwLWVtYWlsLXJlcG9ydGluZy5tZCkgZG9jdW1lbnRhdGlvbi4K",
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"DeviceManagementConfiguration.Read.All\",\n                \"Mail.Send\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "DeviceManagementConfiguration.Read.All",
            "Mail.Send"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "User Signout",
    "RunbookDisplayPath": "User \\ Avd \\ User Signout",
    "RelativeRunbookPath": "user/avd/user-signout.ps1",
    "RelativeRunbookPath_PathOnly": "user/avd",
    "PrimaryFolder": "User",
    "SubFolder": "Avd",
    "Synopsis": "Removes (Signs Out) a specific User from their AVD Session.",
    "Description": "This Runbooks looks for active User Sessions in all AVD Hostpools of a tenant and removes forces a Sign-Out of the user.\nThe SubscriptionIds value must be defined in the runbooks customization.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name for auditing purposes"
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Array of Azure subscription IDs where the AVD resources are located. Retrieved from AVD.SubscriptionIds setting (Customization). Hidden in UI."
          }
        ],
        "globbing": "false",
        "name": "SubscriptionIds",
        "parameterValue": "String[]",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String[]"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "The username (UPN) of the user to sign out from their AVD session. Hidden in UI."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [],\n    \"Roles\": [],\n    \"ManualPermissions\": [ \"Azure: Desktop Virtualization Host Pool Contributor on Subscription which contains the Hostpool\" ]\n}\n",
    "PermissionsJson": {
      "Permissions": [],
      "Roles": [],
      "ManualPermissions": [
        "Azure: Desktop Virtualization Host Pool Contributor on Subscription which contains the Hostpool"
      ]
    }
  },
  {
    "RunbookDisplayName": "Assign Groups By Template",
    "RunbookDisplayPath": "User \\ General \\ Assign Groups By Template",
    "RelativeRunbookPath": "user/general/assign-groups-by-template.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "Assign cloud-only groups to a user based on a template",
    "Description": "Adds a user to one or more Entra ID groups using either group object IDs or display names. The list of groups is typically provided via runbook customization templates.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Comma-separated list of group object IDs or group display names."
          }
        ],
        "globbing": "false",
        "name": "GroupsString",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Template selector used by portal customization to populate the group list."
          }
        ],
        "globbing": "false",
        "name": "GroupsTemplate",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, treats values in GroupsString as group display names instead of IDs."
          }
        ],
        "globbing": "false",
        "name": "UseDisplaynames",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "ID of the target user in Microsoft Graph."
          }
        ],
        "globbing": "false",
        "name": "UserId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Group.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}\n",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Group.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Assign Or Unassign License",
    "RunbookDisplayPath": "User \\ General \\ Assign Or Unassign License",
    "RelativeRunbookPath": "user/general/assign-or-unassign-license.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "Assign or remove a license for a user via group membership",
    "Description": "Adds or removes a user to a dedicated license assignment group to control license allocation. The license group must match the configured naming convention.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Object ID of the license assignment group."
          }
        ],
        "globbing": "false",
        "name": "GroupID_License",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Assign the license to the user\" (final value: $false) or \"Remove the license from the user\" (final value: $true) can be selected as action to perform."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"GroupMember.ReadWrite.All\",\n                \"Group.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "GroupMember.ReadWrite.All",
            "Group.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Assign Windows365",
    "RunbookDisplayPath": "User \\ General \\ Assign Windows365",
    "RelativeRunbookPath": "user/general/assign-windows365.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "Assign and provision a Windows 365 Cloud PC for a user",
    "Description": "Assigns the required groups and license or Frontline provisioning policy to initiate Windows 365 provisioning. Optionally notifies the user when provisioning completes and can create a support ticket when licenses are exhausted.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "14",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "cfg - Windows 365 - Provisioning - Win11",
        "description": [
          {
            "Text": "Display name of the provisioning policy group or Frontline assignment to use."
          }
        ],
        "globbing": "false",
        "name": "cfgProvisioningGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "cfg - Windows 365 - Provisioning -",
        "description": [
          {
            "Text": "Prefix used to detect provisioning-related configuration groups."
          }
        ],
        "globbing": "false",
        "name": "cfgProvisioningGroupPrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "cfg - Windows 365 - User Settings - restore allowed",
        "description": [
          {
            "Text": "Display name of the user settings policy group to use."
          }
        ],
        "globbing": "false",
        "name": "cfgUserSettingsGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "cfg - Windows 365 - User Settings -",
        "description": [
          {
            "Text": "Prefix used to detect user-settings-related configuration groups."
          }
        ],
        "globbing": "false",
        "name": "cfgUserSettingsGroupPrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, creates a service ticket email when no licenses or Frontline seats are available."
          }
        ],
        "globbing": "false",
        "name": "createTicketOutOfLicenses",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, uses a custom email body."
          }
        ],
        "globbing": "false",
        "name": "customizeMail",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "Insert Custom Message here. (Capped at 3000 characters)",
        "description": [
          {
            "Text": "Custom message body used for the notification email."
          }
        ],
        "globbing": "false",
        "name": "customMailMessage",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "runbooks@contoso.com",
        "description": [
          {
            "Text": "Mailbox used to send the ticket and user notification emails."
          }
        ],
        "globbing": "false",
        "name": "fromMailAddress",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "lic - Windows 365 Enterprise - 2 vCPU 4 GB 128 GB",
        "description": [
          {
            "Text": "Display name of the Windows 365 license group to assign when using dedicated Cloud PCs."
          }
        ],
        "globbing": "false",
        "name": "licWin365GroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, sends an email to the user after provisioning completes."
          }
        ],
        "globbing": "false",
        "name": "sendMailWhenProvisioned",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "Contoso",
        "description": [
          {
            "Text": "Customer identifier used in ticket subject lines."
          }
        ],
        "globbing": "false",
        "name": "ticketCustomerId",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "13",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "support@glueckkanja-gab.com",
        "description": [
          {
            "Text": "Email address used as ticket queue recipient."
          }
        ],
        "globbing": "false",
        "name": "ticketQueueAddress",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"GroupMember.ReadWrite.All\",\n                \"Group.ReadWrite.All\",\n                \"User.SendMail\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "GroupMember.ReadWrite.All",
            "Group.ReadWrite.All",
            "User.SendMail"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Group Memberships",
    "RunbookDisplayPath": "User \\ General \\ List Group Memberships",
    "RelativeRunbookPath": "user/general/list-group-memberships.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "List group memberships for this user",
    "Description": "Lists group memberships for this user and supports filtering by group type, membership type, role-assignable status, Teams enablement, source, and writeback status. Outputs the results as CSV-formatted text.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "All",
        "description": [
          {
            "Text": "Filter by group type: Security (security permissions only), M365 (Microsoft 365 groups with mailbox), or All (default)."
          }
        ],
        "globbing": "false",
        "name": "GroupType",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "All",
        "description": [
          {
            "Text": "Filter by membership type: Assigned (manually added members), Dynamic (rule-based membership), or All (default)."
          }
        ],
        "globbing": "false",
        "name": "MembershipType",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "NotSet",
        "description": [
          {
            "Text": "Filter groups that can be assigned to Azure AD roles: Yes (role-assignable only) or NotSet (all groups, default)."
          }
        ],
        "globbing": "false",
        "name": "RoleAssignable",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "All",
        "description": [
          {
            "Text": "Filter by group origin: Cloud (Azure AD only), OnPrem (synchronized from on-premises AD), or All (default)."
          }
        ],
        "globbing": "false",
        "name": "Source",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "NotSet",
        "description": [
          {
            "Text": "Filter groups with Microsoft Teams functionality: Yes (Teams-enabled only) or NotSet (all groups, default)."
          }
        ],
        "globbing": "false",
        "name": "TeamsEnabled",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "All",
        "description": [
          {
            "Text": "Filter groups by writeback enablement."
          }
        ],
        "globbing": "false",
        "name": "WritebackEnabled",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\r\n    \"Permissions\": [\r\n        {\r\n            \"Name\": \"Microsoft Graph\",\r\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\r\n            \"AppRoleAssignments\": [\r\n                \"User.Read.All\",\r\n                \"Group.Read.All\"\r\n            ]\r\n        }\r\n    ],\r\n    \"Roles\": [],\r\n    \"ManualPermissions\": []\r\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "Group.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Group Ownerships",
    "RunbookDisplayPath": "User \\ General \\ List Group Ownerships",
    "RelativeRunbookPath": "user/general/list-group-ownerships.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "List group ownerships for this user.",
    "Description": "Lists Entra ID groups where the specified user is an owner. Outputs the group names and IDs.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"Group.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "Group.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Manager",
    "RunbookDisplayPath": "User \\ General \\ List Manager",
    "RelativeRunbookPath": "user/general/list-manager.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "List manager information for this user",
    "Description": "Retrieves the manager object for a specified user. Outputs common manager attributes such as display name, email, and phone numbers.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Offboard User Permanently",
    "RunbookDisplayPath": "User \\ General \\ Offboard User Permanently",
    "RelativeRunbookPath": "user/general/offboard-user-permanently.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "Permanently offboard a user",
    "Description": "Permanently offboards a user by revoking access, disabling or deleting the account, adjusting group and license assignments, and optionally exporting memberships. Optionally removes or replaces group ownerships when required.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "CallerName is tracked purely for auditing purposes"
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "18",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "\"Change\" and \"Remove all\" will both honour \"groupToAdd\""
          }
        ],
        "globbing": "false",
        "name": "ChangeGroupsSelector",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "Controls how directly assigned licenses should be handled."
          }
        ],
        "globbing": "false",
        "name": "ChangeLicensesSelector",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Delete user object\" (final value: $true) or \"Keep the user object\" (final value: $false) can be selected as action to perform. If set to true, the user object will be deleted. If set to false, the user object will be kept but access will be revoked and sign-in will be blocked."
          }
        ],
        "globbing": "false",
        "name": "DeleteUser",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, disables the user account for sign-in."
          }
        ],
        "globbing": "false",
        "name": "DisableUser",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, exports the user's current group memberships to Azure Storage."
          }
        ],
        "globbing": "false",
        "name": "exportGroupMemberships",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure Resource Group name for exporting data to storage."
          }
        ],
        "globbing": "false",
        "name": "exportResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region used when creating the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "exportStorAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure Storage Account name for exporting data to storage."
          }
        ],
        "globbing": "false",
        "name": "exportStorAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "SKU name used when creating the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "exportStorAccountSKU",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Container name used for group membership exports."
          }
        ],
        "globbing": "false",
        "name": "exportStorContainerGroupMembershipExports",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Prefix used to remove groups matching a naming convention."
          }
        ],
        "globbing": "false",
        "name": "GroupsToRemovePrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "14",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Group that should be added or kept when group changes are enabled."
          }
        ],
        "globbing": "false",
        "name": "GroupToAdd",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "13",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, uses the user's manager as replacement owner where applicable."
          }
        ],
        "globbing": "false",
        "name": "ManagerAsReplacementOwner",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "16",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User who will take over group or resource ownership if required."
          }
        ],
        "globbing": "false",
        "name": "ReplacementOwnerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "17",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, revokes the user's refresh tokens and active sessions."
          }
        ],
        "globbing": "false",
        "name": "RevokeAccess",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "\"Remove/Replace this user's group ownerships\" (final value: $true) or \"User will remain owner / Do not change\" (final value: $false) can be selected as action to perform. If set to true, the runbook will attempt to remove the user from group ownerships. If the user is the last owner of a group, it will attempt to assign a replacement owner; if that fails, it will skip ownership change for that group and log it for manual follow-up."
          }
        ],
        "globbing": "false",
        "name": "RevokeGroupOwnership",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "15",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.ReadWrite.All\",\n                \"Group.ReadWrite.All\",\n                \"GroupMember.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"User administrator\"\n    ],\n    \"ManualPermissions\": [\n        \"Azure IaaS: Contributor access on subscription or resource group used for the export\"\n    ]\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.ReadWrite.All",
            "Group.ReadWrite.All",
            "GroupMember.ReadWrite.All"
          ]
        }
      ],
      "Roles": [
        "User administrator"
      ],
      "ManualPermissions": [
        "Azure IaaS: Contributor access on subscription or resource group used for the export"
      ]
    }
  },
  {
    "RunbookDisplayName": "Offboard User Temporarily",
    "RunbookDisplayPath": "User \\ General \\ Offboard User Temporarily",
    "RelativeRunbookPath": "user/general/offboard-user-temporarily.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "Temporarily offboard a user",
    "Description": "Temporarily offboards a user for scenarios such as parental leave or sabbatical by disabling access, adjusting group and license assignments, and optionally exporting memberships. Optionally removes or replaces group ownerships when required.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "16",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "Controls how assigned groups should be handled. \"Change\" and \"Remove all\" will both honour \"groupToAdd\"."
          }
        ],
        "globbing": "false",
        "name": "ChangeGroupsSelector",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "Controls how directly assigned licenses should be handled."
          }
        ],
        "globbing": "false",
        "name": "ChangeLicensesSelector",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, disables the user account for sign-in."
          }
        ],
        "globbing": "false",
        "name": "DisableUser",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, exports the user's current group memberships to Azure Storage."
          }
        ],
        "globbing": "false",
        "name": "exportGroupMemberships",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure Resource Group name for exporting data to storage."
          }
        ],
        "globbing": "false",
        "name": "exportResourceGroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure region used when creating the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "exportStorAccountLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Azure Storage Account name for exporting data to storage."
          }
        ],
        "globbing": "false",
        "name": "exportStorAccountName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "SKU name used when creating the Storage Account."
          }
        ],
        "globbing": "false",
        "name": "exportStorAccountSKU",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Container name used for group membership exports."
          }
        ],
        "globbing": "false",
        "name": "exportStorContainerGroupMembershipExports",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Prefix used to remove groups matching a naming convention."
          }
        ],
        "globbing": "false",
        "name": "GroupsToRemovePrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "13",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Group that should be added or kept when group changes are enabled."
          }
        ],
        "globbing": "false",
        "name": "GroupToAdd",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Who will take over group ownership if the offboarded user is the last remaining group owner? Will only be used if needed."
          }
        ],
        "globbing": "false",
        "name": "ReplacementOwnerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "15",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, revokes the user's refresh tokens and active sessions."
          }
        ],
        "globbing": "false",
        "name": "RevokeAccess",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, removes or replaces the user's group ownerships."
          }
        ],
        "globbing": "false",
        "name": "RevokeGroupOwnership",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "14",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.ReadWrite.All\",\n                \"Group.ReadWrite.All\",\n                \"GroupMember.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"User administrator\"\n    ],\n    \"ManualPermissions\": [\n        \"Azure IaaS: Contributor access on subscription or resource group used for the export\"\n    ]\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.ReadWrite.All",
            "Group.ReadWrite.All",
            "GroupMember.ReadWrite.All"
          ]
        }
      ],
      "Roles": [
        "User administrator"
      ],
      "ManualPermissions": [
        "Azure IaaS: Contributor access on subscription or resource group used for the export"
      ]
    }
  },
  {
    "RunbookDisplayName": "Reprovision Windows365",
    "RunbookDisplayPath": "User \\ General \\ Reprovision Windows365",
    "RelativeRunbookPath": "user/general/reprovision-windows365.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "Reprovision a Windows 365 Cloud PC",
    "Description": "Triggers a reprovision action for an existing Windows 365 Cloud PC without assigning a new instance. Optionally notifies the user when reprovisioning starts.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, uses a custom email body."
          }
        ],
        "globbing": "false",
        "name": "customizeMail",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "Insert Custom Message here. (Capped at 3000 characters)",
        "description": [
          {
            "Text": "Custom message body used for the notification email."
          }
        ],
        "globbing": "false",
        "name": "customMailMessage",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "reports@contoso.com",
        "description": [
          {
            "Text": "Mailbox used to send the notification email."
          }
        ],
        "globbing": "false",
        "name": "fromMailAddress",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "lic - Windows 365 Enterprise - 2 vCPU 4 GB 128 GB",
        "description": [
          {
            "Text": "Display name of the Windows 365 license group used to identify the Cloud PC."
          }
        ],
        "globbing": "false",
        "name": "licWin365GroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Do not send an Email.\" (final value: $false) or \"Send an Email.\" (final value: $true) can be selected as action to perform. If set to true, an email notification will be sent to the user when Cloud PC reprovisioning has begun."
          }
        ],
        "globbing": "false",
        "name": "sendMailWhenReprovisioning",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"GroupMember.ReadWrite.All\",\n                \"Group.ReadWrite.All\",\n                \"Directory.Read.All\",\n                \"CloudPC.ReadWrite.All\",\n                \"User.Read.All\",\n                \"User.SendMail\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "GroupMember.ReadWrite.All",
            "Group.ReadWrite.All",
            "Directory.Read.All",
            "CloudPC.ReadWrite.All",
            "User.Read.All",
            "User.SendMail"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Resize Windows365",
    "RunbookDisplayPath": "User \\ General \\ Resize Windows365",
    "RelativeRunbookPath": "user/general/resize-windows365.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "Resize an existing Windows 365 Cloud PC for a user",
    "Description": "Resizes a Windows 365 Cloud PC by removing the current assignment and provisioning a new size using a different license group.\nWARNING: This operation deprovisions and reprovisions the Cloud PC and local data may be lost.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "rjgit-user_general_assign-windows365",
        "description": [
          {
            "Text": "Name of the runbook used to assign the new Windows 365 configuration."
          }
        ],
        "globbing": "false",
        "name": "assignRunbook",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "13",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "cfg - Windows 365 - Provisioning -",
        "description": [
          {
            "Text": "Prefix used to detect provisioning-related configuration groups."
          }
        ],
        "globbing": "false",
        "name": "cfgProvisioningGroupPrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "cfg - Windows 365 - User Settings -",
        "description": [
          {
            "Text": "Prefix used to detect user-settings-related configuration groups."
          }
        ],
        "globbing": "false",
        "name": "cfgUserSettingsGroupPrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "lic - Windows 365 Enterprise - 2 vCPU 4 GB 128 GB",
        "description": [
          {
            "Text": "Current Windows 365 license group name used by the Cloud PC."
          }
        ],
        "globbing": "false",
        "name": "currentLicWin365GroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, uses a custom email body."
          }
        ],
        "globbing": "false",
        "name": "customizeMail",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "Insert Custom Message here. (Capped at 3000 characters)",
        "description": [
          {
            "Text": "Custom message body used for the notification email."
          }
        ],
        "globbing": "false",
        "name": "customMailMessage",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "reports@contoso.com",
        "description": [
          {
            "Text": "Mailbox used to send the notification email."
          }
        ],
        "globbing": "false",
        "name": "fromMailAddress",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "lic - Windows 365 Enterprise - 2 vCPU 4 GB 256 GB",
        "description": [
          {
            "Text": "New Windows 365 license group name to assign for the resized Cloud PC."
          }
        ],
        "globbing": "false",
        "name": "newLicWin365GroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Do not send an Email.\" (final value: $false) or \"Send an Email.\" (final value: $true) can be selected as action to perform. If set to true, an email notification will be sent to the user when Cloud PC resizing has finished."
          }
        ],
        "globbing": "false",
        "name": "sendMailWhenDoneResizing",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, ends the old Cloud PC grace period immediately."
          }
        ],
        "globbing": "false",
        "name": "skipGracePeriod",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "rjgit-user_general_unassign-windows365",
        "description": [
          {
            "Text": "Name of the runbook used to remove the current Windows 365 assignment."
          }
        ],
        "globbing": "false",
        "name": "unassignRunbook",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"GroupMember.ReadWrite.All\",\n                \"Group.ReadWrite.All\",\n                \"Directory.Read.All\",\n                \"CloudPC.ReadWrite.All\",\n                \"User.Read.All\",\n                \"User.SendMail\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "GroupMember.ReadWrite.All",
            "Group.ReadWrite.All",
            "Directory.Read.All",
            "CloudPC.ReadWrite.All",
            "User.Read.All",
            "User.SendMail"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Unassign Windows365",
    "RunbookDisplayPath": "User \\ General \\ Unassign Windows365",
    "RelativeRunbookPath": "user/general/unassign-windows365.ps1",
    "RelativeRunbookPath_PathOnly": "user/general",
    "PrimaryFolder": "User",
    "SubFolder": "General",
    "Synopsis": "Remove and deprovision a Windows 365 Cloud PC for a user",
    "Description": "Removes Windows 365 assignments for a user and deprovisions the associated Cloud PC. Optionally ends the grace period immediately to trigger faster removal.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "cfg - Windows 365 - Provisioning -",
        "description": [
          {
            "Text": "Prefix used to detect provisioning-related configuration groups."
          }
        ],
        "globbing": "false",
        "name": "cfgProvisioningGroupPrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "cfg - Windows 365 - User Settings -",
        "description": [
          {
            "Text": "Prefix used to detect user-settings-related configuration groups."
          }
        ],
        "globbing": "false",
        "name": "cfgUserSettingsGroupPrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, does not remove related provisioning and user settings groups."
          }
        ],
        "globbing": "false",
        "name": "KeepUserSettingsAndProvisioningGroups",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "lic - Windows 365 Enterprise - 2 vCPU 4 GB 128 GB",
        "description": [
          {
            "Text": "Display name of the Windows 365 license group or Frontline provisioning policy to remove."
          }
        ],
        "globbing": "false",
        "name": "licWin365GroupName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "lic - Windows 365 Enterprise -",
        "description": [
          {
            "Text": "Prefix used to detect Windows 365 license groups."
          }
        ],
        "globbing": "false",
        "name": "licWin365GroupPrefix",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, ends the Cloud PC grace period immediately."
          }
        ],
        "globbing": "false",
        "name": "skipGracePeriod",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.Read.All\",\n                \"GroupMember.ReadWrite.All\",\n                \"Group.ReadWrite.All\",\n                \"CloudPC.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.Read.All",
            "GroupMember.ReadWrite.All",
            "Group.ReadWrite.All",
            "CloudPC.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Add Or Remove Email Address",
    "RunbookDisplayPath": "User \\ Mail \\ Add Or Remove Email Address",
    "RelativeRunbookPath": "user/mail/add-or-remove-email-address.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "Add or remove an email address for a mailbox",
    "Description": "Adds or removes an alias email address on a mailbox and can optionally set it as the primary address.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, sets the specified address as the primary SMTP address."
          }
        ],
        "globbing": "false",
        "name": "asPrimary",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Email address to add or remove."
          }
        ],
        "globbing": "false",
        "name": "EmailAddress",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, removes the address instead of adding it."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online API\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online API",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Assign Owa Mailbox Policy",
    "RunbookDisplayPath": "User \\ Mail \\ Assign Owa Mailbox Policy",
    "RelativeRunbookPath": "user/mail/assign-owa-mailbox-policy.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "Assign an OWA mailbox policy to a user",
    "Description": "Assigns an OWA mailbox policy to a mailbox in Exchange Online. This can be used to enable or restrict features such as Microsoft Bookings.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "OwaMailboxPolicy-Default",
        "description": [
          {
            "Text": "Name of the OWA mailbox policy to assign."
          }
        ],
        "globbing": "false",
        "name": "OwaPolicyName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Convert To Shared Mailbox",
    "RunbookDisplayPath": "User \\ Mail \\ Convert To Shared Mailbox",
    "RelativeRunbookPath": "user/mail/convert-to-shared-mailbox.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "Convert a user mailbox to a shared mailbox and back",
    "Description": "Converts a mailbox to a shared mailbox or reverts it back to a regular user mailbox. Optionally delegates access and adjusts group memberships and license groups.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Display name of a license group to assign when an archive or larger mailbox requires it."
          }
        ],
        "globbing": "false",
        "name": "ArchivalLicenseGroup",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, enables automatic Outlook mapping for delegated FullAccess."
          }
        ],
        "globbing": "false",
        "name": "AutoMapping",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the delegate who should receive access."
          }
        ],
        "globbing": "false",
        "name": "delegateTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Display name of a license group to assign when converting back to a regular mailbox."
          }
        ],
        "globbing": "false",
        "name": "RegularLicenseGroup",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, converts a shared mailbox back to a regular mailbox."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, removes existing group memberships when converting to a shared mailbox."
          }
        ],
        "globbing": "false",
        "name": "RemoveGroups",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online API\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online API",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Delegate Full Access",
    "RunbookDisplayPath": "User \\ Mail \\ Delegate Full Access",
    "RelativeRunbookPath": "user/mail/delegate-full-access.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "Delegate FullAccess permissions to another user on a mailbox or remove existing delegation",
    "Description": "Grants or removes FullAccess permissions for a delegate on a mailbox. Optionally enables Outlook automapping when granting access.\nAlso shows the current and new permissions for the mailbox.\nAutomapping allows the delegated mailbox to automatically appear in the delegate's Outlook client.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, enables Outlook automapping when granting FullAccess."
          }
        ],
        "globbing": "false",
        "name": "AutoMapping",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the delegate."
          }
        ],
        "globbing": "false",
        "name": "delegateTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, removes the delegation instead of granting it."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online API\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online API",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Delegate Send As",
    "RunbookDisplayPath": "User \\ Mail \\ Delegate Send As",
    "RelativeRunbookPath": "user/mail/delegate-send-as.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "Delegate SendAs permissions for other user on his/her mailbox or remove existing delegation",
    "Description": "Grants or removes SendAs permissions for a delegate on a mailbox in Exchange Online. The current permissions are shown before and after applying the change.\nThis allows the delegate to send emails as if they were the mailbox owner.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the delegate."
          }
        ],
        "globbing": "false",
        "name": "delegateTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, removes the delegation instead of granting it."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online API\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online API",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Delegate Send On Behalf",
    "RunbookDisplayPath": "User \\ Mail \\ Delegate Send On Behalf",
    "RelativeRunbookPath": "user/mail/delegate-send-on-behalf.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "Delegate SendOnBehalf permissions for the user's mailbox",
    "Description": "Grants or removes SendOnBehalf permissions for a delegate on the user's mailbox. Outputs the resulting SendOnBehalf trustees after applying the change.\nThis allows the delegate to send emails on behalf of the mailbox owner.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the delegate."
          }
        ],
        "globbing": "false",
        "name": "delegateTo",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, removes the delegation instead of granting it."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online API\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online API",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Hide Or Unhide In Addressbook",
    "RunbookDisplayPath": "User \\ Mail \\ Hide Or Unhide In Addressbook",
    "RelativeRunbookPath": "user/mail/hide-or-unhide-in-addressbook.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "Hide or unhide a mailbox in the address book",
    "Description": "Hides or unhides a mailbox from the global address lists. Important: This change can take up to 72 hours until it is reflected in the global address list.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, hides the mailbox from address lists."
          }
        ],
        "globbing": "false",
        "name": "HideMailbox",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online API\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online API",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Mailbox Permissions",
    "RunbookDisplayPath": "User \\ Mail \\ List Mailbox Permissions",
    "RelativeRunbookPath": "user/mail/list-mailbox-permissions.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "List mailbox permissions for a mailbox",
    "Description": "Lists different types of permissions like mailbox access, SendAs, and SendOnBehalf permissions for a mailbox. Outputs each permission type as formatted tables. This also works for shared mailboxes.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online API\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online API",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "List Room Mailbox Configuration",
    "RunbookDisplayPath": "User \\ Mail \\ List Room Mailbox Configuration",
    "RelativeRunbookPath": "user/mail/list-room-mailbox-configuration.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "List room mailbox configuration",
    "Description": "Reads room metadata and lists calendar processing settings. This helps validate room resource configuration and booking behavior.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the room mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"MS Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Place.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "MS Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Place.Read.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Remove Mailbox",
    "RunbookDisplayPath": "User \\ Mail \\ Remove Mailbox",
    "RelativeRunbookPath": "user/mail/remove-mailbox.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "Hard delete a shared mailbox, room or bookings calendar",
    "Description": "Forces a deletion of a shared mailbox, room mailbox, or bookings calendar. The mailbox type is validated before deletion.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Set Out Of Office",
    "RunbookDisplayPath": "User \\ Mail \\ Set Out Of Office",
    "RelativeRunbookPath": "user/mail/set-out-of-office.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "Enable or disable out-of-office notifications for a mailbox",
    "Description": "Configures automatic replies for a mailbox and optionally creates an out-of-office calendar event. The runbook can either enable scheduled replies or disable them.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, creates an out-of-office calendar event."
          }
        ],
        "globbing": "false",
        "name": "CreateEvent",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Enable Out-of-Office\" (final value: $false) or \"Disable Out-of-Office\" (final value: $true) can be selected as action to perform."
          }
        ],
        "globbing": "false",
        "name": "Disable",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "((get-date) + (new-timespan -Days 3650))",
        "description": [
          {
            "Text": "End time for scheduled out-of-office replies. If not specified, defaults to 10 years from the current date."
          }
        ],
        "globbing": "false",
        "name": "End",
        "parameterValue": "DateTime",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "DateTime"
        }
      },
      {
        "defaultValue": "Out of Office",
        "description": [
          {
            "Text": "Subject for the optional out-of-office calendar event."
          }
        ],
        "globbing": "false",
        "name": "EventSubject",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Sorry, this person is currently not able to receive your message.",
        "description": [
          {
            "Text": "External automatic reply message."
          }
        ],
        "globbing": "false",
        "name": "MessageExternal",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "Sorry, this person is currently not able to receive your message.",
        "description": [
          {
            "Text": "Internal automatic reply message."
          }
        ],
        "globbing": "false",
        "name": "MessageInternal",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "(get-date)",
        "description": [
          {
            "Text": "Start time for scheduled out-of-office replies."
          }
        ],
        "globbing": "false",
        "name": "Start",
        "parameterValue": "DateTime",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "DateTime"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online API\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online API",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Set Room Mailbox Configuration",
    "RunbookDisplayPath": "User \\ Mail \\ Set Room Mailbox Configuration",
    "RelativeRunbookPath": "user/mail/set-room-mailbox-configuration.ps1",
    "RelativeRunbookPath_PathOnly": "user/mail",
    "PrimaryFolder": "User",
    "SubFolder": "Mail",
    "Synopsis": "Set room mailbox resource policies",
    "Description": "Updates room mailbox settings such as booking policy, calendar processing, and capacity. The runbook can optionally restrict BookInPolicy to members of a specific mail-enabled security group.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "\"Allow BookIn for everyone\" (final value: $true) or \"Custom BookIn Policy\" (final value: $false) can be selected as action to perform. If set to true, the room will allow BookIn for everyone and the BookInPolicyGroup parameter will be ignored. If set to false, only members of the group specified in the BookInPolicyGroup parameter will be allowed to BookIn."
          }
        ],
        "globbing": "false",
        "name": "AllBookInPolicy",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, allows scheduling conflicts."
          }
        ],
        "globbing": "false",
        "name": "AllowConflicts",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, allows recurring meetings."
          }
        ],
        "globbing": "false",
        "name": "AllowRecurringMeetings",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "AutoAccept",
        "description": [
          {
            "Text": "Calendar processing mode for the room mailbox."
          }
        ],
        "globbing": "false",
        "name": "AutomateProcessing",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "180",
        "description": [
          {
            "Text": "How many days into the future bookings are allowed."
          }
        ],
        "globbing": "false",
        "name": "BookingWindowInDays",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Group whose members are allowed to book when AllBookInPolicy is false."
          }
        ],
        "globbing": "false",
        "name": "BookInPolicyGroup",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "0",
        "description": [
          {
            "Text": "Capacity to set for the room when greater than 0."
          }
        ],
        "globbing": "false",
        "name": "Capacity",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "1440",
        "description": [
          {
            "Text": "Maximum meeting duration in minutes."
          }
        ],
        "globbing": "false",
        "name": "MaximumDurationInMinutes",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the room mailbox."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Office 365 Exchange Online API\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Office 365 Exchange Online API",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Disable Teams Phone",
    "RunbookDisplayPath": "User \\ Phone \\ Disable Teams Phone",
    "RelativeRunbookPath": "user/phone/disable-teams-phone.ps1",
    "RelativeRunbookPath_PathOnly": "user/phone",
    "PrimaryFolder": "User",
    "SubFolder": "Phone",
    "Synopsis": "Microsoft Teams telephony offboarding",
    "Description": "Removes the assigned phone number and clears selected Teams voice policies for a Teams-enabled user. This fullfills the telephony offboarding scenarios.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User which should be cleared. Could be filled with the user picker in the UI."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Organization.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Teams Administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Organization.Read.All"
          ]
        }
      ],
      "Roles": [
        "Teams Administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Get Teams User Info",
    "RunbookDisplayPath": "User \\ Phone \\ Get Teams User Info",
    "RelativeRunbookPath": "user/phone/get-teams-user-info.ps1",
    "RelativeRunbookPath_PathOnly": "user/phone",
    "PrimaryFolder": "User",
    "SubFolder": "Phone",
    "Synopsis": "Get Microsoft Teams voice status for a user",
    "Description": "Retrieves voice-related status information for a Teams user such as phone number assignment, call forwarding settings, voicemail configuration, and policy assignments. The output is intended for troubleshooting and validation.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Organization.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Teams Administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Organization.Read.All"
          ]
        }
      ],
      "Roles": [
        "Teams Administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Grant Teams User Policies",
    "RunbookDisplayPath": "User \\ Phone \\ Grant Teams User Policies",
    "RelativeRunbookPath": "user/phone/grant-teams-user-policies.ps1",
    "RelativeRunbookPath_PathOnly": "user/phone",
    "PrimaryFolder": "User",
    "SubFolder": "Phone",
    "Synopsis": "Grant Microsoft Teams policies to a Microsoft Teams enabled user",
    "Description": "Assigns selected Teams policies for a Teams-enabled user. Policies are only changed when a value is provided, and assignments can be cleared by using the value \"Global (Org Wide Default)\".\nIt allows to assign the following policies: Online Voice Routing Policy, Tenant Dial Plan, Teams Calling Policy, Teams IP Phone Policy, Online Voicemail Policy, Teams Meeting Policy and Teams Meeting Broadcast Policy (Live Event Policy).",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Microsoft Teams Online Voicemail Policy Name. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered."
          }
        ],
        "globbing": "false",
        "name": "OnlineVoicemailPolicy",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Microsoft Teams Online Voice Routing Policy Name. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered."
          }
        ],
        "globbing": "false",
        "name": "OnlineVoiceRoutingPolicy",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Microsoft Teams Calling Policy Name. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered."
          }
        ],
        "globbing": "false",
        "name": "TeamsCallingPolicy",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Microsoft Teams IP Phone Policy Name. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered. This is typically used for Common Area Phone users."
          }
        ],
        "globbing": "false",
        "name": "TeamsIPPhonePolicy",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Microsoft Teams Meeting Broadcast Policy Name. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered."
          }
        ],
        "globbing": "false",
        "name": "TeamsMeetingBroadcastPolicy",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Microsoft Teams Meeting Policy Name. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered."
          }
        ],
        "globbing": "false",
        "name": "TeamsMeetingPolicy",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Microsoft Teams Tenant Dial Plan Name. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered."
          }
        ],
        "globbing": "false",
        "name": "TenantDialPlan",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Organization.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Teams Administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Organization.Read.All"
          ]
        }
      ],
      "Roles": [
        "Teams Administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Set Teams Permanent Call Forwarding",
    "RunbookDisplayPath": "User \\ Phone \\ Set Teams Permanent Call Forwarding",
    "RelativeRunbookPath": "user/phone/set-teams-permanent-call-forwarding.ps1",
    "RelativeRunbookPath_PathOnly": "user/phone",
    "PrimaryFolder": "User",
    "SubFolder": "Phone",
    "Synopsis": "Set immediate call forwarding for a Teams user",
    "Description": "Configures immediate call forwarding for a Teams Enterprise Voice user to a Teams user, a phone number, voicemail, or the user's delegates. The runbook can also disable immediate forwarding.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Phone number to which calls should be forwarded. Must be in E.164 format (e.g. +49123456789)"
          }
        ],
        "globbing": "false",
        "name": "ForwardTargetPhoneNumber",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the Teams user to forward calls to."
          }
        ],
        "globbing": "false",
        "name": "ForwardTargetTeamsUser",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, forwards calls to the delegates defined by the user."
          }
        ],
        "globbing": "false",
        "name": "ForwardToDelegates",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, forwards calls to voicemail."
          }
        ],
        "globbing": "false",
        "name": "ForwardToVoicemail",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, disables immediate call forwarding."
          }
        ],
        "globbing": "false",
        "name": "TurnOffForward",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Organization.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Teams Administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Organization.Read.All"
          ]
        }
      ],
      "Roles": [
        "Teams Administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Set Teams Phone",
    "RunbookDisplayPath": "User \\ Phone \\ Set Teams Phone",
    "RelativeRunbookPath": "user/phone/set-teams-phone.ps1",
    "RelativeRunbookPath_PathOnly": "user/phone",
    "PrimaryFolder": "User",
    "SubFolder": "Phone",
    "Synopsis": "Assign a phone number to a Microsoft Teams enabled user, enable calling and Grant specific Microsoft Teams policies.",
    "Description": "Assign a phone number to a Microsoft Teams enabled user, enable calling and Grant specific Microsoft Teams policies.\nIf the policy name of a policy is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Online Voice Routing Policy to assign. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered."
          }
        ],
        "globbing": "false",
        "name": "OnlineVoiceRoutingPolicy",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Phone number which should be assigned to the user. The number must be in E.164 format (e.g. +49123456789)."
          }
        ],
        "globbing": "false",
        "name": "PhoneNumber",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Teams Calling Policy to assign. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered."
          }
        ],
        "globbing": "false",
        "name": "TeamsCallingPolicy",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Teams IP Phone Policy to assign. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered."
          }
        ],
        "globbing": "false",
        "name": "TeamsIPPhonePolicy",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Name of the Tenant Dial Plan to assign. If the policy name is left blank, the corresponding policy will not be changed. To clear the policies assignment, the value \"Global (Org Wide Default)\" has to be entered."
          }
        ],
        "globbing": "false",
        "name": "TenantDialPlan",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Organization.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Teams Administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Organization.Read.All"
          ]
        }
      ],
      "Roles": [
        "Teams Administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Confirm Or Dismiss Risky User",
    "RunbookDisplayPath": "User \\ Security \\ Confirm Or Dismiss Risky User",
    "RelativeRunbookPath": "user/security/confirm-or-dismiss-risky-user.ps1",
    "RelativeRunbookPath_PathOnly": "user/security",
    "PrimaryFolder": "User",
    "SubFolder": "Security",
    "Synopsis": "Confirm compromise or dismiss a risky user",
    "Description": "Confirms a user compromise or dismisses a risky user entry using Microsoft Entra ID Identity Protection. This helps security teams remediate and track risky sign-in events.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Confirm compromise\" (final value: $false) or \"Dismiss risk\" (final value: $true) can be selected as action to perform. If set to true, the runbook will attempt to dismiss the risky user entry for the target user. If set to false, it will attempt to confirm a compromise for the target user."
          }
        ],
        "globbing": "false",
        "name": "Dismiss",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"IdentityRiskyUser.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "IdentityRiskyUser.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Create Temporary Access Pass",
    "RunbookDisplayPath": "User \\ Security \\ Create Temporary Access Pass",
    "RelativeRunbookPath": "user/security/create-temporary-access-pass.ps1",
    "RelativeRunbookPath_PathOnly": "user/security",
    "PrimaryFolder": "User",
    "SubFolder": "Security",
    "Synopsis": "Create a temporary access pass for a user",
    "Description": "Creates a new Temporary Access Pass (TAP) authentication method for a user in Microsoft Entra ID. Existing TAPs for the user are removed before creating a new one.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "240",
        "description": [
          {
            "Text": "Lifetime of the temporary access pass in minutes."
          }
        ],
        "globbing": "false",
        "name": "LifetimeInMinutes",
        "parameterValue": "Int32",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Int32"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, the pass can be used only once."
          }
        ],
        "globbing": "false",
        "name": "OneTimeUseOnly",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"UserAuthenticationMethod.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "UserAuthenticationMethod.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Enable Or Disable Password Expiration",
    "RunbookDisplayPath": "User \\ Security \\ Enable Or Disable Password Expiration",
    "RelativeRunbookPath": "user/security/enable-or-disable-password-expiration.ps1",
    "RelativeRunbookPath_PathOnly": "user/security",
    "PrimaryFolder": "User",
    "SubFolder": "Security",
    "Synopsis": "Enable or disable password expiration for a user",
    "Description": "Updates the password policy for a user in Microsoft Entra ID. This can be used to disable password expiration or re-enable the default expiration behavior.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, disables password expiration for the user."
          }
        ],
        "globbing": "false",
        "name": "DisablePasswordExpiration",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Reset Mfa",
    "RunbookDisplayPath": "User \\ Security \\ Reset Mfa",
    "RelativeRunbookPath": "user/security/reset-mfa.ps1",
    "RelativeRunbookPath_PathOnly": "user/security",
    "PrimaryFolder": "User",
    "SubFolder": "Security",
    "Synopsis": "Remove all App- and Mobilephone auth methods for a user",
    "Description": "Removes authenticator app and phone-based authentication methods for a user. This forces the user to re-enroll MFA methods after the reset.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"UserAuthenticationMethod.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "UserAuthenticationMethod.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Reset Password",
    "RunbookDisplayPath": "User \\ Security \\ Reset Password",
    "RelativeRunbookPath": "user/security/reset-password.ps1",
    "RelativeRunbookPath_PathOnly": "user/security",
    "PrimaryFolder": "User",
    "SubFolder": "Security",
    "Synopsis": "Reset a user's password",
    "Description": "Resets the password for a user in Microsoft Entra ID and optionally enables the account first. The user can be forced to change the password at the next sign-in. This runbook is useful for helpdesk scenarios where a technician needs to reset a user's password and ensure that the user updates it upon next login.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, enables the user account before resetting the password."
          }
        ],
        "globbing": "false",
        "name": "EnableUserIfNeeded",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, forces the user to change the password at the next sign-in."
          }
        ],
        "globbing": "false",
        "name": "ForceChangePasswordNextSignIn",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [],\n    \"Roles\": [\n        \"User administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [],
      "Roles": [
        "User administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Revoke Or Restore Access",
    "RunbookDisplayPath": "User \\ Security \\ Revoke Or Restore Access",
    "RelativeRunbookPath": "user/security/revoke-or-restore-access.ps1",
    "RelativeRunbookPath_PathOnly": "user/security",
    "PrimaryFolder": "User",
    "SubFolder": "Security",
    "Synopsis": "Revoke or restore user access",
    "Description": "Blocks or re-enables a user account and optionally revokes active sign-in sessions. This can be used during incident response to immediately invalidate user tokens.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "\"(Re-)Enable User\" (final value: $false) or \"Revoke Access\" (final value: $true) can be selected as action to perform. If set to true, the runbook will block the user from signing in and revoke active sessions. If set to false, it will re-enable the user account."
          }
        ],
        "globbing": "false",
        "name": "Revoke",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"User Administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.ReadWrite.All"
          ]
        }
      ],
      "Roles": [
        "User Administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Set Or Remove Mobile Phone Mfa",
    "RunbookDisplayPath": "User \\ Security \\ Set Or Remove Mobile Phone Mfa",
    "RelativeRunbookPath": "user/security/set-or-remove-mobile-phone-mfa.ps1",
    "RelativeRunbookPath_PathOnly": "user/security",
    "PrimaryFolder": "User",
    "SubFolder": "Security",
    "Synopsis": "Set or remove a user's mobile phone MFA method",
    "Description": "Adds, updates, or removes the user's mobile phone authentication method. If you need to change a number, remove the existing method first and then add the new number.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Mobile phone number in international E.164 format (e.g., +491701234567)."
          }
        ],
        "globbing": "false",
        "name": "phoneNumber",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "\"Set/Update Mobile Phone MFA Method\" (final value: $false) or \"Remove Mobile Phone MFA Method\" (final value: $true) can be selected as action to perform. If set to true, the runbook will remove the mobile phone MFA method for the user. If set to false, it will add or update the mobile phone MFA method with the provided phone number."
          }
        ],
        "globbing": "false",
        "name": "Remove",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"UserAuthenticationMethod.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "UserAuthenticationMethod.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Rename User",
    "RunbookDisplayPath": "User \\ Userinfo \\ Rename User",
    "RelativeRunbookPath": "user/userinfo/rename-user.ps1",
    "RelativeRunbookPath_PathOnly": "user/userinfo",
    "PrimaryFolder": "User",
    "SubFolder": "Userinfo",
    "Synopsis": "Rename a user or mailbox",
    "Description": "Renames a user by changing the user principal name in Microsoft Entra ID and optionally updates mailbox properties in Exchange Online. This does not update user metadata such as display name, given name, or surname.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, updates the mailbox alias and name based on the new UPN."
          }
        ],
        "globbing": "false",
        "name": "ChangeMailnickname",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "New user principal name to set."
          }
        ],
        "globbing": "false",
        "name": "NewUpn",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "True",
        "description": [
          {
            "Text": "If set to true, updates the primary SMTP address and rewrites email addresses accordingly."
          }
        ],
        "globbing": "false",
        "name": "UpdatePrimaryAddress",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the user or mailbox to rename."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Directory.Read.All\",\n                \"User.ReadWrite.All\"\n            ]\n        },\n        {\n            \"Name\": \"Office 365 Exchange Online\",\n            \"Id\": \"00000002-0000-0ff1-ce00-000000000000\",\n            \"AppRoleAssignments\": [\n                \"Exchange.ManageAsApp\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"Exchange administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "Directory.Read.All",
            "User.ReadWrite.All"
          ]
        },
        {
          "Name": "Office 365 Exchange Online",
          "Id": "00000002-0000-0ff1-ce00-000000000000",
          "AppRoleAssignments": [
            "Exchange.ManageAsApp"
          ]
        }
      ],
      "Roles": [
        "Exchange administrator"
      ],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Set Photo",
    "RunbookDisplayPath": "User \\ Userinfo \\ Set Photo",
    "RelativeRunbookPath": "user/userinfo/set-photo.ps1",
    "RelativeRunbookPath_PathOnly": "user/userinfo",
    "PrimaryFolder": "User",
    "SubFolder": "Userinfo",
    "Synopsis": "Set the profile photo for a user",
    "Description": "Downloads a JPEG image from a URL and uploads it as the user's profile photo. This is useful to set or update user avatars in Microsoft 365.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "URL to a JPEG image that will be used as the profile photo."
          }
        ],
        "globbing": "false",
        "name": "PhotoURI",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"User.ReadWrite.All\"\n            ]\n        }\n    ],\n    \"Roles\": [],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "User.ReadWrite.All"
          ]
        }
      ],
      "Roles": [],
      "ManualPermissions": []
    }
  },
  {
    "RunbookDisplayName": "Update User",
    "RunbookDisplayPath": "User \\ Userinfo \\ Update User",
    "RelativeRunbookPath": "user/userinfo/update-user.ps1",
    "RelativeRunbookPath_PathOnly": "user/userinfo",
    "PrimaryFolder": "User",
    "SubFolder": "Userinfo",
    "Synopsis": "Update user metadata and memberships",
    "Description": "Updates user profile properties in Microsoft Entra ID and applies optional group memberships and Exchange Online settings. This runbook is typically used to finalize onboarding or to correct user metadata.",
    "Notes": null,
    "Parameters": [
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Caller name is tracked purely for auditing purposes."
          }
        ],
        "globbing": "false",
        "name": "CallerName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "20",
        "required": "true",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "City to set for the user."
          }
        ],
        "globbing": "false",
        "name": "City",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "6",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Company name to set for the user."
          }
        ],
        "globbing": "false",
        "name": "CompanyName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "5",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Country to set for the user."
          }
        ],
        "globbing": "false",
        "name": "Country",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "7",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Comma-separated list of group display names to assign."
          }
        ],
        "globbing": "false",
        "name": "DefaultGroups",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "17",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Display name of a license group to assign."
          }
        ],
        "globbing": "false",
        "name": "DefaultLicense",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "16",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Department to set for the user."
          }
        ],
        "globbing": "false",
        "name": "Department",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "9",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Display name to set for the user."
          }
        ],
        "globbing": "false",
        "name": "DisplayName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "4",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, enables the Exchange Online archive mailbox."
          }
        ],
        "globbing": "false",
        "name": "EnableEXOArchive",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "18",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Given name to set for the user."
          }
        ],
        "globbing": "false",
        "name": "GivenName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "2",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Job title to set for the user."
          }
        ],
        "globbing": "false",
        "name": "JobTitle",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "8",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Office location to set for the user."
          }
        ],
        "globbing": "false",
        "name": "OfficeLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "10",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Postal code to set for the user."
          }
        ],
        "globbing": "false",
        "name": "PostalCode",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "11",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Preferred language to set for the user. Examples: \"en-US\" or \"de-DE\"."
          }
        ],
        "globbing": "false",
        "name": "PreferredLanguage",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "12",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "False",
        "description": [
          {
            "Text": "If set to true, resets the user's password."
          }
        ],
        "globbing": "false",
        "name": "ResetPassword",
        "parameterValue": "Boolean",
        "pipelineInput": "false",
        "position": "19",
        "required": "false",
        "type": {
          "name": "Boolean"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "State to set for the user."
          }
        ],
        "globbing": "false",
        "name": "State",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "13",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Street address to set for the user."
          }
        ],
        "globbing": "false",
        "name": "StreetAddress",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "14",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Surname to set for the user."
          }
        ],
        "globbing": "false",
        "name": "Surname",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "3",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "Usage location to set for the user."
          }
        ],
        "globbing": "false",
        "name": "UsageLocation",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "15",
        "required": "false",
        "type": {
          "name": "String"
        }
      },
      {
        "defaultValue": "",
        "description": [
          {
            "Text": "User principal name of the target user."
          }
        ],
        "globbing": "false",
        "name": "UserName",
        "parameterValue": "String",
        "pipelineInput": "false",
        "position": "1",
        "required": "true",
        "type": {
          "name": "String"
        }
      }
    ],
    "DocsContent": null,
    "DocsContentEncoded": null,
    "PermissionsContent": "{\n    \"Permissions\": [\n        {\n            \"Name\": \"Microsoft Graph\",\n            \"Id\": \"00000003-0000-0000-c000-000000000000\",\n            \"AppRoleAssignments\": [\n                \"UserAuthenticationMethod.Read.All\"\n            ]\n        }\n    ],\n    \"Roles\": [\n        \"User administrator\",\n        \"Exchange Administrator\"\n    ],\n    \"ManualPermissions\": []\n}",
    "PermissionsJson": {
      "Permissions": [
        {
          "Name": "Microsoft Graph",
          "Id": "00000003-0000-0000-c000-000000000000",
          "AppRoleAssignments": [
            "UserAuthenticationMethod.Read.All"
          ]
        }
      ],
      "Roles": [
        "User administrator",
        "Exchange Administrator"
      ],
      "ManualPermissions": []
    }
  }
]
